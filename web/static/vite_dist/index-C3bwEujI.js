import{d as ye,E as Re,c as h,I,j as be,p as Oe,q as G,h as J,o as j,x as Ee,w as T,g as Ce,u as $,G as A,i as K,t as F,b as D,f as Q,e as we,H as Pe,m as X,J as je,A as q,a8 as Ve,n as Te,k as _e,W as ke,r as b,a9 as Ie,s as V,K as M,a5 as Le,Q as Y,S as Z,aa as Ne,ab as Se}from"./vue-iE2ul1Tq.js";import{u as Be,_ as Ae,a as Fe}from"./useFormField-BGhpWVH_.js";import{_ as De}from"./FormGroup-CskLXm1p.js";const qe=["id","name","required"],xe=["id","type","name","required"],Ge={key:0,class:"buttons"},at=ye({__name:"FormGroupField",props:{id:{},name:{},label:{},description:{},inputType:{default:"text"},inputNumber:{type:Boolean,default:!1},inputTrim:{type:Boolean,default:!1},inputEmptyIsNull:{type:Boolean,default:!1},inputAttrs:{default:()=>({})},autofocus:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},modelValue:{},field:{},required:{type:Boolean},advanced:{type:Boolean},highCpu:{type:Boolean}},emits:["update:modelValue"],setup(t,{expose:s,emit:n}){const e=t,l=Re(),i=n,{model:m,isVuelidateField:u,fieldClass:f,isRequired:o}=Be(e,i),v=h(()=>e.inputNumber||e.inputType==="number"||e.inputType==="range"),d=h({get(){return m.value},set(a){(v.value||e.inputEmptyIsNull)&&a===""?m.value=null:(e.inputTrim&&a!==null&&(a=String(a).replace(/^\s+|\s+$/gm,"")),v.value&&(a=Number(a)),m.value=a)}}),y=I({$model:d}),p=be("$input"),r=()=>{var a;(a=p.value)==null||a.focus()},c=()=>{d.value=""};return Oe(()=>{e.autofocus&&G(()=>{r()})}),s({focus:r}),(a,g)=>(j(),J(De,q(a.$attrs,{id:a.id}),Ee({default:T(()=>[A(a.$slots,"default",Te(_e({id:a.id,field:a.field,model:y,fieldClass:$(f)})),()=>[a.inputType==="textarea"?X((j(),D("textarea",q({key:0},a.inputAttrs,{id:a.id,ref_key:"$input",ref:p,"onUpdate:modelValue":g[0]||(g[0]=P=>d.value=P),name:a.name,required:$(o),class:["form-control",$(f)]}),null,16,qe)),[[je,d.value]]):X((j(),D("input",q({key:1},a.inputAttrs,{id:a.id,ref_key:"$input",ref:p,"onUpdate:modelValue":g[1]||(g[1]=P=>d.value=P),type:a.inputType,name:a.name,required:$(o),class:["form-control",$(f)]}),null,16,xe)),[[Ve,d.value]])]),$(u)?(j(),J(Fe,{key:0,field:a.field},null,8,["field"])):Q("",!0)]),_:2},[a.label||l.label?{name:"label",fn:T(()=>[Ce(Ae,{"is-required":$(o),advanced:e.advanced,"high-cpu":e.highCpu},{default:T(()=>[A(a.$slots,"label",{},()=>[K(F(a.label),1)])]),_:3},8,["is-required","advanced","high-cpu"])]),key:"0"}:void 0,a.description||l.description||a.clearable?{name:"description",fn:T(()=>[a.clearable?(j(),D("div",Ge,[we("button",{type:"button",class:"btn btn-sm btn-outline-secondary",onClick:Pe(c,["prevent"])},F(a.$gettext("Clear Field")),1)])):Q("",!0),A(a.$slots,"description",{},()=>[K(F(a.description),1)])]),key:"1"}:void 0]),1040,["id"]))}});function ee(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);s&&(e=e.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,e)}return n}function E(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?ee(Object(n),!0).forEach(function(e){Me(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Me(t,s,n){return s in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function te(t){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Object.keys(t).reduce((n,e)=>(s.includes(e)||(n[e]=$(t[e])),n),{})}function k(t){return typeof t=="function"}function ze(t){return Ne(t)||Se(t)}function le(t,s,n){let e=t;const l=s.split(".");for(let i=0;i<l.length;i++){if(!e[l[i]])return n;e=e[l[i]]}return e}function x(t,s,n){return h(()=>t.some(e=>le(s,e,{[n]:!1})[n]))}function ne(t,s,n){return h(()=>t.reduce((e,l)=>{const i=le(s,l,{[n]:!1})[n]||[];return e.concat(i)},[]))}function oe(t,s,n,e){return t.call(e,$(s),$(n),e)}function ie(t){return t.$valid!==void 0?!t.$valid:!t}function Ue(t,s,n,e,l,i,m){let{$lazy:u,$rewardEarly:f}=l,o=arguments.length>7&&arguments[7]!==void 0?arguments[7]:[],v=arguments.length>8?arguments[8]:void 0,d=arguments.length>9?arguments[9]:void 0,y=arguments.length>10?arguments[10]:void 0;const p=b(!!e.value),r=b(0);n.value=!1;const c=V([s,e].concat(o,y),()=>{if(u&&!e.value||f&&!d.value&&!n.value)return;let a;try{a=oe(t,s,v,m)}catch(g){a=Promise.reject(g)}r.value++,n.value=!!r.value,p.value=!1,Promise.resolve(a).then(g=>{r.value--,n.value=!!r.value,i.value=g,p.value=ie(g)}).catch(g=>{r.value--,n.value=!!r.value,i.value=g,p.value=!0})},{immediate:!0,deep:typeof s=="object"});return{$invalid:p,$unwatch:c}}function We(t,s,n,e,l,i,m,u){let{$lazy:f,$rewardEarly:o}=e;const v=()=>({}),d=h(()=>{if(f&&!n.value||o&&!u.value)return!1;let y=!0;try{const p=oe(t,s,m,i);l.value=p,y=ie(p)}catch(p){l.value=p}return y});return{$unwatch:v,$invalid:d}}function He(t,s,n,e,l,i,m,u,f,o,v){const d=b(!1),y=t.$params||{},p=b(null);let r,c;t.$async?{$invalid:r,$unwatch:c}=Ue(t.$validator,s,d,n,e,p,l,t.$watchTargets,f,o,v):{$invalid:r,$unwatch:c}=We(t.$validator,s,n,e,p,l,f,o);const a=t.$message;return{$message:k(a)?h(()=>a(te({$pending:d,$invalid:r,$params:te(y),$model:s,$response:p,$validator:i,$propertyPath:u,$property:m}))):a||"",$params:y,$pending:d,$invalid:r,$response:p,$unwatch:c}}function Je(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const s=$(t),n=Object.keys(s),e={},l={},i={};let m=null;return n.forEach(u=>{const f=s[u];switch(!0){case k(f.$validator):e[u]=f;break;case k(f):e[u]={$validator:f};break;case u==="$validationGroups":m=f;break;case u.startsWith("$"):i[u]=f;break;default:l[u]=f}}),{rules:e,nestedValidators:l,config:i,validationGroups:m}}const Ke="__root";function Qe(t,s,n,e,l,i,m,u,f){const o=Object.keys(t),v=e.get(l,t),d=b(!1),y=b(!1),p=b(0);if(v){if(!v.$partial)return v;v.$unwatch(),d.value=v.$dirty.value}const r={$dirty:d,$path:l,$touch:()=>{d.value||(d.value=!0)},$reset:()=>{d.value&&(d.value=!1)},$commit:()=>{}};return o.length?(o.forEach(c=>{r[c]=He(t[c],s,r.$dirty,i,m,c,n,l,f,y,p)}),r.$externalResults=h(()=>u.value?[].concat(u.value).map((c,a)=>({$propertyPath:l,$property:n,$validator:"$externalResults",$uid:`${l}-externalResult-${a}`,$message:c,$params:{},$response:null,$pending:!1})):[]),r.$invalid=h(()=>{const c=o.some(a=>$(r[a].$invalid));return y.value=c,!!r.$externalResults.value.length||c}),r.$pending=h(()=>o.some(c=>$(r[c].$pending))),r.$error=h(()=>r.$dirty.value?r.$pending.value||r.$invalid.value:!1),r.$silentErrors=h(()=>o.filter(c=>$(r[c].$invalid)).map(c=>{const a=r[c];return I({$propertyPath:l,$property:n,$validator:c,$uid:`${l}-${c}`,$message:a.$message,$params:a.$params,$response:a.$response,$pending:a.$pending})}).concat(r.$externalResults.value)),r.$errors=h(()=>r.$dirty.value?r.$silentErrors.value:[]),r.$unwatch=()=>o.forEach(c=>{r[c].$unwatch()}),r.$commit=()=>{y.value=!0,p.value=Date.now()},e.set(l,t,r),r):(v&&e.set(l,t,r),r)}function Xe(t,s,n,e,l,i,m){const u=Object.keys(t);return u.length?u.reduce((f,o)=>(f[o]=z({validations:t[o],state:s,key:o,parentKey:n,resultsCache:e,globalConfig:l,instance:i,externalResults:m}),f),{}):{}}function Ye(t,s,n){const e=h(()=>[s,n].filter(r=>r).reduce((r,c)=>r.concat(Object.values($(c))),[])),l=h({get(){return t.$dirty.value||(e.value.length?e.value.every(r=>r.$dirty):!1)},set(r){t.$dirty.value=r}}),i=h(()=>{const r=$(t.$silentErrors)||[],c=e.value.filter(a=>($(a).$silentErrors||[]).length).reduce((a,g)=>a.concat(...g.$silentErrors),[]);return r.concat(c)}),m=h(()=>{const r=$(t.$errors)||[],c=e.value.filter(a=>($(a).$errors||[]).length).reduce((a,g)=>a.concat(...g.$errors),[]);return r.concat(c)}),u=h(()=>e.value.some(r=>r.$invalid)||$(t.$invalid)||!1),f=h(()=>e.value.some(r=>$(r.$pending))||$(t.$pending)||!1),o=h(()=>e.value.some(r=>r.$dirty)||e.value.some(r=>r.$anyDirty)||l.value),v=h(()=>l.value?f.value||u.value:!1),d=()=>{t.$touch(),e.value.forEach(r=>{r.$touch()})},y=()=>{t.$commit(),e.value.forEach(r=>{r.$commit()})},p=()=>{t.$reset(),e.value.forEach(r=>{r.$reset()})};return e.value.length&&e.value.every(r=>r.$dirty)&&d(),{$dirty:l,$errors:m,$invalid:u,$anyDirty:o,$error:v,$pending:f,$touch:d,$reset:p,$silentErrors:i,$commit:y}}function z(t){let{validations:s,state:n,key:e,parentKey:l,childResults:i,resultsCache:m,globalConfig:u={},instance:f,externalResults:o}=t;const v=l?`${l}.${e}`:e,{rules:d,nestedValidators:y,config:p,validationGroups:r}=Je(s),c=E(E({},u),p),a=e?h(()=>{const R=$(n);return R?$(R[e]):void 0}):n,g=E({},$(o)||{}),P=h(()=>{const R=$(o);return e?R?$(R[e]):void 0:R}),U=Qe(d,a,e,m,v,c,f,P,n),C=Xe(y,a,v,m,c,f,P),W={};r&&Object.entries(r).forEach(R=>{let[w,O]=R;W[w]={$invalid:x(O,C,"$invalid"),$error:x(O,C,"$error"),$pending:x(O,C,"$pending"),$errors:ne(O,C,"$errors"),$silentErrors:ne(O,C,"$silentErrors")}});const{$dirty:L,$errors:ce,$invalid:N,$anyDirty:de,$error:fe,$pending:S,$touch:B,$reset:$e,$silentErrors:ve,$commit:H}=Ye(U,C,i),pe=e?h({get:()=>$(a),set:R=>{L.value=!0;const w=$(n),O=$(o);O&&(O[e]=g[e]),M(w[e])?w[e].value=R:w[e]=R}}):null;e&&c.$autoDirty&&V(a,()=>{L.value||B();const R=$(o);R&&(R[e]=g[e])},{flush:"sync"});async function me(){return B(),c.$rewardEarly&&(H(),await G()),await G(),new Promise(R=>{if(!S.value)return R(!N.value);const w=V(S,()=>{R(!N.value),w()})})}function ge(R){return(i.value||{})[R]}function he(){M(o)?o.value=g:Object.keys(g).length===0?Object.keys(o).forEach(R=>{delete o[R]}):Object.assign(o,g)}return I(E(E(E({},U),{},{$model:pe,$dirty:L,$error:fe,$errors:ce,$invalid:N,$anyDirty:de,$pending:S,$touch:B,$reset:$e,$path:v||Ke,$silentErrors:ve,$validate:me,$commit:H},i&&{$getResultsForChild:ge,$clearExternalResults:he,$validationGroups:W}),C))}class Ze{constructor(){this.storage=new Map}set(s,n,e){this.storage.set(s,{rules:n,result:e})}checkRulesValidity(s,n,e){const l=Object.keys(e),i=Object.keys(n);return i.length!==l.length||!i.every(u=>l.includes(u))?!1:i.every(u=>n[u].$params?Object.keys(n[u].$params).every(f=>$(e[u].$params[f])===$(n[u].$params[f])):!0)}get(s,n){const e=this.storage.get(s);if(!e)return;const{rules:l,result:i}=e,m=this.checkRulesValidity(s,n,l),u=i.$unwatch?i.$unwatch:()=>({});return m?i:{$dirty:i.$dirty,$partial:!0,$unwatch:u}}}const _={COLLECT_ALL:!0,COLLECT_NONE:!1},re=Symbol("vuelidate#injectChildResults"),ae=Symbol("vuelidate#removeChildResults");function et(t){let{$scope:s,instance:n}=t;const e={},l=b([]),i=h(()=>l.value.reduce((v,d)=>(v[d]=$(e[d]),v),{}));function m(v,d){let{$registerAs:y,$scope:p,$stopPropagation:r}=d;r||s===_.COLLECT_NONE||p===_.COLLECT_NONE||s!==_.COLLECT_ALL&&s!==p||(e[y]=v,l.value.push(y))}n.__vuelidateInjectInstances=[].concat(n.__vuelidateInjectInstances||[],m);function u(v){l.value=l.value.filter(d=>d!==v),delete e[v]}n.__vuelidateRemoveInstances=[].concat(n.__vuelidateRemoveInstances||[],u);const f=Y(re,[]);Z(re,n.__vuelidateInjectInstances);const o=Y(ae,[]);return Z(ae,n.__vuelidateRemoveInstances),{childResults:i,sendValidationResultsToParent:f,removeValidationResultsFromParent:o}}function ue(t){return new Proxy(t,{get(s,n){return typeof s[n]=="object"?ue(s[n]):h(()=>s[n])}})}let se=0;function st(t,s){var n;let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};arguments.length===1&&(e=t,t=void 0,s=void 0);let{$registerAs:l,$scope:i=_.COLLECT_ALL,$stopPropagation:m,$externalResults:u,currentVueInstance:f}=e;const o=f||((n=ke())===null||n===void 0?void 0:n.proxy),v=o?o.$options:{};l||(se+=1,l=`_vuelidate_${se}`);const d=b({}),y=new Ze,{childResults:p,sendValidationResultsToParent:r,removeValidationResultsFromParent:c}=o?et({$scope:i,instance:o}):{childResults:b({})};if(!t&&v.validations){const a=v.validations;s=b({}),Ie(()=>{s.value=o,V(()=>k(a)?a.call(s.value,new ue(s.value)):a,g=>{d.value=z({validations:g,state:s,childResults:p,resultsCache:y,globalConfig:e,instance:o,externalResults:u||o.vuelidateExternalResults})},{immediate:!0})}),e=v.validationsConfig||e}else{const a=M(t)||ze(t)?t:I(t||{});V(a,g=>{d.value=z({validations:g,state:s,childResults:p,resultsCache:y,globalConfig:e,instance:o??{},externalResults:u})},{immediate:!0})}return o&&(r.forEach(a=>a(d,{$registerAs:l,$scope:i,$stopPropagation:m})),Le(()=>c.forEach(a=>a(l)))),h(()=>E(E({},$(d.value)),p.value))}export{at as _,st as u};
