import{d as q,N as z,c as N,r as I,q as J,p as K,s as O,b as n,o as i,g as x,e as t,u as s,f as g,h as E,t as u,D as j,F as G,y as Q,m as W,J as X,K as Y}from"./vue-Cts3TEHg.js";import{u as Z,a as ee,_ as te}from"./useShowVolume-B7zU9B3z.js";import{_ as se}from"./PlayButton-D_xZh6QL.js";import{u as le,l as oe}from"./usePlayerStore-BlBABSf7.js";import{u as ae}from"./useNowPlaying-BeFKu_IM.js";import{_ as ne}from"./MuteButton-xwg5N4tr.js";import{A as ie}from"./AlbumArt-IO3w6IEk.js";import{c as re}from"./index-DP9oPqoW.js";const ue={class:"radio-player-widget"},ce={class:"now-playing-details"},de={key:0,class:"now-playing-art"},me={class:"now-playing-main"},pe={key:0,class:"now-playing-live"},_e={class:"badge text-bg-primary me-2"},he={key:1},ve={class:"now-playing-title text-muted"},ye={key:2},fe={class:"now-playing-title"},ge={class:"now-playing-artist"},we={key:3},be={class:"now-playing-title"},xe={key:4,class:"time-display"},ke={class:"time-display-played text-secondary"},Se={class:"time-display-progress"},Ne={class:"progress h-5"},Te={class:"time-display-total text-secondary"},Ve={class:"radio-controls"},Pe={class:"radio-control-select-stream"},Ae={key:0,class:"dropdown"},Be={id:"btn-select-stream",class:"btn btn-sm btn-secondary dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},Ee={class:"dropdown-menu","aria-labelledby":"btn-select-stream"},De=["onClick"],$e={key:0,class:"radio-control-volume d-flex align-items-center"},Ce={class:"flex-shrink-0 mx-2"},He={class:"flex-fill radio-control-volume-slider"},Le=["title"],je=q({inheritAttrs:!1,__name:"Player",props:{offlineText:{},showHls:{type:Boolean,default:!0},showAlbumArt:{type:Boolean,default:!0},autoplay:{type:Boolean,default:!0},stationShortName:{},useStatic:{type:Boolean},useSse:{type:Boolean}},emits:["np_updated"],setup(D,{emit:$}){const k=D,C=$,{np:o,currentTrackPercent:H,currentTrackDurationDisplay:L,currentTrackElapsedDisplay:T}=ae(k),c=z({name:"",url:"",hls:!1}),V=N(()=>{var e,l;return k.showHls&&((l=(e=o.value)==null?void 0:e.station)==null?void 0:l.hls_enabled)}),M=N(()=>{var e,l;return V.value&&((l=(e=o.value)==null?void 0:e.station)==null?void 0:l.hls_is_default)}),{$gettext:w}=le(),S=N(()=>{var l,a,d,m,p,h,v,y;const e=[];return V.value&&e.push({name:w("HLS"),url:(a=(l=o.value)==null?void 0:l.station)==null?void 0:a.hls_url,hls:!0}),(p=(m=(d=o.value)==null?void 0:d.station)==null?void 0:m.mounts)==null||p.forEach(function(r){e.push({name:r.name??r.url,url:r.url,hls:!1})}),(y=(v=(h=o.value)==null?void 0:h.station)==null?void 0:v.remotes)==null||y.forEach(function(r){e.push({name:r.name??r.url,url:r.url,hls:!1})}),e}),_=Z(),U=ee(),P=new URL(document.location.href).searchParams.get("volume");P!==null&&(_.value=Number(P));const b=I(!1),R=()=>{b.value=!b.value},{toggle:F}=oe(),A=e=>{c.value=e,F({url:e.url,isStream:!0,isHls:e.hls})};if(k.autoplay){const e=re(document,"now-playing",()=>{J(()=>{A(c.value),e()})})}return K(()=>{document.dispatchEvent(new CustomEvent("player-ready"))}),O(o,e=>{var d;C("np_updated",e);const l=S.value;let a=c.value;a.url===""&&l.length>0&&(M.value?c.value=l[0]:(a=null,(d=e.station)!=null&&d.listen_url&&l.forEach(function(m){var p;m.url===((p=e.station)==null?void 0:p.listen_url)&&(a=m)}),a===null&&(a=l[0]),c.value=a))},{immediate:!0}),(e,l)=>{var a,d,m,p,h,v,y,r,B;return i(),n("div",ue,[x(te,{title:(d=(a=s(o).now_playing)==null?void 0:a.song)==null?void 0:d.text,volume:s(_),"is-muted":b.value},null,8,["title","volume","is-muted"]),t("div",ce,[e.showAlbumArt&&((p=(m=s(o).now_playing)==null?void 0:m.song)!=null&&p.art)?(i(),n("div",de,[x(ie,{src:s(o).now_playing.song.art},null,8,["src"])])):g("",!0),t("div",me,[(h=s(o).live)!=null&&h.is_live?(i(),n("h6",pe,[t("span",_e,u(s(w)("Live")),1),E(" "+u(s(o).live.streamer_name),1)])):g("",!0),s(o).is_online?(y=(v=s(o).now_playing)==null?void 0:v.song)!=null&&y.title?(i(),n("div",ye,[t("h4",fe,u(s(o).now_playing.song.title),1),t("h5",ge,u(s(o).now_playing.song.artist),1)])):(i(),n("div",we,[t("h4",be,u((B=(r=s(o).now_playing)==null?void 0:r.song)==null?void 0:B.text),1)])):(i(),n("div",he,[t("h4",ve,u(e.offlineText??s(w)("Station Offline")),1)])),s(T)!=null?(i(),n("div",xe,[t("div",ke,u(s(T)),1),t("div",Se,[t("div",Ne,[t("div",{class:"progress-bar bg-secondary",role:"progressbar",style:j({width:s(H)+"%"})},null,4)])]),t("div",Te,u(s(L)),1)])):g("",!0)])]),l[2]||(l[2]=t("hr",{class:"my-2"},null,-1)),t("div",Ve,[x(se,{class:"radio-control-play-button btn-xl",url:c.value.url,"is-hls":c.value.hls,"is-stream":""},null,8,["url","is-hls"]),t("div",Pe,[S.value.length>1?(i(),n("div",Ae,[t("button",Be,[E(u(c.value.name)+" ",1),l[1]||(l[1]=t("span",{class:"caret"},null,-1))]),t("ul",Ee,[(i(!0),n(G,null,Q(S.value,f=>(i(),n("li",{key:f.url},[t("button",{type:"button",class:"dropdown-item",onClick:Ue=>A(f)},u(f.name),9,De)]))),128))])])):g("",!0)]),s(U)?(i(),n("div",$e,[t("div",Ce,[x(ne,{class:"p-0 text-secondary",volume:s(_),"is-muted":b.value,onToggleMute:R},null,8,["volume","is-muted"])]),t("div",He,[W(t("input",{"onUpdate:modelValue":l[0]||(l[0]=f=>Y(_)?_.value=f:null),type:"range",title:s(w)("Volume"),class:"form-range",min:"0",max:"100",step:"1"},null,8,Le),[[X,s(_),void 0,{number:!0}]])])])):g("",!0)])])}}});export{je as _};
