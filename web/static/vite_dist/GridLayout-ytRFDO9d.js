import{a as y}from"./DataTable-Cfhib7L5.js";import{d as T}from"./usePlayerStore-BGNIt4QJ.js";import{u as V}from"./useOptionalStorage-Bjdc4CxS.js";import{d as R,r as p,s as b,U as S,N as D,c as P,p as F,b as l,o as s,f as v,e as w,g as G,G as _,t as k,h as j,F as q,y as A,j as E}from"./vue-Cts3TEHg.js";const I=["id"],M={key:0,class:"datatable-toolbar-top card-body"},x={class:"grid-main card-body"},z={key:0,class:"spinner-border",role:"status"},H={class:"visually-hidden"},J={key:2,class:"row view-group"},K={key:1,class:"datatable-toolbar-bottom card-body"},Z=R({__name:"GridLayout",props:{id:{},apiUrl:{},paginated:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},hideOnLoading:{type:Boolean,default:!0},showToolbar:{type:Boolean,default:!0},pageOptions:{default:()=>[10,25,50,100,250,500,0]},defaultPerPage:{default:10}},emits:["refreshed","data-loaded"],setup(C,{expose:B,emit:L}){const t=C,f=L,r=p(1),c=p(!1),u=p(!1);b(S(t,"loading"),e=>{u.value=e});const g=D([]),d=p(0),N=V("grid_"+t.id+"_settings",{perPage:t.defaultPerPage},{mergeDefaults:!0}),n=P(()=>{var e;return t.paginated?((e=N.value)==null?void 0:e.perPage)??t.defaultPerPage:-1}),U=P(()=>t.paginated&&n.value!==0),{axios:$}=T(),i=()=>{const e={internal:!0};t.paginated?(e.rowCount=n.value,e.current=n.value!==0?r.value:1):e.rowCount=0,c.value&&(e.flushCache=!0),u.value=!0,$.get(t.apiUrl,{params:e}).then(a=>{d.value=a.data.total;const o=a.data.rows;f("data-loaded",o),g.value=o}).catch(a=>{d.value=0,console.error(a.response.data.message)}).finally(()=>{u.value=!1,c.value=!1,f("refreshed")})},m=e=>{r.value=e,i()},h=()=>{c.value=!0,i()};return b(n,()=>{r.value=1,h()}),F(i),B({refresh:i,relist:h}),(e,a)=>(s(),l("div",{id:e.id,class:"datatable-wrapper"},[e.showToolbar?(s(),l("div",M,[G(y,{"current-page":r.value,"onUpdate:currentPage":a[0]||(a[0]=o=>r.value=o),total:d.value,"per-page":n.value,onChange:m},null,8,["current-page","total","per-page"])])):v("",!0),w("div",x,[u.value&&e.hideOnLoading?(s(),l("div",z,[w("span",H,k(e.$gettext("Loading")),1)])):g.value.length===0?_(e.$slots,"empty",{key:1},()=>[j(k(e.$gettext("No records.")),1)]):(s(),l("div",J,[(s(!0),l(q,null,A(g.value,(o,O)=>(s(),l("div",{key:O,class:"item col-sm-6 col-lg-4"},[_(e.$slots,"item",{item:o})]))),128))]))]),e.showToolbar?(s(),l("div",K,[U.value?(s(),E(y,{key:0,"current-page":r.value,"onUpdate:currentPage":a[1]||(a[1]=o=>r.value=o),total:d.value,"per-page":n.value,onChange:m},null,8,["current-page","total","per-page"])):v("",!0)])):v("",!0)],8,I))}});export{Z as _};
