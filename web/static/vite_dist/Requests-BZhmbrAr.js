import{_ as P}from"./DataTable-cMgABYUQ.js";import{_ as S,a5 as A}from"./icons-Yf7pfv1X.js";import{u as B,f as F,d as U}from"./usePlayerStore-CkejGpKz.js";import{g as b}from"./router-C-xyFC2M.js";import{u as V}from"./useStationDateTimeFormatter-DsjNtgfg.js";import{u as I}from"./useDialog-j5jWy_Yl.js";import{d as H,r as j,c as z,j as E,b as i,e as a,f as k,g,t as s,u as r,F as L,s as G,w as c,o as n,x as J,i as p,q as K}from"./vue-B-dHMJBO.js";import"./lodash-Bdl6ys83.js";import"./lodash-BwctMegf.js";import"./FormMultiCheck-C8kU6V99.js";import"./FormCheckbox-CBrIHDuX.js";import"./useOptionalStorage-LDU0NgBk.js";import"./index-Ct57DpS4.js";import"./bootstrap.esm-BZy605kZ.js";import"./luxon-Csuvkg3x.js";import"./datetime-BTmRqpun.js";const M={class:"card",role:"region"},O={class:"card-header text-bg-primary"},Q={class:"card-title"},W={class:"card-body"},X={class:"nav nav-tabs",role:"tablist"},Y=["onClick"],Z={key:0,class:"card-body"},w={key:0},ee={key:1},te={key:0},se={key:1},ae=["onClick"],he=H({__name:"Requests",setup(oe){const h=b("/reports/requests"),T=b("/reports/requests/clear"),d=j("pending"),q=z(()=>h.value+"?type="+d.value),{$gettext:t}=B(),C=[{key:"timestamp",label:t("Date Requested"),sortable:!1},{key:"played_at",label:t("Date Played"),sortable:!1},{key:"song_title",isRowHeader:!0,label:t("Song Title"),sortable:!1},{key:"ip",label:t("Requester IP"),sortable:!1},{key:"actions",label:t("Actions"),sortable:!1}],x=[{type:"pending",title:t("Pending Requests")},{type:"history",title:t("Request History")}],u=E("$dataTable"),m=()=>{var o;(o=u.value)==null||o.refresh()},R=o=>{d.value=o,K(m)},{formatIsoAsDateTime:_}=V(),{confirmDelete:y}=I(),{notifySuccess:f}=F(),{axios:v}=U(),D=o=>{y({title:t("Delete Request?")}).then(l=>{l.value&&v.delete(o).then(e=>{f(e.data.message),m()})})},$=()=>{y({title:t("Clear All Pending Requests?"),confirmButtonText:t("Clear")}).then(o=>{o.value&&v.post(T.value).then(l=>{f(l.data.message),m()})})};return(o,l)=>(n(),i("section",M,[a("div",O,[a("h2",Q,s(r(t)("Song Requests")),1)]),a("div",W,[a("nav",X,[(n(),i(L,null,G(x,e=>a("div",{key:e.type,class:"nav-item",role:"presentation"},[a("button",{class:J(["nav-link",d.value===e.type?"active":""]),type:"button",role:"tab",onClick:N=>R(e.type)},s(e.title),11,Y)])),64))])]),d.value==="pending"?(n(),i("div",Z,[a("button",{type:"button",class:"btn btn-danger",onClick:l[0]||(l[0]=e=>$())},[g(S,{icon:r(A)},null,8,["icon"]),a("span",null,s(r(t)("Clear Pending Requests")),1)])])):k("",!0),g(P,{id:"station_queue",ref_key:"$dataTable",ref:u,fields:C,"api-url":q.value},{"cell(timestamp)":c(e=>[p(s(r(_)(e.item.timestamp)),1)]),"cell(played_at)":c(e=>[e.item.played_at===null?(n(),i("span",w,s(r(t)("Not Played")),1)):(n(),i("span",ee,s(r(_)(e.item.played_at)),1))]),"cell(song_title)":c(e=>[e.item.track.title?(n(),i("div",te,[a("b",null,s(e.item.track.title),1),l[1]||(l[1]=a("br",null,null,-1)),p(" "+s(e.item.track.artist),1)])):(n(),i("div",se,s(e.item.track.text),1))]),"cell(ip)":c(e=>[p(s(e.item.ip),1)]),"cell(actions)":c(e=>[e.item.played_at===0?(n(),i("button",{key:0,type:"button",class:"btn btn-sm btn-danger",onClick:N=>D(e.item.links.delete)},s(r(t)("Delete")),9,ae)):k("",!0)]),_:1},8,["api-url"])]))}});export{he as default};
