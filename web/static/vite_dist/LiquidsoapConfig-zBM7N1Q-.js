import{d as F,r as m,c as L,p as N,b,e as o,g as c,t as e,w as a,H as S,o as s,F as T,y as B,h as u,u as $,z}from"./vue-DTJ-1uEH.js";import{_ as M}from"./FormFieldset-BHUrS5Pq.js";import{_ as w}from"./index-CK5gn8hD.js";import{_ as D}from"./FormMarkup-Ds0dZ809.js";import{l as x}from"./lodash-Bdl6ys83.js";import{m as R}from"./mergeExisting-BH6wPZw0.js";import{_ as H}from"./InfoCard-Db4untlq.js";import{u as J}from"./useVuelidateOnForm-DTqLR35P.js";import{u as O}from"./assets/frontend/js/pages/Stations-C1rzDF9O.js";import{d as P,f as Y}from"./usePlayerStore-DgYe3TjK.js";import{_ as j}from"./Loading-CxLO-rjm.js";import{g as G}from"./router-CTDx8gfL.js";import{_ as I}from"./CodemirrorTextarea-B3kKNfjp.js";import"./useFormField-g35ZicrT.js";import"./FormGroup-BNI6R37d.js";import"./lodash-BwctMegf.js";import"./icons-BVVFRq1s.js";import"./index-CL6ZUZxu.js";import"./router-ByOjYlUQ.js";import"./PanelLayout-cOOvnB3Z.js";import"./useOptionalStorage-DITHAk2f.js";import"./populateComponentRemotely-BDNPpbC6.js";import"./acl-2tXqibk1.js";import"./useStationDateTimeFormatter-BYlEPTv2.js";import"./luxon-BLS1Vti_.js";import"./datetime-BTmRqpun.js";import"./Lightbox-B7TAdnOB.js";import"./HeaderInlinePlayer-S6KyFadH.js";import"./InlinePlayer-Cn-Wp0u7.js";import"./useShowVolume-CKdBujV1.js";import"./hlsjs-Cx0E5yqS.js";import"./formatTime-DvDPwXf4.js";import"./MuteButton-BCysCd9c.js";import"./lightbox-Cb_2lrH-.js";import"./bootstrap.esm-BZy605kZ.js";import"./index.es-vGs_rtSc.js";const K={class:"card",role:"region","aria-labelledby":"hdr_edit_ls_config"},Q={class:"card-header text-bg-primary"},W={id:"hdr_edit_ls_config",class:"card-title"},X={class:"card-text"},Z={class:"card-text"},tt={class:"card-text"},ot={class:"card-body"},et={class:"typography-body-1"},Rt=F({__name:"LiquidsoapConfig",setup(at){const p=G("/liquidsoap-config"),n=m([]),f=m([]),{form:d,resetForm:k,v$:_,ifValid:V}=J(L(()=>{const t={};return x.forEach(n.value,i=>{t[i]={}}),t}),()=>{const t={};return x.forEach(n.value,i=>{t[i]=null}),t}),l=m(!0),{mayNeedRestart:C}=O(),{axios:g}=P(),h=()=>{l.value=!0,g.get(p.value).then(t=>{f.value=t.data.config,n.value=t.data.sections,k(),d.value=R(d.value,t.data.contents)}).finally(()=>{l.value=!1})};N(h);const{notifySuccess:E}=Y(),U=()=>{V(()=>{g({method:"PUT",url:p.value,data:d.value}).then(()=>{E(),C(),h()})})};return(t,i)=>(s(),b("form",{class:"form vue-form",onSubmit:S(U,["prevent"])},[o("section",K,[o("div",Q,[o("h2",W,e(t.$gettext("Edit Liquidsoap Configuration")),1)]),c(H,null,{default:a(()=>[o("p",X,e(t.$gettext("Using this page, you can customize several sections of the Liquidsoap configuration. This allows you to add advanced functionality to your station's AutoDJ.")),1),o("p",Z,e(t.$gettext("The editable text boxes are areas where you can insert custom configuration code. The non-editable sections are automatically generated by Aplus.")),1),o("p",tt,e(t.$gettext("This is an advanced feature and custom code is not officially supported by Aplus. You may break your station by adding custom code, but removing it should fix any issues.")),1)]),_:1}),c(j,{loading:l.value},{default:a(()=>[o("div",ot,[(s(!0),b(T,null,B(f.value,(r,y)=>(s(),u(M,{key:y,class:"mb-0"},{default:a(()=>[r.is_field?(s(),u(w,{key:0,id:"form_edit_"+r.field_name,field:$(_)[r.field_name]},{default:a(({id:q,model:v})=>[c(I,{id:q,modelValue:v.$model,"onUpdate:modelValue":A=>v.$model=A,mode:"liquidsoap"},null,8,["id","modelValue","onUpdate:modelValue"])]),_:2},1032,["id","field"])):(s(),u(D,{key:1,id:"form_section_"+y},{default:a(()=>[o("pre",et,e(r.markup??""),1)]),_:2},1032,["id"]))]),_:2},1024))),128)),o("button",{type:"submit",class:z(["btn",$(_).$invalid?"btn-danger":"btn-primary"])},e(t.$gettext("Save Changes")),3)])]),_:1},8,["loading"])])],32))}});export{Rt as default};
