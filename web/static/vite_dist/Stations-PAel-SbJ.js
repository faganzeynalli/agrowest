import{_ as J}from"./DataTable-CmF0F31d.js";import{_ as j}from"./StationForm-B1vWmMrg.js";import{I as q}from"./InvisibleSubmitButton-EsMx6l8t.js";import{u as E,f as H,d as V}from"./usePlayerStore-BFODmuDt.js";import{u as F,_ as W}from"./useHasModal-wB1w8CB8.js";import{d as R,r as M,c as A,i as C,j as P,o as D,w as v,g as c,A as z,u as e,e as m,t as d,z as L,b as N,h as G,f as K,F as Q}from"./vue-Cts3TEHg.js";import{l as U}from"./lodash-Bdl6ys83.js";import{r as X}from"./index-Hn1RL1dT.js";import{_ as Y}from"./ModalForm-R7wGjMAh.js";import{_ as w}from"./index-CGsYikBD.js";import{_ as Z}from"./FormGroupMultiCheck-CcZ5Ytnc.js";import{u as ee}from"./useVuelidateOnForm-MsrLKQKp.js";import{u as te}from"./useHasDatatable-DPFcIMM0.js";import{u as oe,_ as se}from"./AddButton-D7Zx5mmj.js";import{u as ae}from"./useConfirmAndDelete-Clk0_Xco.js";import{_ as ne}from"./CardPage-CE6bIKLu.js";import{a as le}from"./router-DXJ7Mde1.js";import{u as ie}from"./useDialog-Bed1GG28.js";import"./icons-DHGLRlMD.js";import"./FormMultiCheck-BRaoZhWq.js";import"./FormCheckbox-VeRpO6PO.js";import"./useOptionalStorage-CJpWhhP4.js";import"./index-BqF5ooeJ.js";import"./FormFieldset-BDg23QuA.js";import"./FormGroupCheckbox-BTjgpzW9.js";import"./useFormField-Ci96MUhu.js";import"./FormGroup-LCbWR38E.js";import"./FormGroupSelect-Dnn3EuCU.js";import"./useVuelidateOnFormTab-DUDRu-sJ.js";import"./Tabs-7V6tH1xR.js";import"./RadioAdapters-DeTvpZIq.js";import"./FormMarkup-B1oZzq5z.js";import"./Loading-zTzdosl6.js";import"./BitrateOptions-DFxNjjEZ.js";import"./useSlotsExcept-By0Eq2ad.js";import"./mergeExisting-DGzkK79d.js";import"./acl-m0iUCnkh.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./bootstrap.esm-BZy605kZ.js";import"./lodash-BwctMegf.js";import"./InfoCard-iwtUiWoN.js";const re=R({inheritAttrs:!1,__name:"EditModal",props:{createUrl:{},timezones:{},isRsasInstalled:{type:Boolean},isShoutcastInstalled:{type:Boolean},isStereoToolInstalled:{type:Boolean},countries:{}},emits:["relist"],setup(x,{expose:o,emit:p}){const t=x,y=p,l=M(null),i=M(!0),f=A(()=>l.value!==null),{$gettext:u}=E(),k=A(()=>f.value?u("Edit Station"):u("Add Station")),g=C("$modal"),{show:$,hide:_}=F(g),B=n=>{i.value=!n},S=()=>{l.value=null,$()},T=n=>{l.value=n,$()},h=C("$form"),a=()=>{var n;(n=h.value)==null||n.reset()},b=()=>{y("relist"),_()},s=()=>{var n;(n=h.value)==null||n.submit()},r=()=>{l.value=null};return o({create:S,edit:T}),(n,I)=>(D(),P(W,{id:"station_edit_modal",ref_key:"$modal",ref:g,size:"lg",title:k.value,busy:!1,onShown:a,onHidden:r},{"modal-footer":v(()=>[m("button",{class:"btn btn-secondary",type:"button",onClick:I[0]||(I[0]=(...O)=>e(_)&&e(_)(...O))},d(e(u)("Close")),1),m("button",{class:L(["btn",i.value?"btn-danger":"btn-primary"]),type:"submit",onClick:s},d(e(u)("Save Changes")),3)]),default:v(()=>[c(j,z(t,{ref_key:"$form",ref:h,"is-modal":"","create-url":n.createUrl,"edit-url":l.value,"is-edit-mode":f.value,onError:e(_),onSubmitted:b,onValidUpdate:B}),{submitButton:v(()=>[c(q)]),_:1},16,["create-url","edit-url","is-edit-mode","onError"])]),_:1},8,["title"]))}}),ce={class:"row g-3"},me=R({__name:"CloneModalForm",props:{form:{}},setup(x){const{$gettext:o}=E(),p=A(()=>[{text:o("Share Media Storage Location"),value:"media_storage"},{text:o("Share Recordings Storage Location"),value:"recordings_storage"},{text:o("Share Podcasts Storage Location"),value:"podcasts_storage"},{text:o("Playlists"),value:"playlists"},{text:o("Mount Points"),value:"mounts"},{text:o("Remote Relays"),value:"remotes"},{text:o("Streamers/DJs"),value:"streamers"},{text:o("User Permissions"),value:"permissions"},{text:o("Web Hooks"),value:"webhooks"}]);return(t,y)=>(D(),N("div",ce,[c(w,{id:"edit_form_name",class:"col-md-12",field:t.form.name,label:e(o)("New Station Name")},null,8,["field","label"]),c(w,{id:"edit_form_description",class:"col-md-12",field:t.form.description,"input-type":"textarea",label:e(o)("New Station Description")},null,8,["field","label"]),c(Z,{id:"edit_form_clone",class:"col-md-12",field:t.form.clone,options:p.value,stacked:"",label:e(o)("Copy to New Station")},null,8,["field","options","label"])]))}}),de=R({__name:"CloneModal",emits:["relist"],setup(x,{expose:o,emit:p}){const t=p,y=M(!0),l=M(null),i=M(null),{form:f,resetForm:u,v$:k,ifValid:g}=ee({name:{required:X},description:{},clone:{}},{name:"",description:"",clone:[]}),$=C("$modal"),{hide:_,show:B}=F($),{$gettext:S}=E(),T=(r,n)=>{u(),f.value.name=S("%{station} - Copy",{station:r}),y.value=!1,i.value=null,l.value=n,B()},h=()=>{u(),l.value=null},{notifySuccess:a}=H(),{axios:b}=V(),s=()=>{g(()=>{i.value=null,b({method:"POST",url:l.value,data:f.value}).then(()=>{a(),t("relist"),_()}).catch(r=>{r.value=r.response.data.message})})};return o({create:T}),(r,n)=>(D(),P(Y,{ref_key:"$modal",ref:$,loading:y.value,title:e(S)("Clone Station"),error:i.value,"disable-save-button":e(k).$invalid,onSubmit:s,onHidden:h},{default:v(()=>[c(me,{form:e(k)},null,8,["form"])]),_:1},8,["loading","title","error","disable-save-button"]))}}),ue={class:"typography-subheading"},pe={key:0,class:"badge text-bg-secondary"},fe={class:"btn-group btn-group-sm"},_e=["href"],be=["onClick"],ve=["onClick"],ye=["onClick"],ge=["onClick"],it=R({__name:"Stations",props:{frontendTypes:{},backendTypes:{},timezones:{},isRsasInstalled:{type:Boolean},isShoutcastInstalled:{type:Boolean},isStereoToolInstalled:{type:Boolean},countries:{}},setup(x){const o=x,p=le("/admin/stations"),{$gettext:t}=E(),y=[{key:"name",isRowHeader:!0,label:t("Name"),sortable:!0},{key:"frontend_type",label:t("Broadcasting"),sortable:!1,formatter:a=>U.get(o.frontendTypes,[a,"name"],"")},{key:"backend_type",label:t("AutoDJ"),sortable:!1,formatter:a=>U.get(o.backendTypes,[a,"name"],"")},{key:"actions",label:t("Actions"),sortable:!1,class:"shrink"}],l=C("$dataTable"),{relist:i}=te(l),f=C("$editModal"),{doCreate:u,doEdit:k}=oe(f),g=C("$cloneModal"),$=(a,b)=>{g.value.create(a,b)},{showAlert:_}=ie(),{notifySuccess:B}=H(),{axios:S}=V(),T=a=>{_(a.is_enabled?{title:t("Disable station?"),confirmButtonText:t("Disable"),confirmButtonClass:"btn-warning",focusCancel:!0}:{title:t("Enable station?"),confirmButtonText:t("Enable"),confirmButtonClass:"btn-success",focusCancel:!1}).then(b=>{b.value&&S.put(a.links.self,{is_enabled:!a.is_enabled}).then(s=>{B(s.data.message),i()})})},{doDelete:h}=ae(t("Delete Station?"),i);return(a,b)=>(D(),N(Q,null,[c(ne,{title:e(t)("Stations")},{actions:v(()=>[c(se,{text:e(t)("Add Station"),onClick:e(u)},null,8,["text","onClick"])]),default:v(()=>[c(J,{id:"stations",ref_key:"$dataTable",ref:l,paginated:"",fields:y,"api-url":e(p)},{"cell(name)":v(({item:s})=>[m("div",ue,[G(d(s.name)+" ",1),s.is_enabled?K("",!0):(D(),N("span",pe,d(e(t)("Disabled")),1))]),m("code",null,d(s.short_name),1)]),"cell(actions)":v(s=>[m("div",fe,[m("a",{class:"btn btn-secondary",href:s.item.links.manage,target:"_blank"},d(e(t)("Manage")),9,_e),m("button",{type:"button",class:"btn btn-secondary",onClick:r=>$(s.item.name,s.item.links.clone)},d(e(t)("Clone")),9,be),m("button",{type:"button",class:L(["btn btn-sm",s.item.is_enabled?"btn-warning":"btn-success"]),onClick:r=>T(s.item)},d(s.item.is_enabled?e(t)("Disable"):e(t)("Enable")),11,ve),m("button",{type:"button",class:"btn btn-primary",onClick:r=>e(k)(s.item.links.self)},d(e(t)("Edit")),9,ye),m("button",{type:"button",class:"btn btn-danger",onClick:r=>e(h)(s.item.links.self)},d(e(t)("Delete")),9,ge)])]),_:1},8,["api-url"])]),_:1},8,["title"]),c(re,z(o,{ref_key:"$editModal",ref:f,"create-url":e(p),onRelist:e(i)}),null,16,["create-url","onRelist"]),c(de,{ref_key:"$cloneModal",ref:g,onRelist:e(i)},null,8,["onRelist"])],64))}});export{it as default};
