import{_ as d,aq as B,ah as m,ak as S,Q as W}from"./icons-MnSirWYG.js";import{u as Y,f as N,d as R}from"./usePlayerStore-CrWhEdqk.js";import{_ as u}from"./CardPage-RtUZnPlY.js";import{a as T}from"./router-BMTpFN0J.js";import{u as $}from"./useDialog-7K09lciJ.js";import{d as F,r as D,c as b,a as V,b as r,o as c,e,t as s,u as a,g as o,w as l,i as v,x as q,F as z}from"./vue-DTJ-1uEH.js";import"./bootstrap.esm-BZy605kZ.js";import"./lodash-BwctMegf.js";import"./InfoCard-6lvkqcbV.js";import"./index-Bjjcwhm_.js";const E={class:"outside-card-header mb-1"},H={class:"row row-of-cards"},M={class:"col col-md-8"},Q={class:"card-body"},j={key:0,class:"text-warning"},G={key:1,class:"text-success"},J={class:"col col-md-4"},K={class:"card-body"},L={class:"card-text"},O={class:"card-text typography-subheading"},P={class:"btn btn-info",href:"/docs/getting-started/updates/release-channels/",target:"_blank"},X={class:"row"},Z={class:"col col-md-6"},ee={key:0,class:"card-body"},te={class:"card-text"},ae={class:"card-text"},se={key:1,class:"card-body"},oe={class:"card-text"},ne={class:"col col-md-6"},le={class:"card-body"},ie={class:"card-text"},de={class:"btn btn-info",href:"/docs/getting-started/updates/",target:"_blank"},ye=F({__name:"Updates",props:{releaseChannel:{},initialUpdateInfo:{default:()=>({needs_release_update:!1,needs_rolling_update:!1})},enableWebUpdates:{type:Boolean}},setup(y){const p=y,f=T("/admin/updates"),_=D(p.initialUpdateInfo),{$gettext:t}=Y(),g=b(()=>p.releaseChannel==="stable"?t("Stable"):t("Rolling Release")),U=b(()=>{var n,i;return p.releaseChannel==="stable"?((n=_.value)==null?void 0:n.needs_release_update)??!1:((i=_.value)==null?void 0:i.needs_rolling_update)??!1}),{notifySuccess:k}=N(),{axios:h}=R(),w=()=>{h.get(f.value).then(n=>{_.value=n.data})},{showAlert:x}=$(),C=()=>{x({title:t("Update Aplus? Your installation will restart."),confirmButtonText:t("Update via Web")}).then(n=>{n.value&&h.put(f.value).then(()=>{k(t("Update started. Your installation will restart shortly."))})})};return(n,i)=>{const I=V("router-link");return c(),r(z,null,[e("h2",E,s(a(t)("Update Aplus")),1),e("div",H,[e("div",M,[o(u,{"header-id":"hdr_update_details",title:a(t)("Update Details")},{footer_actions:l(()=>[e("button",{type:"button",class:"btn btn-info",onClick:i[0]||(i[0]=A=>w())},[o(d,{icon:a(B)},null,8,["icon"]),v(" "+s(a(t)("Check for Updates")),1)])]),default:l(()=>[e("div",Q,[U.value?(c(),r("div",j,s(a(t)("Your installation needs to be updated. Updating is recommended for performance and security improvements.")),1)):(c(),r("div",G,s(a(t)("Your installation is up to date! No update is required.")),1))])]),_:1},8,["title"])]),e("div",J,[o(u,{"header-id":"hdr_release_channel",title:a(t)("Release Channel")},{footer_actions:l(()=>[e("a",P,[o(d,{icon:a(m)},null,8,["icon"]),v(" "+s(a(t)("About Release Channels")),1)])]),default:l(()=>[e("div",K,[e("p",L,s(a(t)("Your installation is currently on this release channel:")),1),e("p",O,s(g.value),1)])]),_:1},8,["title"])])]),e("div",X,[e("div",Z,[o(u,{"header-id":"hdr_update_via_web",title:a(t)("Update Aplus via Web")},q({default:l(()=>[n.enableWebUpdates?(c(),r("div",ee,[e("p",te,s(a(t)("For simple updates where you want to keep your current configuration, you can update directly via your web browser. You will be disconnected from the web interface and listeners will be disconnected from all stations.")),1),e("p",ae,s(a(t)("Backing up your installation is strongly recommended before any update.")),1)])):(c(),r("div",se,[e("p",oe,s(a(t)("Web updates are not available for your installation. To update your installation, perform the manual update process instead.")),1)]))]),_:2},[n.enableWebUpdates?{name:"footer_actions",fn:l(()=>[o(I,{to:{name:"admin:backups:index"},class:"btn btn-dark"},{default:l(()=>[o(d,{icon:a(S)},null,8,["icon"]),e("span",null,s(a(t)("Backup")),1)]),_:1}),e("button",{type:"button",class:"btn btn-success",onClick:i[1]||(i[1]=A=>C())},[o(d,{icon:a(W)},null,8,["icon"]),e("span",null,s(a(t)("Update via Web")),1)])]),key:"0"}:void 0]),1032,["title"])]),e("div",ne,[o(u,{"header-id":"hdr_manual_updates",title:a(t)("Manual Updates")},{default:l(()=>[e("div",le,[e("p",ie,s(a(t)("To customize installation settings, or if automatic updates are disabled, you can follow our standard update instructions to update via your SSH console.")),1),e("a",de,[o(d,{icon:a(m)},null,8,["icon"]),e("span",null,s(a(t)("Update Instructions")),1)])])]),_:1},8,["title"])])])],64)}}});export{ye as default};
