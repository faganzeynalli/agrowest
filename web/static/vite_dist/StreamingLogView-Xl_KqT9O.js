import{d as g,B as _}from"./usePlayerStore-BkbxZM90.js";import{_ as x}from"./Loading-DwEn1sGo.js";import{_ as h}from"./FormGroupCheckbox-C9TQi0K1.js";import{d as w,r as l,j as B,s as V,U as $,h as k,o as y,w as T,g as U,e as C,q as L}from"./vue-iE2ul1Tq.js";const b=["value"],j=w({__name:"StreamingLogView",props:{logUrl:{}},setup(m,{expose:v}){const c=m,s=l(!1),t=l(""),n=l(null),r=l(!0),{axios:f}=g(),a=B("$textarea");let i=null;const u=()=>{i&&clearInterval(i)};_(u);const d=()=>{f({method:"GET",url:c.logUrl,params:{position:n.value}}).then(e=>{e.data.contents!==""&&(t.value=t.value+e.data.contents+`
`,r.value&&a.value&&L(()=>{var o;a.value.scrollTop=(o=a.value)==null?void 0:o.scrollHeight})),n.value=e.data.position,e.data.eof&&u()}).finally(()=>{s.value=!1})};return V($(c,"logUrl"),e=>{s.value=!0,t.value="",n.value=0,u(),e!==""&&(i=setInterval(d,2500),d())},{immediate:!0}),v({getContents:()=>t.value}),(e,o)=>(y(),k(x,{loading:s.value},{default:T(()=>[U(h,{id:"modal_scroll_to_bottom",modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=p=>r.value=p),label:e.$gettext("Automatically Scroll to Bottom")},null,8,["modelValue","label"]),C("textarea",{id:"log-view-contents",ref_key:"$textarea",ref:a,class:"form-control log-viewer",spellcheck:"false",readonly:"",value:t.value},null,8,b)]),_:1},8,["loading"]))}});export{j as _};
