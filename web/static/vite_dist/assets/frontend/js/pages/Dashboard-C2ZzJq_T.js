import{u as S,d as A,c as U,i as B}from"../../../../usePlayerStore-DdQU5Axv.js";import{u as C}from"../../../../PanelLayout-F01KFepn.js";import{_ as m,l as L,m as N}from"../../../../icons-Be1GHOkw.js";import{_ as V}from"../../../../PlayButton-CD_zpClU.js";import{a as P}from"../../../../index-1IgMbP_7.js";import{_ as F}from"../../../../Lightbox-zgmbLVpf.js";import{_ as D}from"../../../../CardPage-BV0W_9Ux.js";import{_ as H}from"../../../../HeaderInlinePlayer-CSUeCbia.js";import{u as I}from"../../../../lightbox-CLViexMZ.js";import{u as O}from"../../../../useOptionalStorage-BwYZZeQi.js";import{a as d}from"../../../../router-VMcXwQCR.js";import{_ as T}from"../../../../DataTable-CGqmv_xp.js";import{u as M}from"../../../../useHasDatatable-DPFcIMM0.js";import{d as R,c as h,i as u,b as n,o as i,e as t,g as l,w as r,u as o,t as e,F as b,h as E,f as g}from"../../../../vue-Cts3TEHg.js";import"../../../../bootstrap.esm-BZy605kZ.js";import"../../../../lodash-BwctMegf.js";import"../../../../PanelLayout-BE7EJDHf.js";import"../../../../InfoCard-C2q1AMp7.js";import"../../../../InlinePlayer-BoJVSzUX.js";import"../../../../useShowVolume-B8EAe9Wa.js";import"../../../../hlsjs-Cx0E5yqS.js";import"../../../../formatTime-DvDPwXf4.js";import"../../../../MuteButton-DKcVQ5dR.js";import"../../../../lodash-Bdl6ys83.js";import"../../../../FormMultiCheck-BRaoZhWq.js";import"../../../../FormCheckbox-VeRpO6PO.js";const j={id:"dashboard",class:"row-of-cards"},q={class:"d-flex flex-wrap align-items-center"},z={class:"flex-fill"},G=["id"],J={key:0,class:"flex-shrink-0"},K=["href"],Q={class:"h5 m-0"},W={key:0},X=["href"],Y={class:"pe-1"},Z=["href","aria-label"],ss={class:"d-flex align-items-center"},ts={key:0,class:"flex-fill text-muted"},as={key:1,class:"flex-fill"},es={class:"nowplaying-title"},os={class:"nowplaying-artist"},ns={key:2,class:"flex-fill"},is={class:"nowplaying-title"},ls=["href"],rs=R({__name:"Dashboard",props:{profileUrl:{},adminUrl:{},showAdmin:{type:Boolean},showCharts:{type:Boolean},manageStationsUrl:{},showAlbumArt:{type:Boolean}},setup(cs){const y=d("/frontend/dashboard/notifications");d("/frontend/dashboard/charts");const k=d("/frontend/dashboard/stations"),w=O("dashboard_show_chart",!0),{$gettext:a}=S();h(()=>w.value?a("Hide Charts"):a("Show Charts"));const{axios:x}=A(),{state:ds,isLoading:_s}=P(()=>x.get(y.value).then(c=>c.data),[]),v=[{key:"play_button",label:"",sortable:!1,class:"shrink"},{key:"name",label:a("Station Name"),sortable:!0},{key:"listeners",label:a("Listeners"),sortable:!0},{key:"now_playing",label:a("Now Playing"),sortable:!0},{key:"actions",label:"",sortable:!1,class:"shrink"}],_=u("$datatable"),{refresh:$}=M(_);U($,h(()=>document.hidden?3e4:15e3));const p=u("$lightbox");return I(p),(c,f)=>(i(),n(b,null,[t("div",j,[l(D,{"header-id":"hdr_stations"},{header:r(({id:s})=>[t("div",q,[t("div",z,[t("h2",{id:s,class:"card-title"},e(o(a)("Station Overview")),9,G)]),c.showAdmin?(i(),n("div",J,[t("a",{class:"btn btn-dark py-2",href:c.manageStationsUrl},[l(m,{icon:o(N)},null,8,["icon"]),t("span",null,e(o(a)("Manage Stations")),1)],8,K)])):g("",!0)])]),default:r(()=>[l(T,{id:"dashboard_stations",ref_key:"$datatable",ref:_,fields:v,"api-url":o(k),paginated:"",responsive:"","show-toolbar":"","hide-on-loading":!1},{"cell(play_button)":r(({item:s})=>[l(V,{class:"file-icon btn-lg",url:s.station.listen_url,"is-stream":""},null,8,["url"])]),"cell(name)":r(({item:s})=>[t("div",Q,e(s.station.name),1),s.station.is_public?(i(),n("div",W,[t("a",{href:s.links.public,target:"_blank"},e(o(a)("Public Page")),9,X)])):g("",!0)]),"cell(listeners)":r(({item:s})=>[t("span",Y,[l(m,{class:"sm align-middle",icon:o(L)},null,8,["icon"])]),s.links.listeners?(i(),n("a",{key:0,href:s.links.listeners,"aria-label":o(a)("View Listener Report")},e(s.listeners.total),9,Z)):(i(),n(b,{key:1},[E(e(s.listeners.total),1)],64))]),"cell(now_playing)":r(({item:s})=>[t("div",ss,[s.is_online?s.now_playing.song.title!==""?(i(),n("div",as,[t("strong",null,[t("span",es,e(s.now_playing.song.title),1)]),f[0]||(f[0]=t("br",null,null,-1)),t("span",os,e(s.now_playing.song.artist),1)])):(i(),n("div",ns,[t("strong",null,[t("span",is,e(s.now_playing.song.text),1)])])):(i(),n("div",ts,e(o(a)("Station Offline")),1))])]),"cell(actions)":r(({item:s})=>[t("a",{class:"btn btn-primary",href:s.links.manage,role:"button"},e(o(a)("Manage")),9,ls)]),_:1},8,["api-url"])]),_:1})]),l(H),l(F,{ref_key:"$lightbox",ref:p},null,512)],64))}});B(C(rs));
