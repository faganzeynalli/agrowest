import{u as S,d as A,c as U,i as B}from"../../../../usePlayerStore-BGNIt4QJ.js";import{u as C}from"../../../../PanelLayout-DRn862xC.js";import{_ as f,l as L,m as N}from"../../../../icons-Be1GHOkw.js";import{_ as V}from"../../../../PlayButton-DvWP_uIk.js";import{a as F}from"../../../../index-D6QLPxUX.js";import{_ as P}from"../../../../Lightbox-zgmbLVpf.js";import{_ as D}from"../../../../CardPage-BV0W_9Ux.js";import{_ as H}from"../../../../HeaderInlinePlayer-B3-MGtwy.js";import{u as I}from"../../../../lightbox-CLViexMZ.js";import{u as M}from"../../../../useOptionalStorage-Bjdc4CxS.js";import{a as d}from"../../../../router-CpPGIVZa.js";import{_ as O}from"../../../../DataTable-Cfhib7L5.js";import{u as T}from"../../../../useHasDatatable-DPFcIMM0.js";import{d as R,p as E,c as h,i as u,b as n,o as i,e as t,g as l,w as r,u as o,t as e,F as b,h as j,f as g}from"../../../../vue-Cts3TEHg.js";import"../../../../bootstrap.esm-BZy605kZ.js";import"../../../../lodash-BwctMegf.js";import"../../../../PanelLayout-C-E8ehVP.js";import"../../../../InfoCard-C2q1AMp7.js";import"../../../../InlinePlayer-D_QxWX7K.js";import"../../../../useShowVolume-BlY6kpzJ.js";import"../../../../hlsjs-Cx0E5yqS.js";import"../../../../formatTime-DvDPwXf4.js";import"../../../../MuteButton-CzYpuUx6.js";import"../../../../lodash-Bdl6ys83.js";import"../../../../FormMultiCheck-BRaoZhWq.js";import"../../../../FormCheckbox-VeRpO6PO.js";const q={id:"dashboard",class:"row-of-cards"},z={class:"d-flex flex-wrap align-items-center"},G={class:"flex-fill"},J=["id"],K={key:0,class:"flex-shrink-0"},Q=["href"],W={class:"h5 m-0"},X={key:0},Y=["href"],Z={class:"pe-1"},ss=["href","aria-label"],ts={class:"d-flex align-items-center"},as={key:0,class:"flex-fill text-muted"},es={key:1,class:"flex-fill"},os={class:"nowplaying-title"},ns={class:"nowplaying-artist"},is={key:2,class:"flex-fill"},ls={class:"nowplaying-title"},rs=["href"],cs=R({__name:"Dashboard",props:{profileUrl:{},adminUrl:{},showAdmin:{type:Boolean},showCharts:{type:Boolean},manageStationsUrl:{},showAlbumArt:{type:Boolean}},setup(ds){E(()=>{document.title="Fiallar"});const y=d("/frontend/dashboard/notifications");d("/frontend/dashboard/charts");const k=d("/frontend/dashboard/stations"),w=M("dashboard_show_chart",!0),{$gettext:a}=S();h(()=>w.value?a("Hide Charts"):a("Show Charts"));const{axios:x}=A(),{state:_s,isLoading:ps}=F(()=>x.get(y.value).then(c=>c.data),[]),v=[{key:"play_button",label:"",sortable:!1,class:"shrink"},{key:"name",label:a("Station Name"),sortable:!0},{key:"listeners",label:a("Listeners"),sortable:!0},{key:"now_playing",label:a("Now Playing"),sortable:!0},{key:"actions",label:"",sortable:!1,class:"shrink"}],_=u("$datatable"),{refresh:$}=T(_);U($,h(()=>document.hidden?3e4:15e3));const p=u("$lightbox");return I(p),(c,m)=>(i(),n(b,null,[t("div",q,[l(D,{"header-id":"hdr_stations"},{header:r(({id:s})=>[t("div",z,[t("div",G,[t("h2",{id:s,class:"card-title"},e(o(a)("Station Overview")),9,J)]),c.showAdmin?(i(),n("div",K,[t("a",{class:"btn btn-dark py-2",href:c.manageStationsUrl},[l(f,{icon:o(N)},null,8,["icon"]),t("span",null,e(o(a)("Manage Stations")),1)],8,Q)])):g("",!0)])]),default:r(()=>[l(O,{id:"dashboard_stations",ref_key:"$datatable",ref:_,fields:v,"api-url":o(k),paginated:"",responsive:"","show-toolbar":"","hide-on-loading":!1},{"cell(play_button)":r(({item:s})=>[l(V,{class:"file-icon btn-lg",url:s.station.listen_url,"is-stream":""},null,8,["url"])]),"cell(name)":r(({item:s})=>[t("div",W,e(s.station.name),1),s.station.is_public?(i(),n("div",X,[t("a",{href:s.links.public,target:"_blank"},e(o(a)("Public Page")),9,Y)])):g("",!0)]),"cell(listeners)":r(({item:s})=>[t("span",Z,[l(f,{class:"sm align-middle",icon:o(L)},null,8,["icon"])]),s.links.listeners?(i(),n("a",{key:0,href:s.links.listeners,"aria-label":o(a)("View Listener Report")},e(s.listeners.total),9,ss)):(i(),n(b,{key:1},[j(e(s.listeners.total),1)],64))]),"cell(now_playing)":r(({item:s})=>[t("div",ts,[s.is_online?s.now_playing.song.title!==""?(i(),n("div",es,[t("strong",null,[t("span",os,e(s.now_playing.song.title),1)]),m[0]||(m[0]=t("br",null,null,-1)),t("span",ns,e(s.now_playing.song.artist),1)])):(i(),n("div",is,[t("strong",null,[t("span",ls,e(s.now_playing.song.text),1)])])):(i(),n("div",as,e(o(a)("Station Offline")),1))])]),"cell(actions)":r(({item:s})=>[t("a",{class:"btn btn-primary",href:s.links.manage,role:"button"},e(o(a)("Manage")),9,rs)]),_:1},8,["api-url"])]),_:1})]),l(H),l(P,{ref_key:"$lightbox",ref:p},null,512)],64))}});B(C(cs));
