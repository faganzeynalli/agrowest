import{_ as yt,j as Tt,r as $t}from"../../../../icons-Be1GHOkw.js";import{m as Nt}from"../../../../mergeExisting-DGzkK79d.js";import{r as J,e as kt,m as It,c as Lt}from"../../../../index-Hn1RL1dT.js";import{_ as O}from"../../../../index-B7HOtTO3.js";import{u as oe,f as bt,d as X,i as Ut}from"../../../../usePlayerStore-D2Yy6Bxy.js";import{o as Dt}from"../../../../FormMultiCheck-BRaoZhWq.js";import{_ as Ft}from"../../../../FormGroupMultiCheck-DiXBs_id.js";import{u as qt}from"../../../../useFormField-CVK_EJdG.js";import{d as F,c as ae,j as ee,o as k,A as Vt,u as M,b as U,e as $,g as L,r as W,i as V,w as D,f as re,D as zt,E as Ht,t as I,F as Ue,y as xt,G as vt,p as Kt,h as De,n as Jt,k as Ot,z as jt,m as Yt,v as Gt,H as Qt}from"../../../../vue-Cts3TEHg.js";import{_ as Fe}from"../../../../ModalForm-fxrU3nGH.js";import{u as le,a as Wt}from"../../../../useVuelidateOnForm-CVJ7UnZt.js";import{a as Z}from"../../../../router-4MaTkvgX.js";import{u as qe,_ as Zt}from"../../../../useHasModal-BWWcbDj3.js";import{u as Ct}from"../../../../useRefreshableAsyncState-C6QuzHgO.js";import{_ as Xt}from"../../../../CardPage-BV0W_9Ux.js";import{_ as en}from"../../../../CopyToClipboardButton-BVutCxBA.js";import{_ as tn}from"../../../../FormFieldset-BDg23QuA.js";import{v as nn}from"../../../../validatePassword-tAK3Ex3f.js";import{u as Ke}from"../../../../useConfirmAndDelete-C4MHdaK7.js";import{u as rn}from"../../../../useHasDatatable-DPFcIMM0.js";import{I as on}from"../../../../InvisibleSubmitButton-EsMx6l8t.js";import{_ as sn}from"../../../../FormMarkup-B1oZzq5z.js";import{u as an}from"../../../../useWebAuthn-CjSxi_fw.js";import{u as ln}from"../../../../PanelLayout-rSIPVLyR.js";import"../../../../lodash-Bdl6ys83.js";import"../../../../lodash-BwctMegf.js";import"../../../../FormGroup-LCbWR38E.js";import"../../../../bootstrap.esm-BZy605kZ.js";import"../../../../useSlotsExcept-By0Eq2ad.js";import"../../../../index-Bav4EGom.js";import"../../../../Loading-vp9RNwAY.js";import"../../../../InfoCard-C2q1AMp7.js";import"../../../../zxcvbn-C681xa0x.js";import"../../../../useDialog-B4KfCD8t.js";import"../../../../_plugin-vue_export-helper-DlAUqK2U.js";import"../../../../PanelLayout-DRke5ZH-.js";import"../../../../useOptionalStorage-DBOfakfd.js";const un=F({__name:"TimeRadios",props:{modelValue:{type:[Boolean,null]},field:{},required:{type:Boolean},id:{}},emits:["update:modelValue"],setup(o,{emit:r}){const s=o,n=r,{model:e}=qt(s,n),t=ae({get(){const a=e.value;return a===!0?"true":a===!1?"false":""},set(a){a===!0||a==="true"?e.value=!0:a===!1||a==="false"?e.value=!1:e.value=null}}),{$gettext:i}=oe(),l=ae(()=>[{text:i("Prefer System Default"),value:""},{text:i("12 Hour"),value:"false"},{text:i("24 Hour"),value:"true"}]);return(a,u)=>(k(),ee(Ft,Vt({id:a.id},a.$attrs,{modelValue:t.value,"onUpdate:modelValue":u[0]||(u[0]=f=>t.value=f),options:l.value,stacked:"",radio:"",label:M(i)("Time Display")}),null,16,["id","modelValue","options","label"]))}}),cn={class:"row g-3"},dn={class:"col-md-6"},fn={class:"col-md-6"},hn=F({__name:"EditForm",props:{supportedLocales:{},form:{}},setup(o){const r=o,{$gettext:s}=oe();return ae(()=>{const n=Dt(r.supportedLocales).value;return n.unshift({text:s("Use Browser Default"),value:"default"}),n}),(n,e)=>(k(),U("div",cn,[$("div",dn,[L(O,{id:"form_name",class:"mb-3",tabindex:"1",field:n.form.name,label:M(s)("Name")},null,8,["field","label"]),L(O,{id:"form_email",class:"mb-3",tabindex:"2",field:n.form.email,label:M(s)("E-mail Address")},null,8,["field","label"])]),$("div",fn,[L(un,{id:"edit_form_show_24_hour_time",class:"mb-3",tabindex:"3",field:n.form.show_24_hour_time},null,8,["field"])])]))}}),gn=F({__name:"EditModal",props:{supportedLocales:{}},emits:["reload"],setup(o,{expose:r,emit:s}){const n=s,e=Z("/frontend/account/me"),t=W(!0),i=W(null),{form:l,resetForm:a,v$:u,ifValid:f}=le({name:{},email:{required:J,email:kt},locale:{required:J},show_24_hour_time:{}},{name:"",email:"",locale:"default",show_24_hour_time:null}),h=()=>{a(),t.value=!1,i.value=null},g=V("$modal"),{show:c,hide:y}=qe(g),{notifySuccess:B}=bt(),{axios:N}=X(),w=()=>{h(),c(),N.get(e.value).then(_=>{l.value=Nt(l.value,_.data),t.value=!1}).catch(()=>{y()})},P=()=>{f(()=>{i.value=null,N({method:"PUT",url:e.value,data:l.value}).then(()=>{B(),n("reload"),y()}).catch(_=>{_.value=_.response.data.message})})};return r({open:w}),(_,v)=>(k(),ee(Fe,{ref_key:"$modal",ref:g,loading:t.value,title:_.$gettext("Edit Profile"),error:i.value,"disable-save-button":M(u).$invalid,onSubmit:P,onHidden:h},{default:D(()=>[L(hn,{form:M(u),"supported-locales":_.supportedLocales},null,8,["form","supported-locales"])]),_:1},8,["loading","title","error","disable-save-button"]))}}),mn=["href","title","aria-label"],pn=["src"],wn=F({__name:"Avatar",props:{url:{},service:{},serviceUrl:{},width:{default:64}},setup(o){const r=o,{$gettext:s}=oe(),n=ae(()=>s("Avatars are retrieved based on your e-mail address from the %{service} service. Click to manage your %{service} settings.",{service:r.service??""}));return(e,t)=>e.serviceUrl?(k(),U("a",{key:0,href:e.serviceUrl,class:"avatar",target:"_blank",title:n.value,"aria-label":M(s)("Manage Avatar")},[$("img",{src:e.url,style:zt({width:e.width+"px",height:"auto"}),alt:""},null,12,pn)],8,mn)):re("",!0)}}),_n={class:"card-header text-bg-primary d-flex flex-wrap align-items-center"},yn={class:"flex-fill"},bn={key:0,class:"card-title mt-0"},vn={key:1,class:"card-title"},Cn={class:"card-subtitle"},En={key:2,class:"mt-2"},Bn={key:1,class:"flex-md-shrink-0 mt-3 mt-md-0 buttons"},An=F({__name:"UserInfoPanel",setup(o,{expose:r}){const s=Ht(),{axios:n}=X(),e=Z("/frontend/account/me"),{state:t,execute:i}=Ct(()=>n.get(e.value).then(l=>l.data),{name:null,email:null,avatar:{url_128:null,service_name:null,service_url:null},roles:[]});return r({reload:i}),(l,a)=>(k(),U("div",_n,[M(t).avatar.url_128?(k(),ee(wn,{key:0,class:"flex-shrink-0 me-3",url:M(t).avatar.url_128,service:M(t).avatar.service_name,"service-url":M(t).avatar.service_url},null,8,["url","service","service-url"])):re("",!0),$("div",yn,[M(t).name?(k(),U("h2",bn,I(M(t).name),1)):(k(),U("h2",vn,I(l.$gettext("Aplus User")),1)),$("h3",Cn,I(M(t).email),1),M(t).roles.length>0?(k(),U("div",En,[(k(!0),U(Ue,null,xt(M(t).roles,u=>(k(),U("span",{key:u.id,class:"badge text-bg-secondary me-2"},I(u.name),1))),128))])):re("",!0)]),s.default?(k(),U("div",Bn,[vt(l.$slots,"default")])):re("",!0)]))}});var Q={},he,Je;function Pn(){return Je||(Je=1,he=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),he}var ge={},K={},Oe;function j(){if(Oe)return K;Oe=1;let o;const r=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return K.getSymbolSize=function(n){if(!n)throw new Error('"version" cannot be null or undefined');if(n<1||n>40)throw new Error('"version" should be in range from 1 to 40');return n*4+17},K.getSymbolTotalCodewords=function(n){return r[n]},K.getBCHDigit=function(s){let n=0;for(;s!==0;)n++,s>>>=1;return n},K.setToSJISFunction=function(n){if(typeof n!="function")throw new Error('"toSJISFunc" is not a valid function.');o=n},K.isKanjiModeEnabled=function(){return typeof o<"u"},K.toSJIS=function(n){return o(n)},K}var me={},je;function Ve(){return je||(je=1,function(o){o.L={bit:1},o.M={bit:0},o.Q={bit:3},o.H={bit:2};function r(s){if(typeof s!="string")throw new Error("Param is not a string");switch(s.toLowerCase()){case"l":case"low":return o.L;case"m":case"medium":return o.M;case"q":case"quartile":return o.Q;case"h":case"high":return o.H;default:throw new Error("Unknown EC Level: "+s)}}o.isValid=function(n){return n&&typeof n.bit<"u"&&n.bit>=0&&n.bit<4},o.from=function(n,e){if(o.isValid(n))return n;try{return r(n)}catch{return e}}}(me)),me}var pe,Ye;function Rn(){if(Ye)return pe;Ye=1;function o(){this.buffer=[],this.length=0}return o.prototype={get:function(r){const s=Math.floor(r/8);return(this.buffer[s]>>>7-r%8&1)===1},put:function(r,s){for(let n=0;n<s;n++)this.putBit((r>>>s-n-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(r){const s=Math.floor(this.length/8);this.buffer.length<=s&&this.buffer.push(0),r&&(this.buffer[s]|=128>>>this.length%8),this.length++}},pe=o,pe}var we,Ge;function Mn(){if(Ge)return we;Ge=1;function o(r){if(!r||r<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=r,this.data=new Uint8Array(r*r),this.reservedBit=new Uint8Array(r*r)}return o.prototype.set=function(r,s,n,e){const t=r*this.size+s;this.data[t]=n,e&&(this.reservedBit[t]=!0)},o.prototype.get=function(r,s){return this.data[r*this.size+s]},o.prototype.xor=function(r,s,n){this.data[r*this.size+s]^=n},o.prototype.isReserved=function(r,s){return this.reservedBit[r*this.size+s]},we=o,we}var _e={},Qe;function Sn(){return Qe||(Qe=1,function(o){const r=j().getSymbolSize;o.getRowColCoords=function(n){if(n===1)return[];const e=Math.floor(n/7)+2,t=r(n),i=t===145?26:Math.ceil((t-13)/(2*e-2))*2,l=[t-7];for(let a=1;a<e-1;a++)l[a]=l[a-1]-i;return l.push(6),l.reverse()},o.getPositions=function(n){const e=[],t=o.getRowColCoords(n),i=t.length;for(let l=0;l<i;l++)for(let a=0;a<i;a++)l===0&&a===0||l===0&&a===i-1||l===i-1&&a===0||e.push([t[l],t[a]]);return e}}(_e)),_e}var ye={},We;function Tn(){if(We)return ye;We=1;const o=j().getSymbolSize,r=7;return ye.getPositions=function(n){const e=o(n);return[[0,0],[e-r,0],[0,e-r]]},ye}var be={},Ze;function $n(){return Ze||(Ze=1,function(o){o.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const r={N1:3,N2:3,N3:40,N4:10};o.isValid=function(e){return e!=null&&e!==""&&!isNaN(e)&&e>=0&&e<=7},o.from=function(e){return o.isValid(e)?parseInt(e,10):void 0},o.getPenaltyN1=function(e){const t=e.size;let i=0,l=0,a=0,u=null,f=null;for(let h=0;h<t;h++){l=a=0,u=f=null;for(let g=0;g<t;g++){let c=e.get(h,g);c===u?l++:(l>=5&&(i+=r.N1+(l-5)),u=c,l=1),c=e.get(g,h),c===f?a++:(a>=5&&(i+=r.N1+(a-5)),f=c,a=1)}l>=5&&(i+=r.N1+(l-5)),a>=5&&(i+=r.N1+(a-5))}return i},o.getPenaltyN2=function(e){const t=e.size;let i=0;for(let l=0;l<t-1;l++)for(let a=0;a<t-1;a++){const u=e.get(l,a)+e.get(l,a+1)+e.get(l+1,a)+e.get(l+1,a+1);(u===4||u===0)&&i++}return i*r.N2},o.getPenaltyN3=function(e){const t=e.size;let i=0,l=0,a=0;for(let u=0;u<t;u++){l=a=0;for(let f=0;f<t;f++)l=l<<1&2047|e.get(u,f),f>=10&&(l===1488||l===93)&&i++,a=a<<1&2047|e.get(f,u),f>=10&&(a===1488||a===93)&&i++}return i*r.N3},o.getPenaltyN4=function(e){let t=0;const i=e.data.length;for(let a=0;a<i;a++)t+=e.data[a];return Math.abs(Math.ceil(t*100/i/5)-10)*r.N4};function s(n,e,t){switch(n){case o.Patterns.PATTERN000:return(e+t)%2===0;case o.Patterns.PATTERN001:return e%2===0;case o.Patterns.PATTERN010:return t%3===0;case o.Patterns.PATTERN011:return(e+t)%3===0;case o.Patterns.PATTERN100:return(Math.floor(e/2)+Math.floor(t/3))%2===0;case o.Patterns.PATTERN101:return e*t%2+e*t%3===0;case o.Patterns.PATTERN110:return(e*t%2+e*t%3)%2===0;case o.Patterns.PATTERN111:return(e*t%3+(e+t)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}o.applyMask=function(e,t){const i=t.size;for(let l=0;l<i;l++)for(let a=0;a<i;a++)t.isReserved(a,l)||t.xor(a,l,s(e,a,l))},o.getBestMask=function(e,t){const i=Object.keys(o.Patterns).length;let l=0,a=1/0;for(let u=0;u<i;u++){t(u),o.applyMask(u,e);const f=o.getPenaltyN1(e)+o.getPenaltyN2(e)+o.getPenaltyN3(e)+o.getPenaltyN4(e);o.applyMask(u,e),f<a&&(a=f,l=u)}return l}}(be)),be}var ie={},Xe;function Et(){if(Xe)return ie;Xe=1;const o=Ve(),r=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],s=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return ie.getBlocksCount=function(e,t){switch(t){case o.L:return r[(e-1)*4+0];case o.M:return r[(e-1)*4+1];case o.Q:return r[(e-1)*4+2];case o.H:return r[(e-1)*4+3];default:return}},ie.getTotalCodewordsCount=function(e,t){switch(t){case o.L:return s[(e-1)*4+0];case o.M:return s[(e-1)*4+1];case o.Q:return s[(e-1)*4+2];case o.H:return s[(e-1)*4+3];default:return}},ie}var ve={},ne={},et;function Nn(){if(et)return ne;et=1;const o=new Uint8Array(512),r=new Uint8Array(256);return function(){let n=1;for(let e=0;e<255;e++)o[e]=n,r[n]=e,n<<=1,n&256&&(n^=285);for(let e=255;e<512;e++)o[e]=o[e-255]}(),ne.log=function(n){if(n<1)throw new Error("log("+n+")");return r[n]},ne.exp=function(n){return o[n]},ne.mul=function(n,e){return n===0||e===0?0:o[r[n]+r[e]]},ne}var tt;function kn(){return tt||(tt=1,function(o){const r=Nn();o.mul=function(n,e){const t=new Uint8Array(n.length+e.length-1);for(let i=0;i<n.length;i++)for(let l=0;l<e.length;l++)t[i+l]^=r.mul(n[i],e[l]);return t},o.mod=function(n,e){let t=new Uint8Array(n);for(;t.length-e.length>=0;){const i=t[0];for(let a=0;a<e.length;a++)t[a]^=r.mul(e[a],i);let l=0;for(;l<t.length&&t[l]===0;)l++;t=t.slice(l)}return t},o.generateECPolynomial=function(n){let e=new Uint8Array([1]);for(let t=0;t<n;t++)e=o.mul(e,new Uint8Array([1,r.exp(t)]));return e}}(ve)),ve}var Ce,nt;function In(){if(nt)return Ce;nt=1;const o=kn();function r(s){this.genPoly=void 0,this.degree=s,this.degree&&this.initialize(this.degree)}return r.prototype.initialize=function(n){this.degree=n,this.genPoly=o.generateECPolynomial(this.degree)},r.prototype.encode=function(n){if(!this.genPoly)throw new Error("Encoder not initialized");const e=new Uint8Array(n.length+this.degree);e.set(n);const t=o.mod(e,this.genPoly),i=this.degree-t.length;if(i>0){const l=new Uint8Array(this.degree);return l.set(t,i),l}return t},Ce=r,Ce}var Ee={},Be={},Ae={},rt;function Bt(){return rt||(rt=1,Ae.isValid=function(r){return!isNaN(r)&&r>=1&&r<=40}),Ae}var q={},ot;function At(){if(ot)return q;ot=1;const o="[0-9]+",r="[A-Z $%*+\\-./:]+";let s="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";s=s.replace(/u/g,"\\u");const n="(?:(?![A-Z0-9 $%*+\\-./:]|"+s+`)(?:.|[\r
]))+`;q.KANJI=new RegExp(s,"g"),q.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),q.BYTE=new RegExp(n,"g"),q.NUMERIC=new RegExp(o,"g"),q.ALPHANUMERIC=new RegExp(r,"g");const e=new RegExp("^"+s+"$"),t=new RegExp("^"+o+"$"),i=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return q.testKanji=function(a){return e.test(a)},q.testNumeric=function(a){return t.test(a)},q.testAlphanumeric=function(a){return i.test(a)},q}var st;function Y(){return st||(st=1,function(o){const r=Bt(),s=At();o.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},o.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},o.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},o.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},o.MIXED={bit:-1},o.getCharCountIndicator=function(t,i){if(!t.ccBits)throw new Error("Invalid mode: "+t);if(!r.isValid(i))throw new Error("Invalid version: "+i);return i>=1&&i<10?t.ccBits[0]:i<27?t.ccBits[1]:t.ccBits[2]},o.getBestModeForData=function(t){return s.testNumeric(t)?o.NUMERIC:s.testAlphanumeric(t)?o.ALPHANUMERIC:s.testKanji(t)?o.KANJI:o.BYTE},o.toString=function(t){if(t&&t.id)return t.id;throw new Error("Invalid mode")},o.isValid=function(t){return t&&t.bit&&t.ccBits};function n(e){if(typeof e!="string")throw new Error("Param is not a string");switch(e.toLowerCase()){case"numeric":return o.NUMERIC;case"alphanumeric":return o.ALPHANUMERIC;case"kanji":return o.KANJI;case"byte":return o.BYTE;default:throw new Error("Unknown mode: "+e)}}o.from=function(t,i){if(o.isValid(t))return t;try{return n(t)}catch{return i}}}(Be)),Be}var it;function Ln(){return it||(it=1,function(o){const r=j(),s=Et(),n=Ve(),e=Y(),t=Bt(),i=7973,l=r.getBCHDigit(i);function a(g,c,y){for(let B=1;B<=40;B++)if(c<=o.getCapacity(B,y,g))return B}function u(g,c){return e.getCharCountIndicator(g,c)+4}function f(g,c){let y=0;return g.forEach(function(B){const N=u(B.mode,c);y+=N+B.getBitsLength()}),y}function h(g,c){for(let y=1;y<=40;y++)if(f(g,y)<=o.getCapacity(y,c,e.MIXED))return y}o.from=function(c,y){return t.isValid(c)?parseInt(c,10):y},o.getCapacity=function(c,y,B){if(!t.isValid(c))throw new Error("Invalid QR Code version");typeof B>"u"&&(B=e.BYTE);const N=r.getSymbolTotalCodewords(c),w=s.getTotalCodewordsCount(c,y),P=(N-w)*8;if(B===e.MIXED)return P;const _=P-u(B,c);switch(B){case e.NUMERIC:return Math.floor(_/10*3);case e.ALPHANUMERIC:return Math.floor(_/11*2);case e.KANJI:return Math.floor(_/13);case e.BYTE:default:return Math.floor(_/8)}},o.getBestVersionForData=function(c,y){let B;const N=n.from(y,n.M);if(Array.isArray(c)){if(c.length>1)return h(c,N);if(c.length===0)return 1;B=c[0]}else B=c;return a(B.mode,B.getLength(),N)},o.getEncodedBits=function(c){if(!t.isValid(c)||c<7)throw new Error("Invalid QR Code version");let y=c<<12;for(;r.getBCHDigit(y)-l>=0;)y^=i<<r.getBCHDigit(y)-l;return c<<12|y}}(Ee)),Ee}var Pe={},at;function Un(){if(at)return Pe;at=1;const o=j(),r=1335,s=21522,n=o.getBCHDigit(r);return Pe.getEncodedBits=function(t,i){const l=t.bit<<3|i;let a=l<<10;for(;o.getBCHDigit(a)-n>=0;)a^=r<<o.getBCHDigit(a)-n;return(l<<10|a)^s},Pe}var Re={},Me,lt;function Dn(){if(lt)return Me;lt=1;const o=Y();function r(s){this.mode=o.NUMERIC,this.data=s.toString()}return r.getBitsLength=function(n){return 10*Math.floor(n/3)+(n%3?n%3*3+1:0)},r.prototype.getLength=function(){return this.data.length},r.prototype.getBitsLength=function(){return r.getBitsLength(this.data.length)},r.prototype.write=function(n){let e,t,i;for(e=0;e+3<=this.data.length;e+=3)t=this.data.substr(e,3),i=parseInt(t,10),n.put(i,10);const l=this.data.length-e;l>0&&(t=this.data.substr(e),i=parseInt(t,10),n.put(i,l*3+1))},Me=r,Me}var Se,ut;function Fn(){if(ut)return Se;ut=1;const o=Y(),r=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function s(n){this.mode=o.ALPHANUMERIC,this.data=n}return s.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)},s.prototype.getLength=function(){return this.data.length},s.prototype.getBitsLength=function(){return s.getBitsLength(this.data.length)},s.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let i=r.indexOf(this.data[t])*45;i+=r.indexOf(this.data[t+1]),e.put(i,11)}this.data.length%2&&e.put(r.indexOf(this.data[t]),6)},Se=s,Se}var Te,ct;function qn(){if(ct)return Te;ct=1;const o=Y();function r(s){this.mode=o.BYTE,typeof s=="string"?this.data=new TextEncoder().encode(s):this.data=new Uint8Array(s)}return r.getBitsLength=function(n){return n*8},r.prototype.getLength=function(){return this.data.length},r.prototype.getBitsLength=function(){return r.getBitsLength(this.data.length)},r.prototype.write=function(s){for(let n=0,e=this.data.length;n<e;n++)s.put(this.data[n],8)},Te=r,Te}var $e,dt;function Vn(){if(dt)return $e;dt=1;const o=Y(),r=j();function s(n){this.mode=o.KANJI,this.data=n}return s.getBitsLength=function(e){return e*13},s.prototype.getLength=function(){return this.data.length},s.prototype.getBitsLength=function(){return s.getBitsLength(this.data.length)},s.prototype.write=function(n){let e;for(e=0;e<this.data.length;e++){let t=r.toSJIS(this.data[e]);if(t>=33088&&t<=40956)t-=33088;else if(t>=57408&&t<=60351)t-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);t=(t>>>8&255)*192+(t&255),n.put(t,13)}},$e=s,$e}var Ne={exports:{}},ft;function zn(){return ft||(ft=1,function(o){var r={single_source_shortest_paths:function(s,n,e){var t={},i={};i[n]=0;var l=r.PriorityQueue.make();l.push(n,0);for(var a,u,f,h,g,c,y,B,N;!l.empty();){a=l.pop(),u=a.value,h=a.cost,g=s[u]||{};for(f in g)g.hasOwnProperty(f)&&(c=g[f],y=h+c,B=i[f],N=typeof i[f]>"u",(N||B>y)&&(i[f]=y,l.push(f,y),t[f]=u))}if(typeof e<"u"&&typeof i[e]>"u"){var w=["Could not find a path from ",n," to ",e,"."].join("");throw new Error(w)}return t},extract_shortest_path_from_predecessor_list:function(s,n){for(var e=[],t=n;t;)e.push(t),s[t],t=s[t];return e.reverse(),e},find_path:function(s,n,e){var t=r.single_source_shortest_paths(s,n,e);return r.extract_shortest_path_from_predecessor_list(t,e)},PriorityQueue:{make:function(s){var n=r.PriorityQueue,e={},t;s=s||{};for(t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.queue=[],e.sorter=s.sorter||n.default_sorter,e},default_sorter:function(s,n){return s.cost-n.cost},push:function(s,n){var e={value:s,cost:n};this.queue.push(e),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};o.exports=r}(Ne)),Ne.exports}var ht;function Hn(){return ht||(ht=1,function(o){const r=Y(),s=Dn(),n=Fn(),e=qn(),t=Vn(),i=At(),l=j(),a=zn();function u(w){return unescape(encodeURIComponent(w)).length}function f(w,P,_){const v=[];let T;for(;(T=w.exec(_))!==null;)v.push({data:T[0],index:T.index,mode:P,length:T[0].length});return v}function h(w){const P=f(i.NUMERIC,r.NUMERIC,w),_=f(i.ALPHANUMERIC,r.ALPHANUMERIC,w);let v,T;return l.isKanjiModeEnabled()?(v=f(i.BYTE,r.BYTE,w),T=f(i.KANJI,r.KANJI,w)):(v=f(i.BYTE_KANJI,r.BYTE,w),T=[]),P.concat(_,v,T).sort(function(m,b){return m.index-b.index}).map(function(m){return{data:m.data,mode:m.mode,length:m.length}})}function g(w,P){switch(P){case r.NUMERIC:return s.getBitsLength(w);case r.ALPHANUMERIC:return n.getBitsLength(w);case r.KANJI:return t.getBitsLength(w);case r.BYTE:return e.getBitsLength(w)}}function c(w){return w.reduce(function(P,_){const v=P.length-1>=0?P[P.length-1]:null;return v&&v.mode===_.mode?(P[P.length-1].data+=_.data,P):(P.push(_),P)},[])}function y(w){const P=[];for(let _=0;_<w.length;_++){const v=w[_];switch(v.mode){case r.NUMERIC:P.push([v,{data:v.data,mode:r.ALPHANUMERIC,length:v.length},{data:v.data,mode:r.BYTE,length:v.length}]);break;case r.ALPHANUMERIC:P.push([v,{data:v.data,mode:r.BYTE,length:v.length}]);break;case r.KANJI:P.push([v,{data:v.data,mode:r.BYTE,length:u(v.data)}]);break;case r.BYTE:P.push([{data:v.data,mode:r.BYTE,length:u(v.data)}])}}return P}function B(w,P){const _={},v={start:{}};let T=["start"];for(let d=0;d<w.length;d++){const m=w[d],b=[];for(let p=0;p<m.length;p++){const R=m[p],C=""+d+p;b.push(C),_[C]={node:R,lastCount:0},v[C]={};for(let A=0;A<T.length;A++){const E=T[A];_[E]&&_[E].node.mode===R.mode?(v[E][C]=g(_[E].lastCount+R.length,R.mode)-g(_[E].lastCount,R.mode),_[E].lastCount+=R.length):(_[E]&&(_[E].lastCount=R.length),v[E][C]=g(R.length,R.mode)+4+r.getCharCountIndicator(R.mode,P))}}T=b}for(let d=0;d<T.length;d++)v[T[d]].end=0;return{map:v,table:_}}function N(w,P){let _;const v=r.getBestModeForData(w);if(_=r.from(P,v),_!==r.BYTE&&_.bit<v.bit)throw new Error('"'+w+'" cannot be encoded with mode '+r.toString(_)+`.
 Suggested mode is: `+r.toString(v));switch(_===r.KANJI&&!l.isKanjiModeEnabled()&&(_=r.BYTE),_){case r.NUMERIC:return new s(w);case r.ALPHANUMERIC:return new n(w);case r.KANJI:return new t(w);case r.BYTE:return new e(w)}}o.fromArray=function(P){return P.reduce(function(_,v){return typeof v=="string"?_.push(N(v,null)):v.data&&_.push(N(v.data,v.mode)),_},[])},o.fromString=function(P,_){const v=h(P,l.isKanjiModeEnabled()),T=y(v),d=B(T,_),m=a.find_path(d.map,"start","end"),b=[];for(let p=1;p<m.length-1;p++)b.push(d.table[m[p]].node);return o.fromArray(c(b))},o.rawSplit=function(P){return o.fromArray(h(P,l.isKanjiModeEnabled()))}}(Re)),Re}var gt;function xn(){if(gt)return ge;gt=1;const o=j(),r=Ve(),s=Rn(),n=Mn(),e=Sn(),t=Tn(),i=$n(),l=Et(),a=In(),u=Ln(),f=Un(),h=Y(),g=Hn();function c(d,m){const b=d.size,p=t.getPositions(m);for(let R=0;R<p.length;R++){const C=p[R][0],A=p[R][1];for(let E=-1;E<=7;E++)if(!(C+E<=-1||b<=C+E))for(let S=-1;S<=7;S++)A+S<=-1||b<=A+S||(E>=0&&E<=6&&(S===0||S===6)||S>=0&&S<=6&&(E===0||E===6)||E>=2&&E<=4&&S>=2&&S<=4?d.set(C+E,A+S,!0,!0):d.set(C+E,A+S,!1,!0))}}function y(d){const m=d.size;for(let b=8;b<m-8;b++){const p=b%2===0;d.set(b,6,p,!0),d.set(6,b,p,!0)}}function B(d,m){const b=e.getPositions(m);for(let p=0;p<b.length;p++){const R=b[p][0],C=b[p][1];for(let A=-2;A<=2;A++)for(let E=-2;E<=2;E++)A===-2||A===2||E===-2||E===2||A===0&&E===0?d.set(R+A,C+E,!0,!0):d.set(R+A,C+E,!1,!0)}}function N(d,m){const b=d.size,p=u.getEncodedBits(m);let R,C,A;for(let E=0;E<18;E++)R=Math.floor(E/3),C=E%3+b-8-3,A=(p>>E&1)===1,d.set(R,C,A,!0),d.set(C,R,A,!0)}function w(d,m,b){const p=d.size,R=f.getEncodedBits(m,b);let C,A;for(C=0;C<15;C++)A=(R>>C&1)===1,C<6?d.set(C,8,A,!0):C<8?d.set(C+1,8,A,!0):d.set(p-15+C,8,A,!0),C<8?d.set(8,p-C-1,A,!0):C<9?d.set(8,15-C-1+1,A,!0):d.set(8,15-C-1,A,!0);d.set(p-8,8,1,!0)}function P(d,m){const b=d.size;let p=-1,R=b-1,C=7,A=0;for(let E=b-1;E>0;E-=2)for(E===6&&E--;;){for(let S=0;S<2;S++)if(!d.isReserved(R,E-S)){let x=!1;A<m.length&&(x=(m[A]>>>C&1)===1),d.set(R,E-S,x),C--,C===-1&&(A++,C=7)}if(R+=p,R<0||b<=R){R-=p,p=-p;break}}}function _(d,m,b){const p=new s;b.forEach(function(S){p.put(S.mode.bit,4),p.put(S.getLength(),h.getCharCountIndicator(S.mode,d)),S.write(p)});const R=o.getSymbolTotalCodewords(d),C=l.getTotalCodewordsCount(d,m),A=(R-C)*8;for(p.getLengthInBits()+4<=A&&p.put(0,4);p.getLengthInBits()%8!==0;)p.putBit(0);const E=(A-p.getLengthInBits())/8;for(let S=0;S<E;S++)p.put(S%2?17:236,8);return v(p,d,m)}function v(d,m,b){const p=o.getSymbolTotalCodewords(m),R=l.getTotalCodewordsCount(m,b),C=p-R,A=l.getBlocksCount(m,b),E=p%A,S=A-E,x=Math.floor(p/A),te=Math.floor(C/A),Rt=te+1,ze=x-te,Mt=new a(ze);let ue=0;const se=new Array(A),He=new Array(A);let ce=0;const St=new Uint8Array(d.buffer);for(let G=0;G<A;G++){const fe=G<S?te:Rt;se[G]=St.slice(ue,ue+fe),He[G]=Mt.encode(se[G]),ue+=fe,ce=Math.max(ce,fe)}const de=new Uint8Array(p);let xe=0,z,H;for(z=0;z<ce;z++)for(H=0;H<A;H++)z<se[H].length&&(de[xe++]=se[H][z]);for(z=0;z<ze;z++)for(H=0;H<A;H++)de[xe++]=He[H][z];return de}function T(d,m,b,p){let R;if(Array.isArray(d))R=g.fromArray(d);else if(typeof d=="string"){let x=m;if(!x){const te=g.rawSplit(d);x=u.getBestVersionForData(te,b)}R=g.fromString(d,x||40)}else throw new Error("Invalid data");const C=u.getBestVersionForData(R,b);if(!C)throw new Error("The amount of data is too big to be stored in a QR Code");if(!m)m=C;else if(m<C)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+C+`.
`);const A=_(m,b,R),E=o.getSymbolSize(m),S=new n(E);return c(S,m),y(S),B(S,m),w(S,b,0),m>=7&&N(S,m),P(S,A),isNaN(p)&&(p=i.getBestMask(S,w.bind(null,S,b))),i.applyMask(p,S),w(S,b,p),{modules:S,version:m,errorCorrectionLevel:b,maskPattern:p,segments:R}}return ge.create=function(m,b){if(typeof m>"u"||m==="")throw new Error("No input text");let p=r.M,R,C;return typeof b<"u"&&(p=r.from(b.errorCorrectionLevel,r.M),R=u.from(b.version),C=i.from(b.maskPattern),b.toSJISFunc&&o.setToSJISFunction(b.toSJISFunc)),T(m,R,p,C)},ge}var ke={},Ie={},mt;function Pt(){return mt||(mt=1,function(o){function r(s){if(typeof s=="number"&&(s=s.toString()),typeof s!="string")throw new Error("Color should be defined as hex string");let n=s.slice().replace("#","").split("");if(n.length<3||n.length===5||n.length>8)throw new Error("Invalid hex color: "+s);(n.length===3||n.length===4)&&(n=Array.prototype.concat.apply([],n.map(function(t){return[t,t]}))),n.length===6&&n.push("F","F");const e=parseInt(n.join(""),16);return{r:e>>24&255,g:e>>16&255,b:e>>8&255,a:e&255,hex:"#"+n.slice(0,6).join("")}}o.getOptions=function(n){n||(n={}),n.color||(n.color={});const e=typeof n.margin>"u"||n.margin===null||n.margin<0?4:n.margin,t=n.width&&n.width>=21?n.width:void 0,i=n.scale||4;return{width:t,scale:t?4:i,margin:e,color:{dark:r(n.color.dark||"#000000ff"),light:r(n.color.light||"#ffffffff")},type:n.type,rendererOpts:n.rendererOpts||{}}},o.getScale=function(n,e){return e.width&&e.width>=n+e.margin*2?e.width/(n+e.margin*2):e.scale},o.getImageWidth=function(n,e){const t=o.getScale(n,e);return Math.floor((n+e.margin*2)*t)},o.qrToImageData=function(n,e,t){const i=e.modules.size,l=e.modules.data,a=o.getScale(i,t),u=Math.floor((i+t.margin*2)*a),f=t.margin*a,h=[t.color.light,t.color.dark];for(let g=0;g<u;g++)for(let c=0;c<u;c++){let y=(g*u+c)*4,B=t.color.light;if(g>=f&&c>=f&&g<u-f&&c<u-f){const N=Math.floor((g-f)/a),w=Math.floor((c-f)/a);B=h[l[N*i+w]?1:0]}n[y++]=B.r,n[y++]=B.g,n[y++]=B.b,n[y]=B.a}}}(Ie)),Ie}var pt;function Kn(){return pt||(pt=1,function(o){const r=Pt();function s(e,t,i){e.clearRect(0,0,t.width,t.height),t.style||(t.style={}),t.height=i,t.width=i,t.style.height=i+"px",t.style.width=i+"px"}function n(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}o.render=function(t,i,l){let a=l,u=i;typeof a>"u"&&(!i||!i.getContext)&&(a=i,i=void 0),i||(u=n()),a=r.getOptions(a);const f=r.getImageWidth(t.modules.size,a),h=u.getContext("2d"),g=h.createImageData(f,f);return r.qrToImageData(g.data,t,a),s(h,u,f),h.putImageData(g,0,0),u},o.renderToDataURL=function(t,i,l){let a=l;typeof a>"u"&&(!i||!i.getContext)&&(a=i,i=void 0),a||(a={});const u=o.render(t,i,a),f=a.type||"image/png",h=a.rendererOpts||{};return u.toDataURL(f,h.quality)}}(ke)),ke}var Le={},wt;function Jn(){if(wt)return Le;wt=1;const o=Pt();function r(e,t){const i=e.a/255,l=t+'="'+e.hex+'"';return i<1?l+" "+t+'-opacity="'+i.toFixed(2).slice(1)+'"':l}function s(e,t,i){let l=e+t;return typeof i<"u"&&(l+=" "+i),l}function n(e,t,i){let l="",a=0,u=!1,f=0;for(let h=0;h<e.length;h++){const g=Math.floor(h%t),c=Math.floor(h/t);!g&&!u&&(u=!0),e[h]?(f++,h>0&&g>0&&e[h-1]||(l+=u?s("M",g+i,.5+c+i):s("m",a,0),a=0,u=!1),g+1<t&&e[h+1]||(l+=s("h",f),f=0)):a++}return l}return Le.render=function(t,i,l){const a=o.getOptions(i),u=t.modules.size,f=t.modules.data,h=u+a.margin*2,g=a.color.light.a?"<path "+r(a.color.light,"fill")+' d="M0 0h'+h+"v"+h+'H0z"/>':"",c="<path "+r(a.color.dark,"stroke")+' d="'+n(f,u,a.margin)+'"/>',y='viewBox="0 0 '+h+" "+h+'"',N='<svg xmlns="http://www.w3.org/2000/svg" '+(a.width?'width="'+a.width+'" height="'+a.width+'" ':"")+y+' shape-rendering="crispEdges">'+g+c+`</svg>
`;return typeof l=="function"&&l(null,N),N},Le}var _t;function On(){if(_t)return Q;_t=1;const o=Pn(),r=xn(),s=Kn(),n=Jn();function e(t,i,l,a,u){const f=[].slice.call(arguments,1),h=f.length,g=typeof f[h-1]=="function";if(!g&&!o())throw new Error("Callback required as last argument");if(g){if(h<2)throw new Error("Too few arguments provided");h===2?(u=l,l=i,i=a=void 0):h===3&&(i.getContext&&typeof u>"u"?(u=a,a=void 0):(u=a,a=l,l=i,i=void 0))}else{if(h<1)throw new Error("Too few arguments provided");return h===1?(l=i,i=a=void 0):h===2&&!i.getContext&&(a=l,l=i,i=void 0),new Promise(function(c,y){try{const B=r.create(l,a);c(t(B,i,a))}catch(B){y(B)}})}try{const c=r.create(l,a);u(null,t(c,i,a))}catch(c){u(c)}}return Q.create=r.create,Q.toCanvas=e.bind(null,s.render),Q.toDataURL=e.bind(null,s.renderToDataURL),Q.toString=e.bind(null,function(t,i,l){return n.render(t,l)}),Q}var jn=On();const Yn=F({__name:"QrCode",props:{uri:{}},setup(o){const r=o,s=V("$canvas");return Kt(()=>{jn.toCanvas(s.value,r.uri,n=>{n&&console.error(n)})}),(n,e)=>(k(),U("canvas",{ref_key:"$canvas",ref:s},null,512))}}),Gn={class:"row"},Qn={class:"col-md-7"},Wn={class:"mt-2"},Zn={class:"card-text"},Xn={class:"mt-0"},er={class:"card-text"},tr={class:"col-md-5"},nr={key:0},rr={id:"totp_uri",class:"d-inline-block text-truncate mt-2",style:{width:"100%"}},or=F({__name:"TwoFactorModal",props:{twoFactorUrl:{}},emits:["relist"],setup(o,{expose:r,emit:s}){const n=o,e=s,t=W(!0),i=W(null),{form:l,resetForm:a,v$:u,ifValid:f}=le({otp:{required:J,minLength:It(6)}},{otp:""}),{record:h,reset:g}=Wt({secret:null,totp_uri:null,qr_code:null}),c=()=>{a(),g(),t.value=!1,i.value=null},y=V("$modal"),{hide:B,show:N}=qe(y),{notifySuccess:w}=bt(),{axios:P}=X(),_=()=>{c(),t.value=!0,N(),P.put(n.twoFactorUrl).then(T=>{h.value=T.data,t.value=!1}).catch(()=>{B()})},v=()=>{f(()=>{i.value=null,P({method:"PUT",url:n.twoFactorUrl,data:{secret:h.value.secret,otp:l.value.otp}}).then(()=>{w(),e("relist"),B()}).catch(T=>{T.value=T.response.data.message})})};return r({open:_}),(T,d)=>(k(),ee(Fe,{ref_key:"$modal",ref:y,loading:t.value,title:T.$gettext("Enable Two-Factor Authentication"),error:i.value,"disable-save-button":M(u).$invalid,"no-enforce-focus":"",onSubmit:v,onHidden:c},{"save-button-name":D(()=>[De(I(T.$gettext("Submit Code")),1)]),default:D(()=>[$("div",Gn,[$("div",Qn,[$("h5",Wn,I(T.$gettext("Step 1: Scan QR Code")),1),$("p",Zn,I(T.$gettext("From your smartphone, scan the code to the right using an authentication app of your choice (FreeOTP, Authy, etc).")),1),$("h5",Xn,I(T.$gettext("Step 2: Verify Generated Code")),1),$("p",er,I(T.$gettext("To verify that the code was set up correctly, enter the 6-digit code the app shows you.")),1),L(tn,null,{default:D(()=>[L(O,{id:"form_otp",field:M(u).otp,autofocus:"",label:T.$gettext("Code from Authenticator App"),description:T.$gettext("Enter the current code provided by your authenticator app to verify that it's working correctly.")},null,8,["field","label","description"])]),_:1})]),$("div",tr,[M(h).totp_uri?(k(),U("div",nr,[L(Yn,{uri:M(h).totp_uri},null,8,["uri"]),$("code",rr,I(M(h).totp_uri),1),L(en,{text:M(h).totp_uri},null,8,["text"])])):re("",!0)])])]),_:1},8,["loading","title","error","disable-save-button"]))}}),sr=F({__name:"ChangePasswordModal",emits:["relist"],setup(o,{expose:r,emit:s}){const n=s,e=Z("/frontend/account/password"),t=(w,P)=>P.new_password===w,{$gettext:i}=oe(),{form:l,resetForm:a,v$:u,ifValid:f}=le({current_password:{required:J},new_password:{required:J,validatePassword:nn},new_password2:{required:J,passwordsMatch:Lt.withMessage(i("Must match new password."),t)}},{current_password:null,new_password:null,new_password2:null}),h=W(null),g=()=>{h.value=null,a()},c=V("$modal"),y=()=>{var w;g(),(w=c.value)==null||w.show()},{axios:B}=X(),N=()=>{f(()=>{B.put(e.value,l.value).finally(()=>{var w;(w=c.value)==null||w.hide(),n("relist")})})};return r({open:y}),(w,P)=>(k(),ee(Fe,{ref_key:"$modal",ref:c,size:"md",centered:"",title:M(i)("Change Password"),"disable-save-button":M(u).$invalid,onSubmit:N,onHidden:g},{"save-button-name":D(()=>[De(I(M(i)("Change Password")),1)]),default:D(()=>[L(O,{id:"form_current_password",field:M(u).current_password,"input-type":"password",autofocus:"",label:M(i)("Current Password")},null,8,["field","label"]),L(O,{id:"form_new_password",field:M(u).new_password,"input-type":"password",label:M(i)("New Password")},null,8,["field","label"]),L(O,{id:"form_current_password",field:M(u).new_password2,"input-type":"password",label:M(i)("Confirm New Password")},null,8,["field","label"])]),_:1},8,["title","disable-save-button"]))}}),ir={class:"card-text"},ar={key:0,class:"card-text"},lr={key:1,class:"buttons"},ur={key:1},cr={class:"card-text"},dr=F({__name:"PasskeyModal",emits:["relist"],setup(o,{expose:r,emit:s}){const n=s,e=Z("/frontend/account/webauthn/register"),t=W(null),{form:i,resetForm:l,v$:a,validate:u}=le({name:{required:J},createResponse:{required:J}},{name:"",createResponse:null}),f=()=>{l(),t.value=null},h=V("$modal"),{show:g,hide:c}=qe(h),y=()=>{f(),g()},{isSupported:B,doRegister:N,cancel:w}=an(),P=()=>{f(),w(),n("relist")},{axios:_}=X(),v=async()=>{const d=await _.get(e.value).then(m=>m.data);try{i.value.createResponse=await N(d)}catch(m){throw m.name==="InvalidStateError"?t.value="Error: Authenticator was probably already registered by user":t.value=m,m}},T=async()=>{await u()&&(t.value=null,_({method:"PUT",url:e.value,data:i.value}).then(()=>{c()}).catch(m=>{m.value=m.response.data.message}))};return r({create:y}),(d,m)=>(k(),ee(Zt,{id:"api_keys_modal",ref_key:"$modal",ref:h,size:"md",centered:"",title:d.$gettext("Add New Passkey"),"no-enforce-focus":"",onHidden:P},{default:D(()=>[Yt($("div",{class:"alert alert-danger"},I(t.value),513),[[Gt,t.value!=null]]),M(B)?(k(),U("form",{key:0,class:"form vue-form",onSubmit:Qt(T,["prevent"])},[L(O,{id:"form_name",field:M(a).name,autofocus:"",class:"mb-3",label:d.$gettext("Passkey Nickname")},null,8,["field","label"]),L(sn,{id:"form_select_passkey"},{label:D(()=>[De(I(d.$gettext("Select Passkey")),1)]),default:D(()=>[$("p",ir,I(d.$gettext("Click the button below to open your browser window to select a passkey.")),1),M(i).createResponse?(k(),U("p",ar,I(d.$gettext("A passkey has been selected. Submit this form to add it to your account.")),1)):(k(),U("div",lr,[$("button",{type:"button",class:"btn btn-primary",onClick:v},I(d.$gettext("Select Passkey")),1)]))]),_:1}),L(on)],32)):(k(),U("div",ur,[$("p",cr,I(d.$gettext("Your browser does not support passkeys. Consider updating your browser to the latest version.")),1)]))]),"modal-footer":D(b=>[vt(d.$slots,"modal-footer",Jt(Ot(b)),()=>[$("button",{type:"button",class:"btn btn-secondary",onClick:m[0]||(m[0]=(...p)=>M(c)&&M(c)(...p))},I(d.$gettext("Close")),1),$("button",{type:"submit",class:jt(["btn",M(a).$invalid?"btn-danger":"btn-primary"]),onClick:T},I(d.$gettext("Add New Passkey")),3)])]),_:3},8,["title"]))}}),fr={class:"d-flex align-items-center"},hr={class:"flex-fill"},gr=["id"],mr={class:"flex-shrink-0"},pr=F({__name:"SecurityPanel",setup(o){const{axios:r}=X(),s=Z("/frontend/account/two-factor"),{state:n,isLoading:e,execute:t}=Ct(()=>r.get(s.value).then(c=>({twoFactorEnabled:c.data.two_factor_enabled})),{twoFactorEnabled:!1}),i=V("$changePasswordModal"),l=()=>{var c;(c=i.value)==null||c.open()},a=V("$twoFactorModal"),{$gettext:u}=oe();Ke(u("Disable two-factor authentication?"),()=>{t()}),Z("/frontend/account/passkeys"),u("Passkey Nickname"),u("Actions");const f=V("$dataTable"),{relist:h}=rn(f);Ke(u("Delete Passkey?"),h);const g=V("$passkeyModal");return(c,y)=>(k(),U(Ue,null,[L(Xt,{"header-id":"hdr_security"},{header:D(({id:B})=>[$("div",fr,[$("div",hr,[$("h3",{id:B,class:"card-title"},I(M(u)("Security")),9,gr)]),$("div",mr,[$("button",{type:"button",class:"btn btn-dark",onClick:l},[L(yt,{icon:M(Tt)},null,8,["icon"]),$("span",null,I(M(u)("Change Password")),1)])])])]),_:1}),L(sr,{ref_key:"$changePasswordModal",ref:i},null,512),L(or,{ref_key:"$twoFactorModal",ref:a,"two-factor-url":M(s),onRelist:M(t)},null,8,["two-factor-url","onRelist"]),L(dr,{ref_key:"$passkeyModal",ref:g,onRelist:M(h)},null,8,["onRelist"])],64))}}),wr={class:"outside-card-header mb-1"},_r=["aria-label"],yr={class:"row row-of-cards"},br={class:"col-sm-12 col-md-12"},vr=F({__name:"Account",props:{supportedLocales:{}},setup(o){const r=V("$editModal"),s=()=>{var e;(e=r.value)==null||e.open()},n=()=>{location.reload()};return(e,t)=>(k(),U(Ue,null,[$("h2",wr,I(e.$gettext("My Account")),1),$("section",{class:"card mb-4",role:"region","aria-label":e.$gettext("Account Details")},[L(An,{ref:"$userInfoPanel"},{default:D(()=>[$("button",{type:"button",class:"btn btn-dark",onClick:s},[L(yt,{icon:M($t)},null,8,["icon"]),$("span",null,I(e.$gettext("Edit Profile")),1)])]),_:1},512)],8,_r),$("div",yr,[$("div",br,[L(pr)])]),L(gn,{ref_key:"$editModal",ref:r,"supported-locales":e.supportedLocales,onReload:n},null,8,["supported-locales"])],64))}});Ut(ln(vr));
