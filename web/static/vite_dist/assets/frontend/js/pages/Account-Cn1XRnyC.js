import{_ as X,v as zt,w as xt,x as _t,k as Ot,j as Yt}from"../../../../icons-Yf7pfv1X.js";import{m as Jt}from"../../../../mergeExisting-D7dGFTzO.js";import{r as z,e as jt,m as Gt,c as Qt}from"../../../../index-CSh-MSYs.js";import{_ as Y}from"../../../../index-WveReOzm.js";import{u as se,f as bt,d as ee,i as Wt}from"../../../../usePlayerStore-CkejGpKz.js";import{_ as vt}from"../../../../FormGroupMultiCheck-BKilebZH.js";import{o as Xt}from"../../../../FormMultiCheck-C8kU6V99.js";import{u as Zt}from"../../../../useFormField-B74zyo5n.js";import{d as q,c as Ue,h as te,o as L,A as en,u as p,b as F,e as b,g as I,r as J,j as U,w as D,p as tn,t as M,f as Ct,i as ne,D as Et,n as At,k as $t,x as Pt,m as kt,v as Bt,E as Rt,F as ue,q as nn}from"../../../../vue-B-dHMJBO.js";import{_ as Ke}from"../../../../ModalForm-BQaB-ref.js";import{u as ie,a as on}from"../../../../useVuelidateOnForm-vxUTvTiB.js";import{a as Z}from"../../../../router-C-xyFC2M.js";import{u as ce,_ as Tt}from"../../../../useHasModal-BzUs2Wgc.js";import{_ as rn}from"../../../../UserInfoPanel-B-JAfgK6.js";import{_ as Mt}from"../../../../CardPage-0fdasE1K.js";import{_ as sn}from"../../../../EnabledBadge-CSbwHjhS.js";import{_ as an}from"../../../../Loading-B4WK-6A0.js";import{_ as St}from"../../../../CopyToClipboardButton-CWXBB9Ah.js";import{_ as ln}from"../../../../FormFieldset-CSY1jkmB.js";import{v as un}from"../../../../validatePassword-DEdlUHKI.js";import{u as cn}from"../../../../useRefreshableAsyncState-DhLr551J.js";import{u as qe}from"../../../../useConfirmAndDelete-6i90sp5u.js";import{_ as It}from"../../../../DataTable-cMgABYUQ.js";import{u as Nt}from"../../../../useHasDatatable-DPFcIMM0.js";import{I as Lt}from"../../../../InvisibleSubmitButton-DW6QYji6.js";import{_ as dn}from"../../../../FormMarkup-BA315dX5.js";import{u as fn}from"../../../../useWebAuthn-CjSxi_fw.js";import{u as hn}from"../../../../PanelLayout-CZiaIBtw.js";import"../../../../lodash-Bdl6ys83.js";import"../../../../lodash-BwctMegf.js";import"../../../../FormGroup-DZPf8gKm.js";import"../../../../bootstrap.esm-BZy605kZ.js";import"../../../../useSlotsExcept-ZKe4NxAj.js";import"../../../../index-Ct57DpS4.js";import"../../../../InfoCard-D6xe4CFe.js";import"../../../../zxcvbn-C681xa0x.js";import"../../../../useDialog-j5jWy_Yl.js";import"../../../../FormCheckbox-CBrIHDuX.js";import"../../../../useOptionalStorage-LDU0NgBk.js";import"../../../../_plugin-vue_export-helper-DlAUqK2U.js";import"../../../../PanelLayout-BkAYjOgn.js";const gn=q({__name:"TimeRadios",props:{modelValue:{type:[Boolean,null]},field:{},required:{type:Boolean},id:{}},emits:["update:modelValue"],setup(s,{emit:o}){const r=s,n=o,{model:e}=Zt(r,n),t=Ue({get(){const a=e.value;return a===!0?"true":a===!1?"false":""},set(a){a===!0||a==="true"?e.value=!0:a===!1||a==="false"?e.value=!1:e.value=null}}),{$gettext:i}=se(),l=Ue(()=>[{text:i("Prefer System Default"),value:""},{text:i("12 Hour"),value:"false"},{text:i("24 Hour"),value:"true"}]);return(a,u)=>(L(),te(vt,en({id:a.id},a.$attrs,{modelValue:t.value,"onUpdate:modelValue":u[0]||(u[0]=c=>t.value=c),options:l.value,stacked:"",radio:"",label:p(i)("Time Display")}),null,16,["id","modelValue","options","label"]))}}),mn={class:"row g-3"},pn={class:"col-md-6"},yn={class:"col-md-6"},wn=q({__name:"EditForm",props:{supportedLocales:{},form:{}},setup(s){const o=s,{$gettext:r}=se(),n=Ue(()=>{const e=Xt(o.supportedLocales).value;return e.unshift({text:r("Use Browser Default"),value:"default"}),e});return(e,t)=>(L(),F("div",mn,[b("div",pn,[I(Y,{id:"form_name",class:"mb-3",tabindex:"1",field:e.form.name,label:p(r)("Name")},null,8,["field","label"]),I(Y,{id:"form_email",class:"mb-3",tabindex:"2",field:e.form.email,label:p(r)("E-mail Address")},null,8,["field","label"]),I(gn,{id:"edit_form_show_24_hour_time",class:"mb-3",tabindex:"3",field:e.form.show_24_hour_time},null,8,["field"])]),b("div",yn,[I(vt,{id:"edit_form_locale",tabindex:"4",field:e.form.locale,options:n.value,stacked:"",radio:"",label:p(r)("Language")},null,8,["field","options","label"])])]))}}),_n=q({__name:"EditModal",props:{supportedLocales:{}},emits:["reload"],setup(s,{expose:o,emit:r}){const n=r,e=Z("/frontend/account/me"),t=J(!0),i=J(null),{form:l,resetForm:a,v$:u,ifValid:c}=ie({name:{},email:{required:z,email:jt},locale:{required:z},show_24_hour_time:{}},{name:"",email:"",locale:"default",show_24_hour_time:null}),g=()=>{a(),t.value=!1,i.value=null},m=U("$modal"),{show:f,hide:C}=ce(m),{notifySuccess:E}=bt(),{axios:N}=ee(),w=()=>{g(),f(),N.get(e.value).then(_=>{l.value=Jt(l.value,_.data),t.value=!1}).catch(()=>{C()})},A=()=>{c(()=>{i.value=null,N({method:"PUT",url:e.value,data:l.value}).then(()=>{E(),n("reload"),C()}).catch(_=>{_.value=_.response.data.message})})};return o({open:w}),(_,h)=>(L(),te(Ke,{ref_key:"$modal",ref:m,loading:t.value,title:_.$gettext("Edit Profile"),error:i.value,"disable-save-button":p(u).$invalid,onSubmit:A,onHidden:g},{default:D(()=>[I(wn,{form:p(u),"supported-locales":_.supportedLocales},null,8,["form","supported-locales"])]),_:1},8,["loading","title","error","disable-save-button"]))}});var W={},me,Oe;function bn(){return Oe||(Oe=1,me=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),me}var pe={},O={},Ye;function j(){if(Ye)return O;Ye=1;let s;const o=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return O.getSymbolSize=function(n){if(!n)throw new Error('"version" cannot be null or undefined');if(n<1||n>40)throw new Error('"version" should be in range from 1 to 40');return n*4+17},O.getSymbolTotalCodewords=function(n){return o[n]},O.getBCHDigit=function(r){let n=0;for(;r!==0;)n++,r>>>=1;return n},O.setToSJISFunction=function(n){if(typeof n!="function")throw new Error('"toSJISFunc" is not a valid function.');s=n},O.isKanjiModeEnabled=function(){return typeof s<"u"},O.toSJIS=function(n){return s(n)},O}var ye={},Je;function Ve(){return Je||(Je=1,function(s){s.L={bit:1},s.M={bit:0},s.Q={bit:3},s.H={bit:2};function o(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return s.L;case"m":case"medium":return s.M;case"q":case"quartile":return s.Q;case"h":case"high":return s.H;default:throw new Error("Unknown EC Level: "+r)}}s.isValid=function(n){return n&&typeof n.bit<"u"&&n.bit>=0&&n.bit<4},s.from=function(n,e){if(s.isValid(n))return n;try{return o(n)}catch{return e}}}(ye)),ye}var we,je;function vn(){if(je)return we;je=1;function s(){this.buffer=[],this.length=0}return s.prototype={get:function(o){const r=Math.floor(o/8);return(this.buffer[r]>>>7-o%8&1)===1},put:function(o,r){for(let n=0;n<r;n++)this.putBit((o>>>r-n-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(o){const r=Math.floor(this.length/8);this.buffer.length<=r&&this.buffer.push(0),o&&(this.buffer[r]|=128>>>this.length%8),this.length++}},we=s,we}var _e,Ge;function Cn(){if(Ge)return _e;Ge=1;function s(o){if(!o||o<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=o,this.data=new Uint8Array(o*o),this.reservedBit=new Uint8Array(o*o)}return s.prototype.set=function(o,r,n,e){const t=o*this.size+r;this.data[t]=n,e&&(this.reservedBit[t]=!0)},s.prototype.get=function(o,r){return this.data[o*this.size+r]},s.prototype.xor=function(o,r,n){this.data[o*this.size+r]^=n},s.prototype.isReserved=function(o,r){return this.reservedBit[o*this.size+r]},_e=s,_e}var be={},Qe;function En(){return Qe||(Qe=1,function(s){const o=j().getSymbolSize;s.getRowColCoords=function(n){if(n===1)return[];const e=Math.floor(n/7)+2,t=o(n),i=t===145?26:Math.ceil((t-13)/(2*e-2))*2,l=[t-7];for(let a=1;a<e-1;a++)l[a]=l[a-1]-i;return l.push(6),l.reverse()},s.getPositions=function(n){const e=[],t=s.getRowColCoords(n),i=t.length;for(let l=0;l<i;l++)for(let a=0;a<i;a++)l===0&&a===0||l===0&&a===i-1||l===i-1&&a===0||e.push([t[l],t[a]]);return e}}(be)),be}var ve={},We;function An(){if(We)return ve;We=1;const s=j().getSymbolSize,o=7;return ve.getPositions=function(n){const e=s(n);return[[0,0],[e-o,0],[0,e-o]]},ve}var Ce={},Xe;function $n(){return Xe||(Xe=1,function(s){s.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const o={N1:3,N2:3,N3:40,N4:10};s.isValid=function(e){return e!=null&&e!==""&&!isNaN(e)&&e>=0&&e<=7},s.from=function(e){return s.isValid(e)?parseInt(e,10):void 0},s.getPenaltyN1=function(e){const t=e.size;let i=0,l=0,a=0,u=null,c=null;for(let g=0;g<t;g++){l=a=0,u=c=null;for(let m=0;m<t;m++){let f=e.get(g,m);f===u?l++:(l>=5&&(i+=o.N1+(l-5)),u=f,l=1),f=e.get(m,g),f===c?a++:(a>=5&&(i+=o.N1+(a-5)),c=f,a=1)}l>=5&&(i+=o.N1+(l-5)),a>=5&&(i+=o.N1+(a-5))}return i},s.getPenaltyN2=function(e){const t=e.size;let i=0;for(let l=0;l<t-1;l++)for(let a=0;a<t-1;a++){const u=e.get(l,a)+e.get(l,a+1)+e.get(l+1,a)+e.get(l+1,a+1);(u===4||u===0)&&i++}return i*o.N2},s.getPenaltyN3=function(e){const t=e.size;let i=0,l=0,a=0;for(let u=0;u<t;u++){l=a=0;for(let c=0;c<t;c++)l=l<<1&2047|e.get(u,c),c>=10&&(l===1488||l===93)&&i++,a=a<<1&2047|e.get(c,u),c>=10&&(a===1488||a===93)&&i++}return i*o.N3},s.getPenaltyN4=function(e){let t=0;const i=e.data.length;for(let a=0;a<i;a++)t+=e.data[a];return Math.abs(Math.ceil(t*100/i/5)-10)*o.N4};function r(n,e,t){switch(n){case s.Patterns.PATTERN000:return(e+t)%2===0;case s.Patterns.PATTERN001:return e%2===0;case s.Patterns.PATTERN010:return t%3===0;case s.Patterns.PATTERN011:return(e+t)%3===0;case s.Patterns.PATTERN100:return(Math.floor(e/2)+Math.floor(t/3))%2===0;case s.Patterns.PATTERN101:return e*t%2+e*t%3===0;case s.Patterns.PATTERN110:return(e*t%2+e*t%3)%2===0;case s.Patterns.PATTERN111:return(e*t%3+(e+t)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}s.applyMask=function(e,t){const i=t.size;for(let l=0;l<i;l++)for(let a=0;a<i;a++)t.isReserved(a,l)||t.xor(a,l,r(e,a,l))},s.getBestMask=function(e,t){const i=Object.keys(s.Patterns).length;let l=0,a=1/0;for(let u=0;u<i;u++){t(u),s.applyMask(u,e);const c=s.getPenaltyN1(e)+s.getPenaltyN2(e)+s.getPenaltyN3(e)+s.getPenaltyN4(e);s.applyMask(u,e),c<a&&(a=c,l=u)}return l}}(Ce)),Ce}var le={},Ze;function Dt(){if(Ze)return le;Ze=1;const s=Ve(),o=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],r=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return le.getBlocksCount=function(e,t){switch(t){case s.L:return o[(e-1)*4+0];case s.M:return o[(e-1)*4+1];case s.Q:return o[(e-1)*4+2];case s.H:return o[(e-1)*4+3];default:return}},le.getTotalCodewordsCount=function(e,t){switch(t){case s.L:return r[(e-1)*4+0];case s.M:return r[(e-1)*4+1];case s.Q:return r[(e-1)*4+2];case s.H:return r[(e-1)*4+3];default:return}},le}var Ee={},re={},et;function Pn(){if(et)return re;et=1;const s=new Uint8Array(512),o=new Uint8Array(256);return function(){let n=1;for(let e=0;e<255;e++)s[e]=n,o[n]=e,n<<=1,n&256&&(n^=285);for(let e=255;e<512;e++)s[e]=s[e-255]}(),re.log=function(n){if(n<1)throw new Error("log("+n+")");return o[n]},re.exp=function(n){return s[n]},re.mul=function(n,e){return n===0||e===0?0:s[o[n]+o[e]]},re}var tt;function kn(){return tt||(tt=1,function(s){const o=Pn();s.mul=function(n,e){const t=new Uint8Array(n.length+e.length-1);for(let i=0;i<n.length;i++)for(let l=0;l<e.length;l++)t[i+l]^=o.mul(n[i],e[l]);return t},s.mod=function(n,e){let t=new Uint8Array(n);for(;t.length-e.length>=0;){const i=t[0];for(let a=0;a<e.length;a++)t[a]^=o.mul(e[a],i);let l=0;for(;l<t.length&&t[l]===0;)l++;t=t.slice(l)}return t},s.generateECPolynomial=function(n){let e=new Uint8Array([1]);for(let t=0;t<n;t++)e=s.mul(e,new Uint8Array([1,o.exp(t)]));return e}}(Ee)),Ee}var Ae,nt;function Bn(){if(nt)return Ae;nt=1;const s=kn();function o(r){this.genPoly=void 0,this.degree=r,this.degree&&this.initialize(this.degree)}return o.prototype.initialize=function(n){this.degree=n,this.genPoly=s.generateECPolynomial(this.degree)},o.prototype.encode=function(n){if(!this.genPoly)throw new Error("Encoder not initialized");const e=new Uint8Array(n.length+this.degree);e.set(n);const t=s.mod(e,this.genPoly),i=this.degree-t.length;if(i>0){const l=new Uint8Array(this.degree);return l.set(t,i),l}return t},Ae=o,Ae}var $e={},Pe={},ke={},ot;function Ft(){return ot||(ot=1,ke.isValid=function(o){return!isNaN(o)&&o>=1&&o<=40}),ke}var K={},rt;function Ut(){if(rt)return K;rt=1;const s="[0-9]+",o="[A-Z $%*+\\-./:]+";let r="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";r=r.replace(/u/g,"\\u");const n="(?:(?![A-Z0-9 $%*+\\-./:]|"+r+`)(?:.|[\r
]))+`;K.KANJI=new RegExp(r,"g"),K.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),K.BYTE=new RegExp(n,"g"),K.NUMERIC=new RegExp(s,"g"),K.ALPHANUMERIC=new RegExp(o,"g");const e=new RegExp("^"+r+"$"),t=new RegExp("^"+s+"$"),i=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return K.testKanji=function(a){return e.test(a)},K.testNumeric=function(a){return t.test(a)},K.testAlphanumeric=function(a){return i.test(a)},K}var st;function G(){return st||(st=1,function(s){const o=Ft(),r=Ut();s.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},s.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},s.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},s.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},s.MIXED={bit:-1},s.getCharCountIndicator=function(t,i){if(!t.ccBits)throw new Error("Invalid mode: "+t);if(!o.isValid(i))throw new Error("Invalid version: "+i);return i>=1&&i<10?t.ccBits[0]:i<27?t.ccBits[1]:t.ccBits[2]},s.getBestModeForData=function(t){return r.testNumeric(t)?s.NUMERIC:r.testAlphanumeric(t)?s.ALPHANUMERIC:r.testKanji(t)?s.KANJI:s.BYTE},s.toString=function(t){if(t&&t.id)return t.id;throw new Error("Invalid mode")},s.isValid=function(t){return t&&t.bit&&t.ccBits};function n(e){if(typeof e!="string")throw new Error("Param is not a string");switch(e.toLowerCase()){case"numeric":return s.NUMERIC;case"alphanumeric":return s.ALPHANUMERIC;case"kanji":return s.KANJI;case"byte":return s.BYTE;default:throw new Error("Unknown mode: "+e)}}s.from=function(t,i){if(s.isValid(t))return t;try{return n(t)}catch{return i}}}(Pe)),Pe}var it;function Rn(){return it||(it=1,function(s){const o=j(),r=Dt(),n=Ve(),e=G(),t=Ft(),i=7973,l=o.getBCHDigit(i);function a(m,f,C){for(let E=1;E<=40;E++)if(f<=s.getCapacity(E,C,m))return E}function u(m,f){return e.getCharCountIndicator(m,f)+4}function c(m,f){let C=0;return m.forEach(function(E){const N=u(E.mode,f);C+=N+E.getBitsLength()}),C}function g(m,f){for(let C=1;C<=40;C++)if(c(m,C)<=s.getCapacity(C,f,e.MIXED))return C}s.from=function(f,C){return t.isValid(f)?parseInt(f,10):C},s.getCapacity=function(f,C,E){if(!t.isValid(f))throw new Error("Invalid QR Code version");typeof E>"u"&&(E=e.BYTE);const N=o.getSymbolTotalCodewords(f),w=r.getTotalCodewordsCount(f,C),A=(N-w)*8;if(E===e.MIXED)return A;const _=A-u(E,f);switch(E){case e.NUMERIC:return Math.floor(_/10*3);case e.ALPHANUMERIC:return Math.floor(_/11*2);case e.KANJI:return Math.floor(_/13);case e.BYTE:default:return Math.floor(_/8)}},s.getBestVersionForData=function(f,C){let E;const N=n.from(C,n.M);if(Array.isArray(f)){if(f.length>1)return g(f,N);if(f.length===0)return 1;E=f[0]}else E=f;return a(E.mode,E.getLength(),N)},s.getEncodedBits=function(f){if(!t.isValid(f)||f<7)throw new Error("Invalid QR Code version");let C=f<<12;for(;o.getBCHDigit(C)-l>=0;)C^=i<<o.getBCHDigit(C)-l;return f<<12|C}}($e)),$e}var Be={},at;function Tn(){if(at)return Be;at=1;const s=j(),o=1335,r=21522,n=s.getBCHDigit(o);return Be.getEncodedBits=function(t,i){const l=t.bit<<3|i;let a=l<<10;for(;s.getBCHDigit(a)-n>=0;)a^=o<<s.getBCHDigit(a)-n;return(l<<10|a)^r},Be}var Re={},Te,lt;function Mn(){if(lt)return Te;lt=1;const s=G();function o(r){this.mode=s.NUMERIC,this.data=r.toString()}return o.getBitsLength=function(n){return 10*Math.floor(n/3)+(n%3?n%3*3+1:0)},o.prototype.getLength=function(){return this.data.length},o.prototype.getBitsLength=function(){return o.getBitsLength(this.data.length)},o.prototype.write=function(n){let e,t,i;for(e=0;e+3<=this.data.length;e+=3)t=this.data.substr(e,3),i=parseInt(t,10),n.put(i,10);const l=this.data.length-e;l>0&&(t=this.data.substr(e),i=parseInt(t,10),n.put(i,l*3+1))},Te=o,Te}var Me,ut;function Sn(){if(ut)return Me;ut=1;const s=G(),o=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function r(n){this.mode=s.ALPHANUMERIC,this.data=n}return r.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)},r.prototype.getLength=function(){return this.data.length},r.prototype.getBitsLength=function(){return r.getBitsLength(this.data.length)},r.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let i=o.indexOf(this.data[t])*45;i+=o.indexOf(this.data[t+1]),e.put(i,11)}this.data.length%2&&e.put(o.indexOf(this.data[t]),6)},Me=r,Me}var Se,ct;function In(){if(ct)return Se;ct=1;const s=G();function o(r){this.mode=s.BYTE,typeof r=="string"?this.data=new TextEncoder().encode(r):this.data=new Uint8Array(r)}return o.getBitsLength=function(n){return n*8},o.prototype.getLength=function(){return this.data.length},o.prototype.getBitsLength=function(){return o.getBitsLength(this.data.length)},o.prototype.write=function(r){for(let n=0,e=this.data.length;n<e;n++)r.put(this.data[n],8)},Se=o,Se}var Ie,dt;function Nn(){if(dt)return Ie;dt=1;const s=G(),o=j();function r(n){this.mode=s.KANJI,this.data=n}return r.getBitsLength=function(e){return e*13},r.prototype.getLength=function(){return this.data.length},r.prototype.getBitsLength=function(){return r.getBitsLength(this.data.length)},r.prototype.write=function(n){let e;for(e=0;e<this.data.length;e++){let t=o.toSJIS(this.data[e]);if(t>=33088&&t<=40956)t-=33088;else if(t>=57408&&t<=60351)t-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);t=(t>>>8&255)*192+(t&255),n.put(t,13)}},Ie=r,Ie}var Ne={exports:{}},ft;function Ln(){return ft||(ft=1,function(s){var o={single_source_shortest_paths:function(r,n,e){var t={},i={};i[n]=0;var l=o.PriorityQueue.make();l.push(n,0);for(var a,u,c,g,m,f,C,E,N;!l.empty();){a=l.pop(),u=a.value,g=a.cost,m=r[u]||{};for(c in m)m.hasOwnProperty(c)&&(f=m[c],C=g+f,E=i[c],N=typeof i[c]>"u",(N||E>C)&&(i[c]=C,l.push(c,C),t[c]=u))}if(typeof e<"u"&&typeof i[e]>"u"){var w=["Could not find a path from ",n," to ",e,"."].join("");throw new Error(w)}return t},extract_shortest_path_from_predecessor_list:function(r,n){for(var e=[],t=n;t;)e.push(t),r[t],t=r[t];return e.reverse(),e},find_path:function(r,n,e){var t=o.single_source_shortest_paths(r,n,e);return o.extract_shortest_path_from_predecessor_list(t,e)},PriorityQueue:{make:function(r){var n=o.PriorityQueue,e={},t;r=r||{};for(t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.queue=[],e.sorter=r.sorter||n.default_sorter,e},default_sorter:function(r,n){return r.cost-n.cost},push:function(r,n){var e={value:r,cost:n};this.queue.push(e),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};s.exports=o}(Ne)),Ne.exports}var ht;function Dn(){return ht||(ht=1,function(s){const o=G(),r=Mn(),n=Sn(),e=In(),t=Nn(),i=Ut(),l=j(),a=Ln();function u(w){return unescape(encodeURIComponent(w)).length}function c(w,A,_){const h=[];let R;for(;(R=w.exec(_))!==null;)h.push({data:R[0],index:R.index,mode:A,length:R[0].length});return h}function g(w){const A=c(i.NUMERIC,o.NUMERIC,w),_=c(i.ALPHANUMERIC,o.ALPHANUMERIC,w);let h,R;return l.isKanjiModeEnabled()?(h=c(i.BYTE,o.BYTE,w),R=c(i.KANJI,o.KANJI,w)):(h=c(i.BYTE_KANJI,o.BYTE,w),R=[]),A.concat(_,h,R).sort(function(y,$){return y.index-$.index}).map(function(y){return{data:y.data,mode:y.mode,length:y.length}})}function m(w,A){switch(A){case o.NUMERIC:return r.getBitsLength(w);case o.ALPHANUMERIC:return n.getBitsLength(w);case o.KANJI:return t.getBitsLength(w);case o.BYTE:return e.getBitsLength(w)}}function f(w){return w.reduce(function(A,_){const h=A.length-1>=0?A[A.length-1]:null;return h&&h.mode===_.mode?(A[A.length-1].data+=_.data,A):(A.push(_),A)},[])}function C(w){const A=[];for(let _=0;_<w.length;_++){const h=w[_];switch(h.mode){case o.NUMERIC:A.push([h,{data:h.data,mode:o.ALPHANUMERIC,length:h.length},{data:h.data,mode:o.BYTE,length:h.length}]);break;case o.ALPHANUMERIC:A.push([h,{data:h.data,mode:o.BYTE,length:h.length}]);break;case o.KANJI:A.push([h,{data:h.data,mode:o.BYTE,length:u(h.data)}]);break;case o.BYTE:A.push([{data:h.data,mode:o.BYTE,length:u(h.data)}])}}return A}function E(w,A){const _={},h={start:{}};let R=["start"];for(let d=0;d<w.length;d++){const y=w[d],$=[];for(let v=0;v<y.length;v++){const T=y[v],P=""+d+v;$.push(P),_[P]={node:T,lastCount:0},h[P]={};for(let B=0;B<R.length;B++){const k=R[B];_[k]&&_[k].node.mode===T.mode?(h[k][P]=m(_[k].lastCount+T.length,T.mode)-m(_[k].lastCount,T.mode),_[k].lastCount+=T.length):(_[k]&&(_[k].lastCount=T.length),h[k][P]=m(T.length,T.mode)+4+o.getCharCountIndicator(T.mode,A))}}R=$}for(let d=0;d<R.length;d++)h[R[d]].end=0;return{map:h,table:_}}function N(w,A){let _;const h=o.getBestModeForData(w);if(_=o.from(A,h),_!==o.BYTE&&_.bit<h.bit)throw new Error('"'+w+'" cannot be encoded with mode '+o.toString(_)+`.
 Suggested mode is: `+o.toString(h));switch(_===o.KANJI&&!l.isKanjiModeEnabled()&&(_=o.BYTE),_){case o.NUMERIC:return new r(w);case o.ALPHANUMERIC:return new n(w);case o.KANJI:return new t(w);case o.BYTE:return new e(w)}}s.fromArray=function(A){return A.reduce(function(_,h){return typeof h=="string"?_.push(N(h,null)):h.data&&_.push(N(h.data,h.mode)),_},[])},s.fromString=function(A,_){const h=g(A,l.isKanjiModeEnabled()),R=C(h),d=E(R,_),y=a.find_path(d.map,"start","end"),$=[];for(let v=1;v<y.length-1;v++)$.push(d.table[y[v]].node);return s.fromArray(f($))},s.rawSplit=function(A){return s.fromArray(g(A,l.isKanjiModeEnabled()))}}(Re)),Re}var gt;function Fn(){if(gt)return pe;gt=1;const s=j(),o=Ve(),r=vn(),n=Cn(),e=En(),t=An(),i=$n(),l=Dt(),a=Bn(),u=Rn(),c=Tn(),g=G(),m=Dn();function f(d,y){const $=d.size,v=t.getPositions(y);for(let T=0;T<v.length;T++){const P=v[T][0],B=v[T][1];for(let k=-1;k<=7;k++)if(!(P+k<=-1||$<=P+k))for(let S=-1;S<=7;S++)B+S<=-1||$<=B+S||(k>=0&&k<=6&&(S===0||S===6)||S>=0&&S<=6&&(k===0||k===6)||k>=2&&k<=4&&S>=2&&S<=4?d.set(P+k,B+S,!0,!0):d.set(P+k,B+S,!1,!0))}}function C(d){const y=d.size;for(let $=8;$<y-8;$++){const v=$%2===0;d.set($,6,v,!0),d.set(6,$,v,!0)}}function E(d,y){const $=e.getPositions(y);for(let v=0;v<$.length;v++){const T=$[v][0],P=$[v][1];for(let B=-2;B<=2;B++)for(let k=-2;k<=2;k++)B===-2||B===2||k===-2||k===2||B===0&&k===0?d.set(T+B,P+k,!0,!0):d.set(T+B,P+k,!1,!0)}}function N(d,y){const $=d.size,v=u.getEncodedBits(y);let T,P,B;for(let k=0;k<18;k++)T=Math.floor(k/3),P=k%3+$-8-3,B=(v>>k&1)===1,d.set(T,P,B,!0),d.set(P,T,B,!0)}function w(d,y,$){const v=d.size,T=c.getEncodedBits(y,$);let P,B;for(P=0;P<15;P++)B=(T>>P&1)===1,P<6?d.set(P,8,B,!0):P<8?d.set(P+1,8,B,!0):d.set(v-15+P,8,B,!0),P<8?d.set(8,v-P-1,B,!0):P<9?d.set(8,15-P-1+1,B,!0):d.set(8,15-P-1,B,!0);d.set(v-8,8,1,!0)}function A(d,y){const $=d.size;let v=-1,T=$-1,P=7,B=0;for(let k=$-1;k>0;k-=2)for(k===6&&k--;;){for(let S=0;S<2;S++)if(!d.isReserved(T,k-S)){let x=!1;B<y.length&&(x=(y[B]>>>P&1)===1),d.set(T,k-S,x),P--,P===-1&&(B++,P=7)}if(T+=v,T<0||$<=T){T-=v,v=-v;break}}}function _(d,y,$){const v=new r;$.forEach(function(S){v.put(S.mode.bit,4),v.put(S.getLength(),g.getCharCountIndicator(S.mode,d)),S.write(v)});const T=s.getSymbolTotalCodewords(d),P=l.getTotalCodewordsCount(d,y),B=(T-P)*8;for(v.getLengthInBits()+4<=B&&v.put(0,4);v.getLengthInBits()%8!==0;)v.putBit(0);const k=(B-v.getLengthInBits())/8;for(let S=0;S<k;S++)v.put(S%2?17:236,8);return h(v,d,y)}function h(d,y,$){const v=s.getSymbolTotalCodewords(y),T=l.getTotalCodewordsCount(y,$),P=v-T,B=l.getBlocksCount(y,$),k=v%B,S=B-k,x=Math.floor(v/B),oe=Math.floor(P/B),Kt=oe+1,He=x-oe,Vt=new a(He);let de=0;const ae=new Array(B),ze=new Array(B);let fe=0;const Ht=new Uint8Array(d.buffer);for(let Q=0;Q<B;Q++){const ge=Q<S?oe:Kt;ae[Q]=Ht.slice(de,de+ge),ze[Q]=Vt.encode(ae[Q]),de+=ge,fe=Math.max(fe,ge)}const he=new Uint8Array(v);let xe=0,V,H;for(V=0;V<fe;V++)for(H=0;H<B;H++)V<ae[H].length&&(he[xe++]=ae[H][V]);for(V=0;V<He;V++)for(H=0;H<B;H++)he[xe++]=ze[H][V];return he}function R(d,y,$,v){let T;if(Array.isArray(d))T=m.fromArray(d);else if(typeof d=="string"){let x=y;if(!x){const oe=m.rawSplit(d);x=u.getBestVersionForData(oe,$)}T=m.fromString(d,x||40)}else throw new Error("Invalid data");const P=u.getBestVersionForData(T,$);if(!P)throw new Error("The amount of data is too big to be stored in a QR Code");if(!y)y=P;else if(y<P)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+P+`.
`);const B=_(y,$,T),k=s.getSymbolSize(y),S=new n(k);return f(S,y),C(S),E(S,y),w(S,$,0),y>=7&&N(S,y),A(S,B),isNaN(v)&&(v=i.getBestMask(S,w.bind(null,S,$))),i.applyMask(v,S),w(S,$,v),{modules:S,version:y,errorCorrectionLevel:$,maskPattern:v,segments:T}}return pe.create=function(y,$){if(typeof y>"u"||y==="")throw new Error("No input text");let v=o.M,T,P;return typeof $<"u"&&(v=o.from($.errorCorrectionLevel,o.M),T=u.from($.version),P=i.from($.maskPattern),$.toSJISFunc&&s.setToSJISFunction($.toSJISFunc)),R(y,T,v,P)},pe}var Le={},De={},mt;function qt(){return mt||(mt=1,function(s){function o(r){if(typeof r=="number"&&(r=r.toString()),typeof r!="string")throw new Error("Color should be defined as hex string");let n=r.slice().replace("#","").split("");if(n.length<3||n.length===5||n.length>8)throw new Error("Invalid hex color: "+r);(n.length===3||n.length===4)&&(n=Array.prototype.concat.apply([],n.map(function(t){return[t,t]}))),n.length===6&&n.push("F","F");const e=parseInt(n.join(""),16);return{r:e>>24&255,g:e>>16&255,b:e>>8&255,a:e&255,hex:"#"+n.slice(0,6).join("")}}s.getOptions=function(n){n||(n={}),n.color||(n.color={});const e=typeof n.margin>"u"||n.margin===null||n.margin<0?4:n.margin,t=n.width&&n.width>=21?n.width:void 0,i=n.scale||4;return{width:t,scale:t?4:i,margin:e,color:{dark:o(n.color.dark||"#000000ff"),light:o(n.color.light||"#ffffffff")},type:n.type,rendererOpts:n.rendererOpts||{}}},s.getScale=function(n,e){return e.width&&e.width>=n+e.margin*2?e.width/(n+e.margin*2):e.scale},s.getImageWidth=function(n,e){const t=s.getScale(n,e);return Math.floor((n+e.margin*2)*t)},s.qrToImageData=function(n,e,t){const i=e.modules.size,l=e.modules.data,a=s.getScale(i,t),u=Math.floor((i+t.margin*2)*a),c=t.margin*a,g=[t.color.light,t.color.dark];for(let m=0;m<u;m++)for(let f=0;f<u;f++){let C=(m*u+f)*4,E=t.color.light;if(m>=c&&f>=c&&m<u-c&&f<u-c){const N=Math.floor((m-c)/a),w=Math.floor((f-c)/a);E=g[l[N*i+w]?1:0]}n[C++]=E.r,n[C++]=E.g,n[C++]=E.b,n[C]=E.a}}}(De)),De}var pt;function Un(){return pt||(pt=1,function(s){const o=qt();function r(e,t,i){e.clearRect(0,0,t.width,t.height),t.style||(t.style={}),t.height=i,t.width=i,t.style.height=i+"px",t.style.width=i+"px"}function n(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}s.render=function(t,i,l){let a=l,u=i;typeof a>"u"&&(!i||!i.getContext)&&(a=i,i=void 0),i||(u=n()),a=o.getOptions(a);const c=o.getImageWidth(t.modules.size,a),g=u.getContext("2d"),m=g.createImageData(c,c);return o.qrToImageData(m.data,t,a),r(g,u,c),g.putImageData(m,0,0),u},s.renderToDataURL=function(t,i,l){let a=l;typeof a>"u"&&(!i||!i.getContext)&&(a=i,i=void 0),a||(a={});const u=s.render(t,i,a),c=a.type||"image/png",g=a.rendererOpts||{};return u.toDataURL(c,g.quality)}}(Le)),Le}var Fe={},yt;function qn(){if(yt)return Fe;yt=1;const s=qt();function o(e,t){const i=e.a/255,l=t+'="'+e.hex+'"';return i<1?l+" "+t+'-opacity="'+i.toFixed(2).slice(1)+'"':l}function r(e,t,i){let l=e+t;return typeof i<"u"&&(l+=" "+i),l}function n(e,t,i){let l="",a=0,u=!1,c=0;for(let g=0;g<e.length;g++){const m=Math.floor(g%t),f=Math.floor(g/t);!m&&!u&&(u=!0),e[g]?(c++,g>0&&m>0&&e[g-1]||(l+=u?r("M",m+i,.5+f+i):r("m",a,0),a=0,u=!1),m+1<t&&e[g+1]||(l+=r("h",c),c=0)):a++}return l}return Fe.render=function(t,i,l){const a=s.getOptions(i),u=t.modules.size,c=t.modules.data,g=u+a.margin*2,m=a.color.light.a?"<path "+o(a.color.light,"fill")+' d="M0 0h'+g+"v"+g+'H0z"/>':"",f="<path "+o(a.color.dark,"stroke")+' d="'+n(c,u,a.margin)+'"/>',C='viewBox="0 0 '+g+" "+g+'"',N='<svg xmlns="http://www.w3.org/2000/svg" '+(a.width?'width="'+a.width+'" height="'+a.width+'" ':"")+C+' shape-rendering="crispEdges">'+m+f+`</svg>
`;return typeof l=="function"&&l(null,N),N},Fe}var wt;function Kn(){if(wt)return W;wt=1;const s=bn(),o=Fn(),r=Un(),n=qn();function e(t,i,l,a,u){const c=[].slice.call(arguments,1),g=c.length,m=typeof c[g-1]=="function";if(!m&&!s())throw new Error("Callback required as last argument");if(m){if(g<2)throw new Error("Too few arguments provided");g===2?(u=l,l=i,i=a=void 0):g===3&&(i.getContext&&typeof u>"u"?(u=a,a=void 0):(u=a,a=l,l=i,i=void 0))}else{if(g<1)throw new Error("Too few arguments provided");return g===1?(l=i,i=a=void 0):g===2&&!i.getContext&&(a=l,l=i,i=void 0),new Promise(function(f,C){try{const E=o.create(l,a);f(t(E,i,a))}catch(E){C(E)}})}try{const f=o.create(l,a);u(null,t(f,i,a))}catch(f){u(f)}}return W.create=o.create,W.toCanvas=e.bind(null,r.render),W.toDataURL=e.bind(null,r.renderToDataURL),W.toString=e.bind(null,function(t,i,l){return n.render(t,l)}),W}var Vn=Kn();const Hn=q({__name:"QrCode",props:{uri:{}},setup(s){const o=s,r=U("$canvas");return tn(()=>{Vn.toCanvas(r.value,o.uri,n=>{n&&console.error(n)})}),(n,e)=>(L(),F("canvas",{ref_key:"$canvas",ref:r},null,512))}}),zn={class:"row"},xn={class:"col-md-7"},On={class:"mt-2"},Yn={class:"card-text"},Jn={class:"mt-0"},jn={class:"card-text"},Gn={class:"col-md-5"},Qn={key:0},Wn={id:"totp_uri",class:"d-inline-block text-truncate mt-2",style:{width:"100%"}},Xn=q({__name:"TwoFactorModal",props:{twoFactorUrl:{}},emits:["relist"],setup(s,{expose:o,emit:r}){const n=s,e=r,t=J(!0),i=J(null),{form:l,resetForm:a,v$:u,ifValid:c}=ie({otp:{required:z,minLength:Gt(6)}},{otp:""}),{record:g,reset:m}=on({secret:null,totp_uri:null,qr_code:null}),f=()=>{a(),m(),t.value=!1,i.value=null},C=U("$modal"),{hide:E,show:N}=ce(C),{notifySuccess:w}=bt(),{axios:A}=ee(),_=()=>{f(),t.value=!0,N(),A.put(n.twoFactorUrl).then(R=>{g.value=R.data,t.value=!1}).catch(()=>{E()})},h=()=>{c(()=>{i.value=null,A({method:"PUT",url:n.twoFactorUrl,data:{secret:g.value.secret,otp:l.value.otp}}).then(()=>{w(),e("relist"),E()}).catch(R=>{R.value=R.response.data.message})})};return o({open:_}),(R,d)=>(L(),te(Ke,{ref_key:"$modal",ref:C,loading:t.value,title:R.$gettext("Enable Two-Factor Authentication"),error:i.value,"disable-save-button":p(u).$invalid,"no-enforce-focus":"",onSubmit:h,onHidden:f},{"save-button-name":D(()=>[ne(M(R.$gettext("Submit Code")),1)]),default:D(()=>[b("div",zn,[b("div",xn,[b("h5",On,M(R.$gettext("Step 1: Scan QR Code")),1),b("p",Yn,M(R.$gettext("From your smartphone, scan the code to the right using an authentication app of your choice (FreeOTP, Authy, etc).")),1),b("h5",Jn,M(R.$gettext("Step 2: Verify Generated Code")),1),b("p",jn,M(R.$gettext("To verify that the code was set up correctly, enter the 6-digit code the app shows you.")),1),I(ln,null,{default:D(()=>[I(Y,{id:"form_otp",field:p(u).otp,autofocus:"",label:R.$gettext("Code from Authenticator App"),description:R.$gettext("Enter the current code provided by your authenticator app to verify that it's working correctly.")},null,8,["field","label","description"])]),_:1})]),b("div",Gn,[p(g).totp_uri?(L(),F("div",Qn,[I(Hn,{uri:p(g).totp_uri},null,8,["uri"]),b("code",Wn,M(p(g).totp_uri),1),I(St,{text:p(g).totp_uri},null,8,["text"])])):Ct("",!0)])])]),_:1},8,["loading","title","error","disable-save-button"]))}}),Zn=q({__name:"ChangePasswordModal",emits:["relist"],setup(s,{expose:o,emit:r}){const n=r,e=Z("/frontend/account/password"),t=(w,A)=>A.new_password===w,{$gettext:i}=se(),{form:l,resetForm:a,v$:u,ifValid:c}=ie({current_password:{required:z},new_password:{required:z,validatePassword:un},new_password2:{required:z,passwordsMatch:Qt.withMessage(i("Must match new password."),t)}},{current_password:null,new_password:null,new_password2:null}),g=J(null),m=()=>{g.value=null,a()},f=U("$modal"),C=()=>{var w;m(),(w=f.value)==null||w.show()},{axios:E}=ee(),N=()=>{c(()=>{E.put(e.value,l.value).finally(()=>{var w;(w=f.value)==null||w.hide(),n("relist")})})};return o({open:C}),(w,A)=>(L(),te(Ke,{ref_key:"$modal",ref:f,size:"md",centered:"",title:p(i)("Change Password"),"disable-save-button":p(u).$invalid,onSubmit:N,onHidden:m},{"save-button-name":D(()=>[ne(M(p(i)("Change Password")),1)]),default:D(()=>[I(Y,{id:"form_current_password",field:p(u).current_password,"input-type":"password",autofocus:"",label:p(i)("Current Password")},null,8,["field","label"]),I(Y,{id:"form_new_password",field:p(u).new_password,"input-type":"password",label:p(i)("New Password")},null,8,["field","label"]),I(Y,{id:"form_current_password",field:p(u).new_password2,"input-type":"password",label:p(i)("Confirm New Password")},null,8,["field","label"])]),_:1},8,["title","disable-save-button"]))}}),eo={class:"card-text"},to={key:0,class:"card-text"},no={key:1,class:"buttons"},oo={key:1},ro={class:"card-text"},so=q({__name:"PasskeyModal",emits:["relist"],setup(s,{expose:o,emit:r}){const n=r,e=Z("/frontend/account/webauthn/register"),t=J(null),{form:i,resetForm:l,v$:a,validate:u}=ie({name:{required:z},createResponse:{required:z}},{name:"",createResponse:null}),c=()=>{l(),t.value=null},g=U("$modal"),{show:m,hide:f}=ce(g),C=()=>{c(),m()},{isSupported:E,doRegister:N,cancel:w}=fn(),A=()=>{c(),w(),n("relist")},{axios:_}=ee(),h=async()=>{const d=await _.get(e.value).then(y=>y.data);try{i.value.createResponse=await N(d)}catch(y){throw y.name==="InvalidStateError"?t.value="Error: Authenticator was probably already registered by user":t.value=y,y}},R=async()=>{await u()&&(t.value=null,_({method:"PUT",url:e.value,data:i.value}).then(()=>{f()}).catch(y=>{y.value=y.response.data.message}))};return o({create:C}),(d,y)=>(L(),te(Tt,{id:"api_keys_modal",ref_key:"$modal",ref:g,size:"md",centered:"",title:d.$gettext("Add New Passkey"),"no-enforce-focus":"",onHidden:A},{default:D(()=>[kt(b("div",{class:"alert alert-danger"},M(t.value),513),[[Bt,t.value!=null]]),p(E)?(L(),F("form",{key:0,class:"form vue-form",onSubmit:Rt(R,["prevent"])},[I(Y,{id:"form_name",field:p(a).name,autofocus:"",class:"mb-3",label:d.$gettext("Passkey Nickname")},null,8,["field","label"]),I(dn,{id:"form_select_passkey"},{label:D(()=>[ne(M(d.$gettext("Select Passkey")),1)]),default:D(()=>[b("p",eo,M(d.$gettext("Click the button below to open your browser window to select a passkey.")),1),p(i).createResponse?(L(),F("p",to,M(d.$gettext("A passkey has been selected. Submit this form to add it to your account.")),1)):(L(),F("div",no,[b("button",{type:"button",class:"btn btn-primary",onClick:h},M(d.$gettext("Select Passkey")),1)]))]),_:1}),I(Lt)],32)):(L(),F("div",oo,[b("p",ro,M(d.$gettext("Your browser does not support passkeys. Consider updating your browser to the latest version.")),1)]))]),"modal-footer":D($=>[Et(d.$slots,"modal-footer",At($t($)),()=>[b("button",{type:"button",class:"btn btn-secondary",onClick:y[0]||(y[0]=(...v)=>p(f)&&p(f)(...v))},M(d.$gettext("Close")),1),b("button",{type:"submit",class:Pt(["btn",p(a).$invalid?"btn-danger":"btn-primary"]),onClick:R},M(d.$gettext("Add New Passkey")),3)])]),_:3},8,["title"]))}}),io={class:"d-flex align-items-center"},ao={class:"flex-fill"},lo=["id"],uo={class:"flex-shrink-0"},co={class:"card-body"},fo={class:"card-text mt-2"},ho={class:"buttons"},go={class:"card-body"},mo={class:"card-text mt-2"},po={class:"buttons"},yo={class:"btn-group btn-group-sm"},wo=["onClick"],_o=q({__name:"SecurityPanel",setup(s){const{axios:o}=ee(),r=Z("/frontend/account/two-factor"),{state:n,isLoading:e,execute:t}=cn(()=>o.get(r.value).then(h=>({twoFactorEnabled:h.data.two_factor_enabled})),{twoFactorEnabled:!1}),i=U("$changePasswordModal"),l=()=>{var h;(h=i.value)==null||h.open()},a=U("$twoFactorModal"),u=()=>{var h;(h=a.value)==null||h.open()},{$gettext:c}=se(),{doDelete:g}=qe(c("Disable two-factor authentication?"),()=>{t()}),m=()=>g(r.value),f=Z("/frontend/account/passkeys"),C=[{key:"name",isRowHeader:!0,label:c("Passkey Nickname"),sortable:!1},{key:"actions",label:c("Actions"),sortable:!1,class:"shrink"}],E=U("$dataTable"),{relist:N}=Nt(E),{doDelete:w}=qe(c("Delete Passkey?"),N),A=U("$passkeyModal"),_=()=>{var h;(h=A.value)==null||h.create()};return(h,R)=>(L(),F(ue,null,[I(Mt,{"header-id":"hdr_security"},{header:D(({id:d})=>[b("div",io,[b("div",ao,[b("h3",{id:d,class:"card-title"},M(p(c)("Security")),9,lo)]),b("div",uo,[b("button",{type:"button",class:"btn btn-dark",onClick:l},[I(X,{icon:p(Ot)},null,8,["icon"]),b("span",null,M(p(c)("Change Password")),1)])])])]),default:D(()=>[I(an,{loading:p(e)},{default:D(()=>[b("div",co,[b("h5",null,[ne(M(p(c)("Two-Factor Authentication"))+" ",1),I(sn,{enabled:p(n).twoFactorEnabled},null,8,["enabled"])]),b("p",fo,M(p(c)("Two-factor authentication improves the security of your account by requiring a second one-time access code in addition to your password when you log in.")),1),b("div",ho,[p(n).twoFactorEnabled?(L(),F("button",{key:0,type:"button",class:"btn btn-danger",onClick:m},[I(X,{icon:p(zt)},null,8,["icon"]),b("span",null,M(p(c)("Disable Two-Factor")),1)])):(L(),F("button",{key:1,type:"button",class:"btn btn-success",onClick:u},[I(X,{icon:p(xt)},null,8,["icon"]),b("span",null,M(p(c)("Enable Two-Factor")),1)]))])])]),_:1},8,["loading"]),b("div",go,[b("h5",null,M(p(c)("Passkey Authentication")),1),b("p",mo,M(p(c)("Using a passkey (like Windows Hello, YubiKey, or your smartphone) allows you to securely log in without needing to enter your password or two-factor code.")),1),b("div",po,[b("button",{type:"button",class:"btn btn-primary",onClick:_},[I(X,{icon:p(_t)},null,8,["icon"]),b("span",null,M(p(c)("Add New Passkey")),1)])])]),I(It,{id:"account_passkeys",ref_key:"$dataTable",ref:E,"show-toolbar":!1,fields:C,"api-url":p(f)},{"cell(actions)":D(d=>[b("div",yo,[b("button",{type:"button",class:"btn btn-danger",onClick:y=>p(w)(d.item.links.self)},M(p(c)("Delete")),9,wo)])]),_:1},8,["api-url"])]),_:1}),I(Zn,{ref_key:"$changePasswordModal",ref:i},null,512),I(Xn,{ref_key:"$twoFactorModal",ref:a,"two-factor-url":p(r),onRelist:p(t)},null,8,["two-factor-url","onRelist"]),I(so,{ref_key:"$passkeyModal",ref:A,onRelist:p(N)},null,8,["onRelist"])],64))}}),bo={class:"card-subtitle"},vo={class:"card-text"},Co={class:"card-text"},Eo={class:"px-2"},Ao={id:"api_key"},$o={class:"buttons pt-2"},Po={class:"card-text pt-3"},ko={class:"card-text"},Bo=q({__name:"ApiKeyNewKey",props:{newKey:{}},setup(s){return(o,r)=>(L(),F(ue,null,[b("h3",bo,M(o.$gettext("New Key Generated")),1),b("p",vo,[b("b",null,M(o.$gettext("Important: copy the key below before continuing!")),1),ne(" "+M(o.$gettext("You will not be able to retrieve it again.")),1)]),b("p",Co,M(o.$gettext("Your full API key is below:")),1),b("div",Eo,[b("code",Ao,M(o.newKey),1),b("div",$o,[I(St,{text:o.newKey},null,8,["text"])])]),b("p",Po,M(o.$gettext('When making API calls, you can pass this value in the "X-API-Key" header to authenticate as yourself.')),1),b("p",ko,M(o.$gettext("You can only perform the actions your user account is allowed to perform.")),1)],64))}}),Ro={key:1},To=q({__name:"ApiKeyModal",props:{createUrl:{}},emits:["relist"],setup(s,{expose:o,emit:r}){const n=s,e=r,t=J(null),i=J(null),{form:l,resetForm:a,v$:u,validate:c}=ie({comment:{required:z}},{comment:""}),g=()=>{a(),t.value=null,i.value=null},m=U("$modal"),{show:f,hide:C}=ce(m),E=()=>{g(),f()},N=U("$field"),w=()=>{nn(()=>{var h;(h=N.value)==null||h.focus()})},{axios:A}=ee(),_=async()=>{await c()&&(t.value=null,A({method:"POST",url:n.createUrl,data:l.value}).then(R=>{i.value=R.data.key,e("relist")}).catch(R=>{R.value=R.response.data.message}))};return o({create:E}),(h,R)=>(L(),te(Tt,{id:"api_keys_modal",ref_key:"$modal",ref:m,size:"md",centered:"",title:h.$gettext("Add API Key"),"no-enforce-focus":"",onShown:w,onHidden:g},{default:D(()=>[kt(b("div",{class:"alert alert-danger"},M(t.value),513),[[Bt,t.value!=null]]),i.value===null?(L(),F("form",{key:0,class:"form vue-form",onSubmit:Rt(_,["prevent"])},[I(Y,{id:"form_comments",ref_key:"$field",ref:N,field:p(u).comment,autofocus:"",label:h.$gettext("API Key Description/Comments")},null,8,["field","label"]),I(Lt)],32)):(L(),F("div",Ro,[I(Bo,{"new-key":i.value},null,8,["new-key"])]))]),"modal-footer":D(d=>[Et(h.$slots,"modal-footer",At($t(d)),()=>[b("button",{type:"button",class:"btn btn-secondary",onClick:R[0]||(R[0]=(...y)=>p(C)&&p(C)(...y))},M(h.$gettext("Close")),1),i.value===null?(L(),F("button",{key:0,type:"submit",class:Pt(["btn",p(u).$invalid?"btn-danger":"btn-primary"]),onClick:_},M(h.$gettext("Create New Key")),3)):Ct("",!0)])]),_:3},8,["title"]))}}),Mo={href:"/api",class:"alert-link",target:"_blank"},So={class:"btn-group btn-group-sm"},Io=["onClick"],No=q({__name:"ApiKeysPanel",setup(s){const o=Z("/frontend/account/api-keys"),{$gettext:r}=se(),n=[{key:"comment",isRowHeader:!0,label:r("API Key Description/Comments"),sortable:!1},{key:"actions",label:r("Actions"),sortable:!1,class:"shrink"}],e=U("$apiKeyModal"),t=()=>{var u;(u=e.value)==null||u.create()},i=U("$dataTable"),{relist:l}=Nt(i),{doDelete:a}=qe(r("Delete API Key?"),l);return(u,c)=>(L(),F(ue,null,[I(Mt,{"header-id":"hdr_api_keys",title:p(r)("API Keys")},{info:D(()=>[ne(M(p(r)("Use API keys to authenticate with the Aplus API using the same permissions as your user account."))+" ",1),b("a",Mo,M(p(r)("API Documentation")),1)]),actions:D(()=>[b("button",{type:"button",class:"btn btn-primary",onClick:t},[I(X,{icon:p(_t)},null,8,["icon"]),b("span",null,M(p(r)("Add API Key")),1)])]),default:D(()=>[I(It,{id:"account_api_keys",ref_key:"$dataTable",ref:i,"show-toolbar":!1,fields:n,"api-url":p(o)},{"cell(actions)":D(g=>[b("div",So,[b("button",{type:"button",class:"btn btn-danger",onClick:m=>p(a)(g.item.links.self)},M(p(r)("Delete")),9,Io)])]),_:1},8,["api-url"])]),_:1},8,["title"]),I(To,{ref_key:"$apiKeyModal",ref:e,"create-url":p(o),onRelist:p(l)},null,8,["create-url","onRelist"])],64))}}),Lo={class:"outside-card-header mb-1"},Do=["aria-label"],Fo={class:"row row-of-cards"},Uo={class:"col-sm-12 col-md-6"},qo={class:"col-sm-12 col-md-6"},Ko=q({__name:"Account",props:{supportedLocales:{}},setup(s){const o=U("$editModal"),r=()=>{var e;(e=o.value)==null||e.open()},n=()=>{location.reload()};return(e,t)=>(L(),F(ue,null,[b("h2",Lo,M(e.$gettext("My Account")),1),b("section",{class:"card mb-4",role:"region","aria-label":e.$gettext("Account Details")},[I(rn,{ref:"$userInfoPanel"},{default:D(()=>[b("button",{type:"button",class:"btn btn-dark",onClick:r},[I(X,{icon:p(Yt)},null,8,["icon"]),b("span",null,M(e.$gettext("Edit Profile")),1)])]),_:1},512)],8,Do),b("div",Fo,[b("div",Uo,[I(_o)]),b("div",qo,[I(No)])]),I(_n,{ref_key:"$editModal",ref:o,"supported-locales":e.supportedLocales,onReload:n},null,8,["supported-locales"])],64))}});Wt(hn(Ko));
