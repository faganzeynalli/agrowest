import{u as $,d as S,c as B,i as U}from"../../../../usePlayerStore-CrWhEdqk.js";import{u as C}from"../../../../PanelLayout-O0so0TBT.js";import{_ as h,m as L,n as N}from"../../../../icons-MnSirWYG.js";import{_ as V}from"../../../../PlayButton-_2vltxHM.js";import{A as P}from"../../../../AlbumArt-D0N5gbUO.js";import{a as F}from"../../../../index-Bjjcwhm_.js";import{_ as D}from"../../../../Lightbox-B7TAdnOB.js";import{_ as H}from"../../../../CardPage-RtUZnPlY.js";import{_ as I}from"../../../../HeaderInlinePlayer-BFhNd_hh.js";import{u as O}from"../../../../lightbox-Cb_2lrH-.js";import{u as T}from"../../../../useOptionalStorage-BER6yRQA.js";import{a as d}from"../../../../router-BMTpFN0J.js";import{_ as M}from"../../../../DataTable-DZ8UW5rS.js";import{u as R}from"../../../../useHasDatatable-DPFcIMM0.js";import{d as j,c as u,j as b,b as i,o,e as t,g as l,w as r,u as n,t as e,h as E,f as _,F as g,i as q}from"../../../../vue-DTJ-1uEH.js";import"../../../../bootstrap.esm-BZy605kZ.js";import"../../../../lodash-BwctMegf.js";import"../../../../PanelLayout-CgEqeYFf.js";import"../../../../_plugin-vue_export-helper-DlAUqK2U.js";import"../../../../InfoCard-6lvkqcbV.js";import"../../../../InlinePlayer-CoiuAmt2.js";import"../../../../useShowVolume-FV4LaeBX.js";import"../../../../hlsjs-Cx0E5yqS.js";import"../../../../formatTime-DvDPwXf4.js";import"../../../../MuteButton-DZLkre_R.js";import"../../../../lodash-Bdl6ys83.js";import"../../../../FormMultiCheck-CTsnYoEJ.js";import"../../../../FormCheckbox-AsanX38Q.js";const z={id:"dashboard",class:"row-of-cards"},G={class:"d-flex flex-wrap align-items-center"},J={class:"flex-fill"},K=["id"],Q={key:0,class:"flex-shrink-0"},W=["href"],X={class:"h5 m-0"},Y={key:0},Z=["href"],ss={class:"pe-1"},ts=["href","aria-label"],as={class:"d-flex align-items-center"},es={key:1,class:"flex-fill text-muted"},os={key:2,class:"flex-fill"},ns={class:"nowplaying-title"},is={class:"nowplaying-artist"},ls={key:3,class:"flex-fill"},rs={class:"nowplaying-title"},cs=["href"],ds=j({__name:"Dashboard",props:{profileUrl:{},adminUrl:{},showAdmin:{type:Boolean},showCharts:{type:Boolean},manageStationsUrl:{},showAlbumArt:{type:Boolean}},setup(_s){const y=d("/frontend/dashboard/notifications");d("/frontend/dashboard/charts");const k=d("/frontend/dashboard/stations"),w=T("dashboard_show_chart",!0),{$gettext:a}=$();u(()=>w.value?a("Hide Charts"):a("Show Charts"));const{axios:x}=S(),{state:ps,isLoading:ms}=F(()=>x.get(y.value).then(c=>c.data),[]),v=[{key:"play_button",label:"",sortable:!1,class:"shrink"},{key:"name",label:a("Station Name"),sortable:!0},{key:"listeners",label:a("Listeners"),sortable:!0},{key:"now_playing",label:a("Now Playing"),sortable:!0},{key:"actions",label:"",sortable:!1,class:"shrink"}],p=b("$datatable"),{refresh:A}=R(p);B(A,u(()=>document.hidden?3e4:15e3));const m=b("$lightbox");return O(m),(c,f)=>(o(),i(g,null,[t("div",z,[l(H,{"header-id":"hdr_stations"},{header:r(({id:s})=>[t("div",G,[t("div",J,[t("h2",{id:s,class:"card-title"},e(n(a)("Station Overview")),9,K)]),c.showAdmin?(o(),i("div",Q,[t("a",{class:"btn btn-dark py-2",href:c.manageStationsUrl},[l(h,{icon:n(N)},null,8,["icon"]),t("span",null,e(n(a)("Manage Stations")),1)],8,W)])):_("",!0)])]),default:r(()=>[l(M,{id:"dashboard_stations",ref_key:"$datatable",ref:p,fields:v,"api-url":n(k),paginated:"",responsive:"","show-toolbar":"","hide-on-loading":!1},{"cell(play_button)":r(({item:s})=>[l(V,{class:"file-icon btn-lg",url:s.station.listen_url,"is-stream":""},null,8,["url"])]),"cell(name)":r(({item:s})=>[t("div",X,e(s.station.name),1),s.station.is_public?(o(),i("div",Y,[t("a",{href:s.links.public,target:"_blank"},e(n(a)("Public Page")),9,Z)])):_("",!0)]),"cell(listeners)":r(({item:s})=>[t("span",ss,[l(h,{class:"sm align-middle",icon:n(L)},null,8,["icon"])]),s.links.listeners?(o(),i("a",{key:0,href:s.links.listeners,"aria-label":n(a)("View Listener Report")},e(s.listeners.total),9,ts)):(o(),i(g,{key:1},[q(e(s.listeners.total),1)],64))]),"cell(now_playing)":r(({item:s})=>[t("div",as,[c.showAlbumArt?(o(),E(P,{key:0,src:s.now_playing.song.art,class:"flex-shrink-0 pe-3"},null,8,["src"])):_("",!0),s.is_online?s.now_playing.song.title!==""?(o(),i("div",os,[t("strong",null,[t("span",ns,e(s.now_playing.song.title),1)]),f[0]||(f[0]=t("br",null,null,-1)),t("span",is,e(s.now_playing.song.artist),1)])):(o(),i("div",ls,[t("strong",null,[t("span",rs,e(s.now_playing.song.text),1)])])):(o(),i("div",es,e(n(a)("Station Offline")),1))])]),"cell(actions)":r(({item:s})=>[t("a",{class:"btn btn-primary",href:s.links.manage,role:"button"},e(n(a)("Manage")),9,cs)]),_:1},8,["api-url"])]),_:1})]),l(I),l(D,{ref_key:"$lightbox",ref:m},null,512)],64))}});U(C(ds));
