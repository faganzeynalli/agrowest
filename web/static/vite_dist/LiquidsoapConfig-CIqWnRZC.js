import{d as F,r as m,c as L,p as N,b,e as o,g as c,t as e,w as a,H as S,o as s,F as T,y as B,j as u,u as $,z}from"./vue-Cts3TEHg.js";import{_ as M}from"./FormFieldset-BDg23QuA.js";import{_ as w}from"./index-BFjAyuuB.js";import{_ as D}from"./FormMarkup-B1oZzq5z.js";import{l as x}from"./lodash-Bdl6ys83.js";import{m as R}from"./mergeExisting-DGzkK79d.js";import{_ as j}from"./InfoCard-C2q1AMp7.js";import{u as H}from"./useVuelidateOnForm-DvID9VAf.js";import{u as J}from"./assets/frontend/js/pages/Stations-aI1Qy07P.js";import{d as O,f as P}from"./usePlayerStore-DOWZeqmH.js";import{_ as Y}from"./Loading-vp9RNwAY.js";import{g as G}from"./router-CzhCnqE6.js";import{_ as I}from"./CodemirrorTextarea-D9q_kWjw.js";import"./useFormField-BGrQPUJN.js";import"./FormGroup-LCbWR38E.js";import"./lodash-BwctMegf.js";import"./icons-Be1GHOkw.js";import"./index-D6B2xxAX.js";import"./router-axip6wyY.js";import"./PanelLayout-8tyaaaGw.js";import"./useOptionalStorage-CP14PsgK.js";import"./populateComponentRemotely-CjnEJ1fP.js";import"./acl-DKYapEiB.js";import"./useStationDateTimeFormatter-C4W2pgXo.js";import"./luxon-BJVMFgfj.js";import"./datetime-BTmRqpun.js";import"./Lightbox-zgmbLVpf.js";import"./HeaderInlinePlayer-DTCxdnKd.js";import"./InlinePlayer-DaJl6SxN.js";import"./useShowVolume-PqwbmhU7.js";import"./hlsjs-Cx0E5yqS.js";import"./formatTime-DvDPwXf4.js";import"./MuteButton-i7DsDLpt.js";import"./lightbox-CLViexMZ.js";import"./bootstrap.esm-BZy605kZ.js";import"./index.es-DoSWOjVm.js";const K={class:"card",role:"region","aria-labelledby":"hdr_edit_ls_config"},Q={class:"card-header text-bg-primary"},W={id:"hdr_edit_ls_config",class:"card-title"},X={class:"card-text"},Z={class:"card-text"},tt={class:"card-text"},ot={class:"card-body"},et={class:"typography-body-1"},Rt=F({__name:"LiquidsoapConfig",setup(at){const p=G("/liquidsoap-config"),n=m([]),f=m([]),{form:d,resetForm:k,v$:_,ifValid:V}=H(L(()=>{const t={};return x.forEach(n.value,i=>{t[i]={}}),t}),()=>{const t={};return x.forEach(n.value,i=>{t[i]=null}),t}),l=m(!0),{mayNeedRestart:C}=J(),{axios:g}=O(),h=()=>{l.value=!0,g.get(p.value).then(t=>{f.value=t.data.config,n.value=t.data.sections,k(),d.value=R(d.value,t.data.contents)}).finally(()=>{l.value=!1})};N(h);const{notifySuccess:E}=P(),U=()=>{V(()=>{g({method:"PUT",url:p.value,data:d.value}).then(()=>{E(),C(),h()})})};return(t,i)=>(s(),b("form",{class:"form vue-form",onSubmit:S(U,["prevent"])},[o("section",K,[o("div",Q,[o("h2",W,e(t.$gettext("Edit Liquidsoap Configuration")),1)]),c(j,null,{default:a(()=>[o("p",X,e(t.$gettext("Using this page, you can customize several sections of the Liquidsoap configuration. This allows you to add advanced functionality to your station's AutoDJ.")),1),o("p",Z,e(t.$gettext("The editable text boxes are areas where you can insert custom configuration code. The non-editable sections are automatically generated by Aplus.")),1),o("p",tt,e(t.$gettext("This is an advanced feature and custom code is not officially supported by Aplus. You may break your station by adding custom code, but removing it should fix any issues.")),1)]),_:1}),c(Y,{loading:l.value},{default:a(()=>[o("div",ot,[(s(!0),b(T,null,B(f.value,(r,y)=>(s(),u(M,{key:y,class:"mb-0"},{default:a(()=>[r.is_field?(s(),u(w,{key:0,id:"form_edit_"+r.field_name,field:$(_)[r.field_name]},{default:a(({id:q,model:v})=>[c(I,{id:q,modelValue:v.$model,"onUpdate:modelValue":A=>v.$model=A,mode:"liquidsoap"},null,8,["id","modelValue","onUpdate:modelValue"])]),_:2},1032,["id","field"])):(s(),u(D,{key:1,id:"form_section_"+y},{default:a(()=>[o("pre",et,e(r.markup??""),1)]),_:2},1032,["id"]))]),_:2},1024))),128)),o("button",{type:"submit",class:z(["btn",$(_).$invalid?"btn-danger":"btn-primary"])},e(t.$gettext("Save Changes")),3)])]),_:1},8,["loading"])])],32))}});export{Rt as default};
