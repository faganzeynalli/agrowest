import{d as x,r as h,c as M,p as w,h as G,o as d,w as l,e,g as v,t as s,u as o,i as c,b as f,E as L}from"./vue-B-dHMJBO.js";import{_ as I}from"./index-WveReOzm.js";import{u as C}from"./useVuelidateOnForm-vxUTvTiB.js";import{u as V,d as D}from"./usePlayerStore-CkejGpKz.js";import{_ as P}from"./Loading-B4WK-6A0.js";import{_ as B}from"./CardPage-0fdasE1K.js";import{a as S}from"./router-C-xyFC2M.js";import{u as U}from"./useDialog-j5jWy_Yl.js";import"./useFormField-B74zyo5n.js";import"./lodash-Bdl6ys83.js";import"./lodash-BwctMegf.js";import"./FormGroup-DZPf8gKm.js";import"./index-Ct57DpS4.js";import"./bootstrap.esm-BZy605kZ.js";import"./InfoCard-D6xe4CFe.js";import"./icons-Yf7pfv1X.js";const $={class:"card-body"},K={class:"row g-3"},T={class:"col-md-7"},A={class:"card-text"},F={class:"card-text"},N={href:"https://www.maxmind.com/en/geolite2/signup",target:"_blank"},R={class:"col-md-5"},E={class:"mb-3"},q={key:0,class:"text-success card-text"},O={key:1,class:"text-danger card-text"},Y={class:"buttons mt-3"},j={type:"submit",class:"btn btn-primary"},ue=x({__name:"GeoLite",setup(z){const u=S("/admin/geolite"),a=h(!0),n=h(null),{form:r,v$:y}=C({key:{}},{key:null}),{$gettext:t}=V(),g=M(()=>t('GeoLite version "%{version}" is currently installed.',{version:n.value})),{axios:m}=D();w(()=>{a.value=!0,m.get(u.value).then(i=>{r.value.key=i.data.key,n.value=i.data.version,a.value=!1})});const p=()=>{a.value=!0,m.post(u.value,{geolite_license_key:r.value.key}).then(i=>{n.value=i.data.version}).finally(()=>{a.value=!1})},{confirmDelete:b}=U(),k=()=>{b({title:t("Remove GeoLite license key?"),confirmButtonText:t("Remove Key")}).then(i=>{i.value&&(r.value.key=null,p())})};return(i,_)=>(d(),G(B,{"header-id":"hdr_install_geolite",title:o(t)("Install GeoLite IP Database")},{info:l(()=>[c(s(o(t)("IP Geolocation is used to guess the approximate location of your listeners based on the IP address they connect with. Use the free built-in IP Geolocation library or enter a license key on this page to use MaxMind GeoLite.")),1)]),default:l(()=>[e("div",$,[v(P,{loading:a.value},{default:l(()=>[e("div",K,[e("div",T,[e("fieldset",null,[e("legend",null,s(o(t)("Instructions")),1),e("p",A,s(o(t)("Aplus ships with a built-in free IP geolocation database. You may prefer to use the MaxMind GeoLite service instead to achieve more accurate results. Using MaxMind GeoLite requires a license key, but once the key is provided, we will automatically keep the database updated.")),1),e("p",F,s(o(t)("To download the GeoLite database:")),1),e("ul",null,[e("li",null,[c(s(o(t)("Create an account on the MaxMind developer site."))+" ",1),_[0]||(_[0]=e("br",null,null,-1)),e("a",N,s(o(t)("MaxMind Developer Site")),1)]),e("li",null,s(o(t)('Visit the "My License Key" page under the "Services" section.')),1),e("li",null,s(o(t)('Click "Generate new license key".')),1),e("li",null,s(o(t)("Paste the generated license key into the field on this page.")),1)])])]),e("div",R,[e("fieldset",E,[e("legend",null,s(o(t)("Current Installed Version")),1),n.value?(d(),f("p",q,s(g.value),1)):(d(),f("p",O,s(o(t)("GeoLite is not currently installed on this installation.")),1))]),e("form",{onSubmit:L(p,["prevent"])},[e("fieldset",null,[v(I,{id:"edit_form_key",field:o(y).key},{label:l(()=>[c(s(o(t)("MaxMind License Key")),1)]),_:1},8,["field"])]),e("div",Y,[e("button",j,s(o(t)("Save Changes")),1),e("button",{type:"button",class:"btn btn-danger",onClick:k},s(o(t)("Remove Key")),1)])],32)])])]),_:1},8,["loading"])])]),_:1},8,["title"]))}});export{ue as default};
