import{b as X,f as Z,d as W,u as O}from"./usePlayerStore-CrWhEdqk.js";import{a as Lt}from"./index-Bjjcwhm_.js";import{g as tt}from"./router-BMTpFN0J.js";import{u as x,S as P}from"./acl-DQQoX4B5.js";import{_ as h,j as Bt,m as J,K as vt,P as St,M as Nt,Q as et,R as Ot,e as Vt,i as Dt,S as st,T as nt,n as Ht,f as Ft,U as zt,V as Wt,W as Rt,J as Et}from"./icons-MnSirWYG.js";import{_ as A}from"./CardPage-RtUZnPlY.js";import{d as R,a as I,b as d,o,e as t,g as r,f as p,t as s,u as e,w as _,F as U,h as v,y as Q,i as k,j as z,H as lt,z as Tt,q as jt,c as D,x as j,m as xt,U as ot,r as Pt,D as Jt,A as N,n as H,k as G}from"./vue-DTJ-1uEH.js";import{_ as Yt}from"./Loading-CxLO-rjm.js";import{_ as Y}from"./PlayButton-_2vltxHM.js";import{B as at,F}from"./RadioAdapters-DeTvpZIq.js";import{u as Kt,n as Qt}from"./useNowPlaying-1pKCe0xE.js";import{a as Gt}from"./lightbox-Cb_2lrH-.js";import{r as Xt}from"./index-C5jhSXy3.js";import{_ as Ut}from"./index-B5xmHqbE.js";import{u as Zt}from"./useVuelidateOnForm-Dr1I6Jxr.js";import{u as At,_ as qt}from"./useHasModal-DtYoA97m.js";import{I as te}from"./InvisibleSubmitButton-CAE8DMRX.js";import{_ as ee}from"./InfoCard-6lvkqcbV.js";import{u as Mt}from"./useDialog-7K09lciJ.js";import{l as Ct}from"./lodash-Bdl6ys83.js";import{u as se}from"./useStationDateTimeFormatter-CZDlk0g-.js";import{u as ne}from"./luxon-UD-XfROn.js";import{_ as it}from"./EnabledBadge-DUB7hcux.js";import{b as le}from"./router-ChzbwHil.js";import{_ as K}from"./CopyToClipboardButton-Cgvht9il.js";import{_ as wt}from"./FormGroupMultiCheck-BcON9BaA.js";import{_ as It}from"./RunningBadge-CRWPKOrE.js";import{u as oe}from"./useOptionalStorage-BER6yRQA.js";import{u as ae}from"./useAutoRefreshingAsyncState-DRQn8HNE.js";import"./bootstrap.esm-BZy605kZ.js";import"./lodash-BwctMegf.js";import"./formatTime-DvDPwXf4.js";import"./useFormField-Cf7tjYtH.js";import"./FormGroup-BNI6R37d.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./datetime-BTmRqpun.js";import"./FormMultiCheck-CTsnYoEJ.js";import"./useSlotsExcept-BSzLfLLp.js";import"./useRefreshableAsyncState-DfEfMJkx.js";const ie={class:"outside-card-header d-flex align-items-center"},re={class:"flex-fill"},de={class:"display-6 m-0"},ce={key:0,class:"flex-shrink-0 ms-3"},ue={class:"card-body"},pe={class:"card-text"},me=R({__name:"StationDisabledPanel",setup(y){const{name:l}=X();return(i,n)=>{const u=I("router-link");return o(),d(U,null,[t("div",ie,[t("div",re,[t("h2",de,s(e(l)),1)]),e(x)(e(P).Profile)?(o(),d("div",ce,[r(u,{class:"btn btn-primary",role:"button",to:{name:"stations:profile:edit"}},{default:_(()=>[r(h,{icon:e(Bt)},null,8,["icon"]),t("span",null,s(i.$gettext("Edit Profile")),1)]),_:1})])):p("",!0)]),r(A,{id:"station-disabled",title:i.$gettext("Station Disabled")},{default:_(()=>[t("div",ue,[t("p",pe,s(i.$gettext("Your station is currently not enabled for broadcasting. You can still manage media, playlists, and other station settings. To re-enable broadcasting, edit your station profile.")),1)])]),_:1},8,["title"])],64)}}}),_e={class:"table table-striped table-responsive mb-0"},be={colspan:"2"},he={class:"text-end"},fe={class:"pe-1"},ge={class:"ps-1"},ye={class:"mb-1"},ke=["href"],$e={class:"ps-1 text-end"},ve={class:"listeners-total ps-1"},Se={class:"listeners-unique pe-1"},xe={colspan:"2"},Pe={class:"text-end"},Ue={class:"pe-1"},we={class:"ps-1"},Be={class:"mb-1"},De=["href"],Re={class:"ps-1 text-end"},Ee={class:"listeners-total ps-1"},Te={class:"listeners-unique pe-1"},Ae={colspan:"2"},qe={class:"text-end"},Me={class:"align-middle"},Ce={class:"pe-1"},Ie={class:"ps-1"},Le=["href"],Ne={class:"ps-1 text-end"},Oe={class:"listeners-total ps-1"},Ve=["href"],He=["href"],Fe=R({inheritAttrs:!1,__name:"StreamsPanel",props:{station:{}},setup(y){return(l,i)=>(o(),v(A,{"header-id":"hdr_streams",title:l.$gettext("Streams")},{footer_actions:_(()=>[t("a",{class:"btn btn-link text-primary",href:l.station.playlist_pls_url},[r(h,{icon:e(vt)},null,8,["icon"]),t("span",null,s(l.$gettext("Download PLS")),1)],8,Ve),t("a",{class:"btn btn-link text-primary",href:l.station.playlist_m3u_url},[r(h,{icon:e(vt)},null,8,["icon"]),t("span",null,s(l.$gettext("Download M3U")),1)],8,He)]),default:_(()=>[t("table",_e,[i[2]||(i[2]=t("colgroup",null,[t("col",{style:{width:"2%"}}),t("col",{style:{width:"78%"}}),t("col",{style:{width:"20%"}})],-1)),l.station.mounts.length>0?(o(),d(U,{key:0},[t("thead",null,[t("tr",null,[t("th",be,s(l.$gettext("Local Streams")),1),t("th",he,s(l.$gettext("Listeners")),1)])]),t("tbody",null,[(o(!0),d(U,null,Q(l.station.mounts,n=>(o(),d("tr",{key:n.id,class:"align-middle"},[t("td",fe,[r(Y,{class:"btn-lg",url:n.url,"is-stream":""},null,8,["url"])]),t("td",ge,[t("h6",ye,s(n.name),1),t("a",{href:n.url,target:"_blank"},s(n.url),9,ke)]),t("td",$e,[r(h,{class:"sm align-middle",icon:e(J)},null,8,["icon"]),t("span",ve,s(n.listeners.total),1),i[0]||(i[0]=t("br",null,null,-1)),t("small",null,[t("span",Se,s(n.listeners.unique),1),k(" "+s(l.$gettext("Unique")),1)])])]))),128))])],64)):p("",!0),l.station.remotes.length>0?(o(),d(U,{key:1},[t("thead",null,[t("tr",null,[t("th",xe,s(l.$gettext("Remote Relays")),1),t("th",Pe,s(l.$gettext("Listeners")),1)])]),t("tbody",null,[(o(!0),d(U,null,Q(l.station.remotes,n=>(o(),d("tr",{key:n.id,class:"align-middle"},[t("td",Ue,[r(Y,{class:"btn-lg",url:n.url,"is-stream":""},null,8,["url"])]),t("td",we,[t("h6",Be,s(n.name),1),t("a",{href:n.url,target:"_blank"},s(n.url),9,De)]),t("td",Re,[r(h,{class:"sm align-middle",icon:e(J)},null,8,["icon"]),t("span",Ee,s(n.listeners.total),1),i[1]||(i[1]=t("br",null,null,-1)),t("small",null,[t("span",Te,s(n.listeners.unique),1),k(" "+s(l.$gettext("Unique")),1)])])]))),128))])],64)):p("",!0),l.station.hls_enabled?(o(),d(U,{key:2},[t("thead",null,[t("tr",null,[t("th",Ae,s(l.$gettext("HTTP Live Streaming (HLS)")),1),t("th",qe,s(l.$gettext("Listeners")),1)])]),t("tbody",null,[t("tr",Me,[t("td",Ce,[r(Y,{class:"btn-lg",url:l.station.hls_url,"is-stream":"","is-hls":""},null,8,["url"])]),t("td",Ie,[t("a",{href:l.station.hls_url,target:"_blank"},s(l.station.hls_url),9,Le)]),t("td",Ne,[r(h,{class:"sm align-middle",icon:e(J)},null,8,["icon"]),t("span",Oe,s(l.station.hls_listeners)+" "+s(l.$gettext("Unique")),1)])])])],64)):p("",!0)])]),_:1},8,["title"]))}}),ze={class:"outside-card-header d-flex align-items-center"},We={key:0,class:"flex-shrink-0 me-2"},je={class:"flex-fill"},Je={class:"display-6 m-0"},Ye={key:0,class:"text-muted"},Ke={key:1,class:"flex-shrink-0 ms-3"},Qe=R({inheritAttrs:!1,__name:"HeaderPanel",props:{station:{},stationName:{},stationDescription:{},hasStarted:{type:Boolean}},setup(y){return(l,i)=>{const n=I("router-link");return o(),d("div",ze,[l.station.listen_url&&l.hasStarted?(o(),d("div",We,[r(Y,{class:"btn-xl",url:l.station.listen_url,"is-stream":""},null,8,["url"])])):p("",!0),t("div",je,[t("h2",Je,[k(s(l.stationName),1),i[0]||(i[0]=t("br",null,null,-1)),l.stationDescription?(o(),d("small",Ye,s(l.stationDescription),1)):p("",!0)])]),e(x)(e(P).Profile)?(o(),d("div",Ke,[r(n,{class:"btn btn-primary",role:"button",to:{name:"stations:profile:edit"}},{default:_(()=>[r(h,{icon:e(Bt)},null,8,["icon"]),t("span",null,s(l.$gettext("Edit Profile")),1)]),_:1})])):p("",!0)])}}}),Ge={class:"row g-3"},Xe=R({__name:"UpdateMetadataModal",setup(y,{expose:l}){const i=tt("/nowplaying/update"),{form:n,v$:u,resetForm:a,ifValid:c}=Zt({title:{required:Xt},artist:{}},{title:null,artist:null}),$=z("$modal"),{hide:b,show:f}=At($),m=()=>{a()},g=z("$field"),B=()=>{jt(()=>{var M;(M=g.value)==null||M.focus()})},{notifySuccess:L}=Z(),{axios:T}=W(),{$gettext:w}=O(),S=()=>{c(()=>{T.post(i.value,n.value).then(()=>{L(w("Metadata updated."))}).finally(()=>{b()})})};return l({open:f}),(M,E)=>(o(),v(qt,{id:"update_metadata",ref_key:"$modal",ref:$,centered:"",title:e(w)("Update Metadata"),onHidden:m,onShown:B},{"modal-footer":_(()=>[t("button",{type:"button",class:"btn btn-secondary",onClick:E[0]||(E[0]=(...q)=>e(b)&&e(b)(...q))},s(e(w)("Close")),1),t("button",{type:"button",class:Tt(["btn",e(u).$invalid?"btn-danger":"btn-primary"]),onClick:S},s(e(w)("Update Metadata")),3)]),default:_(()=>[r(ee,null,{default:_(()=>[k(s(e(w)("Use this form to send a manual metadata update. Note that this will override any existing metadata on the stream.")),1)]),_:1}),t("form",{onSubmit:lt(S,["prevent"])},[t("div",Ge,[r(Ut,{id:"update_metadata_title",ref_key:"$field",ref:g,class:"col-12",field:e(u).title,label:e(w)("Title")},null,8,["field","label"]),r(Ut,{id:"update_metadata_artist",class:"col-12",field:e(u).artist,label:e(w)("Artist")},null,8,["field","label"])]),r(te)],32)]),_:1},8,["title"]))}});function C(y,l={}){const{axios:i}=W(),{showAlert:n}=Mt(),{notify:u}=Z();return()=>{n(l).then(a=>{a.value&&i.post(y).then(({data:c})=>{u(c.formatted_message,{variant:c.success?"success":"warning"})})})}}const Ze={class:"d-flex align-items-center"},ts=["id"],es={class:"card-subtitle text-end flex-fill my-0",style:{"line-height":"1"}},ss={class:"ps-1"},ns={class:"pe-1"},ls={class:"card-body"},os={class:"row"},as={class:"col-md-6"},is={class:"clearfix"},rs={class:"d-table"},ds={class:"d-table-row"},cs={class:"d-table-cell align-middle text-end pe-2 pb-2"},us={class:"d-table-cell align-middle w-100 pb-2"},ps={class:"m-0"},ms={class:"d-table-row"},_s={class:"d-table-cell align-top text-end pe-2"},bs=["href"],hs=["src"],fs={class:"d-table-cell align-middle w-100"},gs={key:0},ys={class:"media-heading m-0 text-muted"},ks={key:1},$s={class:"media-heading m-0",style:{"line-height":"1.2"}},vs={class:"text-muted"},Ss={key:2},xs={class:"media-heading m-0",style:{"line-height":"1.2"}},Ps={key:3},Us={class:"text-muted"},ws={key:4,class:"nowplaying-progress"},Bs={class:"col-md-6"},Ds={key:0,class:"clearfix"},Rs={class:"d-table"},Es={class:"d-table-row"},Ts={class:"d-table-cell align-middle pe-2 text-end pb-2"},As={class:"d-table-cell align-middle w-100 pb-2"},qs={class:"m-0"},Ms={class:"d-table-row"},Cs={class:"d-table-cell align-top text-end pe-2"},Is=["href"],Ls=["src"],Ns={class:"d-table-cell align-middle w-100"},Os={key:0},Vs={class:"media-heading m-0",style:{"line-height":"1"}},Hs={class:"text-muted"},Fs={key:1},zs={class:"media-heading m-0",style:{"line-height":"1"}},Ws={key:2},js={class:"text-muted"},Js={key:1,class:"clearfix"},Ys={style:{"margin-left":"22px"}},Ks={class:"media-heading",style:{"margin-left":"22px"}},Qs=R({inheritAttrs:!1,__name:"NowPlayingPanel",props:{backendType:{},backendSkipSongUri:{},backendDisconnectStreamerUri:{},stationShortName:{},useStatic:{type:Boolean},useSse:{type:Boolean}},setup(y){const l=y,{offlineText:i}=X(),{np:n,currentTrackDurationDisplay:u,currentTrackElapsedDisplay:a}=Kt(l),{$gettext:c,$ngettext:$}=O(),b=D(()=>{var w,S,M,E;return $("%{listeners} Listener","%{listeners} Listeners",((S=(w=n.value)==null?void 0:w.listeners)==null?void 0:S.total)??0,{listeners:String(((E=(M=n.value)==null?void 0:M.listeners)==null?void 0:E.total)??0)})}),f=D(()=>l.backendType===at.Liquidsoap),{vLightbox:m}=Gt(),g=C(l.backendSkipSongUri,{title:c("Skip current song?"),confirmButtonText:c("Skip Song")}),B=C(l.backendDisconnectStreamerUri,{title:c("Disconnect current streamer?"),confirmButtonText:c("Disconnect Streamer")}),L=z("$updateMetadataModal"),T=()=>{var w;(w=L.value)==null||w.open()};return(w,S)=>{const M=I("router-link");return o(),d(U,null,[r(A,{id:"profile-nowplaying",class:"nowplaying","header-id":"hdr_now_playing"},j({header:_(({id:E})=>{var q;return[t("div",Ze,[t("h3",{id:E,class:"flex-shrink card-title my-0"},s(e(c)("On the Air")),9,ts),t("h6",es,[r(h,{class:"align-middle",icon:e(J)},null,8,["icon"]),t("span",ss,s(b.value),1),S[3]||(S[3]=t("br",null,null,-1)),t("small",null,[t("span",ns,s(((q=e(n).listeners)==null?void 0:q.unique)??0),1),k(" "+s(e(c)("Unique")),1)])]),e(x)(e(P).Reports)?(o(),v(M,{key:0,class:"flex-shrink btn btn-link text-white ms-2 px-1 py-2",to:{name:"stations:reports:listeners"},title:e(c)("Listener Report")},{default:_(()=>[r(h,{icon:e(Dt)},null,8,["icon"])]),_:1},8,["title"])):p("",!0)])]}),default:_(()=>{var E,q,V,dt,ct,ut,pt,mt,_t,bt,ht,ft,gt,yt,kt,$t;return[t("div",ls,[t("div",os,[t("div",as,[t("div",is,[t("div",rs,[t("div",ds,[t("div",cs,[r(h,{icon:e(Ot)},null,8,["icon"])]),t("div",us,[t("h5",ps,s(e(c)("Now Playing")),1)])]),t("div",ms,[t("div",_s,[(q=(E=e(n).now_playing)==null?void 0:E.song)!=null&&q.art?xt((o(),d("a",{key:0,href:e(n).now_playing.song.art,target:"_blank"},[t("img",{class:"rounded",src:e(n).now_playing.song.art,alt:"Album Art",style:{width:"50px"}},null,8,hs)],8,bs)),[[e(m)]]):p("",!0)]),t("div",fs,[e(n).is_online?(dt=(V=e(n).now_playing)==null?void 0:V.song)!=null&&dt.title?(o(),d("div",ks,[t("h6",$s,[k(s(e(n).now_playing.song.title),1),S[4]||(S[4]=t("br",null,null,-1)),t("small",vs,s(e(n).now_playing.song.artist),1)])])):(o(),d("div",Ss,[t("h6",xs,s(((ut=(ct=e(n).now_playing)==null?void 0:ct.song)==null?void 0:ut.text)??""),1)])):(o(),d("div",gs,[t("h5",ys,s(e(i)??e(c)("Station Offline")),1)])),(pt=e(n).now_playing)!=null&&pt.playlist?(o(),d("div",Ps,[t("small",Us,s(e(c)("Playlist"))+" : "+s(e(n).now_playing.playlist),1)])):p("",!0),e(a)?(o(),d("div",ws,[t("small",null,s(e(a))+" / "+s(e(u)),1)])):p("",!0)])])])])]),t("div",Bs,[!((mt=e(n).live)!=null&&mt.is_live)&&e(n).playing_next?(o(),d("div",Ds,[t("div",Rs,[t("div",Es,[t("div",Ts,[r(h,{icon:e(St)},null,8,["icon"])]),t("div",As,[t("h5",qs,s(e(c)("Playing Next")),1)])]),t("div",Ms,[t("div",Cs,[(bt=(_t=e(n).playing_next)==null?void 0:_t.song)!=null&&bt.art?xt((o(),d("a",{key:0,href:e(n).playing_next.song.art,target:"_blank"},[t("img",{src:e(n).playing_next.song.art,class:"rounded",alt:"Album Art",style:{width:"40px"}},null,8,Ls)],8,Is)),[[e(m)]]):p("",!0)]),t("div",Ns,[(ft=(ht=e(n).playing_next)==null?void 0:ht.song)!=null&&ft.title?(o(),d("div",Os,[t("h6",Vs,[k(s(e(n).playing_next.song.title),1),S[5]||(S[5]=t("br",null,null,-1)),t("small",Hs,s(e(n).playing_next.song.artist),1)])])):(o(),d("div",Fs,[t("h6",zs,s(((yt=(gt=e(n).playing_next)==null?void 0:gt.song)==null?void 0:yt.text)??""),1)])),e(n).playing_next.playlist?(o(),d("div",Ws,[t("small",js,s(e(c)("Playlist"))+" : "+s(e(n).playing_next.playlist),1)])):p("",!0)])])])])):(kt=e(n).live)!=null&&kt.is_live?(o(),d("div",Js,[t("h6",Ys,[r(h,{icon:e(Vt)},null,8,["icon"]),k(" "+s(e(c)("Live")),1)]),t("h4",Ks,s(($t=e(n).live)==null?void 0:$t.streamer_name),1)])):p("",!0)])])])]}),_:2},[f.value&&e(x)(e(P).Broadcasting)?{name:"footer_actions",fn:_(()=>{var E,q;return[(E=e(n).live)!=null&&E.is_live?p("",!0):(o(),d("button",{key:0,id:"btn_skip_song",type:"button",class:"btn btn-link text-primary",onClick:S[0]||(S[0]=V=>e(g)())},[r(h,{icon:e(St)},null,8,["icon"]),t("span",null,s(e(c)("Skip Song")),1)])),(q=e(n).live)!=null&&q.is_live?(o(),d("button",{key:1,id:"btn_disconnect_streamer",type:"button",class:"btn btn-link text-primary",onClick:S[1]||(S[1]=V=>e(B)())},[r(h,{icon:e(Nt)},null,8,["icon"]),t("span",null,s(e(c)("Disconnect Streamer")),1)])):p("",!0),t("button",{id:"btn_update_metadata",type:"button",class:"btn btn-link text-secondary",onClick:S[2]||(S[2]=V=>T())},[r(h,{icon:e(et)},null,8,["icon"]),t("span",null,s(e(c)("Update Metadata")),1)])]}),key:"0"}:void 0]),1024),f.value&&e(x)(e(P).Broadcasting)?(o(),v(Xe,{key:0,ref_key:"$updateMetadataModal",ref:L},null,512)):p("",!0)],64)}}}),Gs={class:"table table-striped mb-0"},Xs={class:"d-flex w-100 justify-content-between align-items-center"},Zs={class:"m-0"},tn={class:"text-end m-0"},en=R({inheritAttrs:!1,__name:"SchedulePanel",props:{scheduleItems:{}},setup(y){const l=y,{DateTime:i}=ne(),{now:n,timestampToDateTime:u,formatDateTime:a}=se(),c=D(()=>{const $=n();return Ct.map(l.scheduleItems,b=>{const f=u(b.start_timestamp),m=u(b.end_timestamp);return b.time_until=f.toRelative(),b.start_formatted=a(f,f.hasSame($,"day")?i.TIME_SIMPLE:i.DATETIME_MED),b.end_formatted=a(m,m.hasSame(f,"day")?i.TIME_SIMPLE:i.DATETIME_MED),b})});return($,b)=>c.value.length>0?(o(),v(A,{key:0,class:"scheduled","header-id":"hdr_scheduled",title:$.$gettext("Scheduled")},{default:_(()=>[t("table",Gs,[t("tbody",null,[(o(!0),d(U,null,Q(c.value,f=>(o(),d("tr",{key:f.id},[t("td",null,[t("div",Xs,[t("h5",Zs,[t("small",null,[f.type==="playlist"?(o(),d(U,{key:0},[k(s($.$gettext("Playlist")),1)],64)):(o(),d(U,{key:1},[k(s($.$gettext("Streamer/DJ")),1)],64))]),b[0]||(b[0]=t("br",null,null,-1)),k(" "+s(f.name),1)]),t("p",tn,[t("small",null,s(f.start_formatted)+" - "+s(f.end_formatted),1),b[1]||(b[1]=t("br",null,null,-1)),t("strong",null,[f.is_now?(o(),d(U,{key:0},[k(s($.$gettext("Now")),1)],64)):(o(),d(U,{key:1},[k(s(f.time_until),1)],64))])])])])]))),128))])])]),_:1},8,["title"])):p("",!0)}});function rt(y,l){const{axios:i}=W(),{showAlert:n}=Mt(),{notifySuccess:u}=Z(),{$gettext:a}=O(),c=le(),$=tt("/profile/edit");return()=>{const b=!l.value;n({title:a(b?"Enable feature?":"Disable feature?"),confirmButtonText:a(b?"Enable":"Disable"),confirmButtonClass:b?"btn-success":"btn-danger"}).then(f=>{if(f.value){const m={};Ct.set(m,y,b),i.put($.value,m).then(g=>{u(g.data.message),c.go(0)})}})}}const sn=["id"],nn=R({inheritAttrs:!1,__name:"RequestsPanel",props:{enableRequests:{type:Boolean}},setup(y){const i=rt("enable_requests",ot(y,"enableRequests"));return(n,u)=>{const a=I("router-link");return o(),v(A,{"header-id":"hdr_song_requests"},j({header:_(({id:c})=>[t("h3",{id:c,class:"card-title"},[k(s(n.$gettext("Song Requests"))+" ",1),r(it,{enabled:n.enableRequests},null,8,["enabled"])],8,sn)]),_:2},[e(x)(e(P).Broadcasting)||e(x)(e(P).Profile)?{name:"footer_actions",fn:_(()=>[n.enableRequests?(o(),d(U,{key:0},[e(x)(e(P).Broadcasting)?(o(),v(a,{key:0,class:"btn btn-link text-primary",to:{name:"stations:reports:requests"}},{default:_(()=>[r(h,{icon:e(Dt)},null,8,["icon"]),t("span",null,s(n.$gettext("View")),1)]),_:1})):p("",!0),e(x)(e(P).Profile)?(o(),d("button",{key:1,type:"button",class:"btn btn-link text-danger",onClick:u[0]||(u[0]=(...c)=>e(i)&&e(i)(...c))},[r(h,{icon:e(st)},null,8,["icon"]),t("span",null,s(n.$gettext("Disable")),1)])):p("",!0)],64)):(o(),d(U,{key:1},[e(x)(e(P).Profile)?(o(),d("button",{key:0,type:"button",class:"btn btn-link text-success",onClick:u[1]||(u[1]=(...c)=>e(i)&&e(i)(...c))},[r(h,{icon:e(nt)},null,8,["icon"]),t("span",null,s(n.$gettext("Enable")),1)])):p("",!0)],64))]),key:"0"}:void 0]),1024)}}}),ln=["id"],on=R({inheritAttrs:!1,__name:"StreamersPanel",props:{enableStreamers:{type:Boolean}},setup(y){const i=rt("enable_streamers",ot(y,"enableStreamers"));return(n,u)=>{const a=I("router-link");return o(),v(A,{"header-id":"hdr_streamers"},j({header:_(({id:c})=>[t("h3",{id:c,class:"card-title"},[k(s(n.$gettext("Streamers/DJs"))+" ",1),r(it,{enabled:n.enableStreamers},null,8,["enabled"])],8,ln)]),_:2},[e(x)(e(P).Streamers)||e(x)(e(P).Profile)?{name:"footer_actions",fn:_(()=>[n.enableStreamers?(o(),d(U,{key:0},[e(x)(e(P).Streamers)?(o(),v(a,{key:0,class:"btn btn-link text-primary",to:{name:"stations:streamers:index"}},{default:_(()=>[r(h,{icon:e(Ht)},null,8,["icon"]),t("span",null,s(n.$gettext("Manage")),1)]),_:1})):p("",!0),e(x)(e(P).Profile)?(o(),d("button",{key:1,type:"button",class:"btn btn-link text-danger",onClick:u[0]||(u[0]=(...c)=>e(i)&&e(i)(...c))},[r(h,{icon:e(st)},null,8,["icon"]),t("span",null,s(n.$gettext("Disable")),1)])):p("",!0)],64)):(o(),d(U,{key:1},[e(x)(e(P).Profile)?(o(),d("button",{key:0,type:"button",class:"btn btn-link text-success",onClick:u[1]||(u[1]=(...c)=>e(i)&&e(i)(...c))},[r(h,{icon:e(nt)},null,8,["icon"]),t("span",null,s(n.$gettext("Enable")),1)])):p("",!0)],64))]),key:"0"}:void 0]),1024)}}}),an={class:"row"},rn={class:"col-md-7"},dn={class:"card mb-3",role:"region"},cn={class:"card-header text-bg-primary"},un={class:"card-title"},pn={class:"card-body"},mn={class:"row"},_n={class:"col-md-6"},bn={class:"col-md-6"},hn={class:"col-md-5"},fn={class:"card mb-3",role:"region"},gn={class:"card-header text-bg-primary"},yn={class:"card-title"},kn={class:"card-body"},$n=["value"],vn=["data-bs-theme"],Sn={class:"card-header text-bg-primary"},xn={class:"card-title"},Pn={class:"card-body"},Un=["src"],wn=R({inheritAttrs:!1,__name:"EmbedModal",props:{stationSupportsStreamers:{type:Boolean},stationSupportsRequests:{type:Boolean},enablePublicPage:{type:Boolean},enableStreamers:{type:Boolean},enableOnDemand:{type:Boolean},enableRequests:{type:Boolean},publicPageEmbedUri:{},publicOnDemandEmbedUri:{},publicRequestEmbedUri:{},publicHistoryEmbedUri:{},publicScheduleEmbedUri:{},publicPodcastsEmbedUri:{}},setup(y,{expose:l}){const i=y,n=Pt("player"),u=Pt("light"),{$gettext:a}=O(),c=D(()=>{const T=[{value:"player",text:a("Radio Player")},{value:"history",text:a("History")},{value:"podcasts",text:a("Podcasts")},{value:"schedule",text:a("Schedule")}];return i.stationSupportsRequests&&i.enableRequests&&T.push({value:"requests",text:a("Requests")}),i.enableOnDemand&&T.push({value:"ondemand",text:a("On-Demand Media")}),T}),$=D(()=>[{value:"browser",text:a("Browser Default")},{value:"light",text:a("Light")},{value:"dark",text:a("Dark")}]),b=D(()=>{switch(n.value){case"history":return i.publicHistoryEmbedUri;case"ondemand":return i.publicOnDemandEmbedUri;case"requests":return i.publicRequestEmbedUri;case"schedule":return i.publicScheduleEmbedUri;case"podcasts":return i.publicPodcastsEmbedUri;case"player":default:return i.publicPageEmbedUri}}),f=D(()=>{const T=new URL(b.value);return u.value!=="browser"&&T.searchParams.set("theme",u.value),T.toString()}),m=D(()=>{switch(n.value){case"ondemand":case"podcasts":return"400px";case"requests":return"850px";case"history":return"300px";case"schedule":return"800px";case"player":default:return"150px"}}),g=D(()=>'<iframe src="'+f.value+'" frameborder="0" allowtransparency="true" style="width: 100%; min-height: '+m.value+'; border: 0;"></iframe>'),B=z("$modal"),{show:L}=At(B);return l({open:L}),(T,w)=>(o(),v(qt,{id:"embed_modal",ref_key:"$modal",ref:B,size:"lg",title:e(a)("Embed Widgets"),"hide-footer":"","no-enforce-focus":""},{default:_(()=>[t("div",an,[t("div",rn,[t("section",dn,[t("div",cn,[t("h2",un,s(e(a)("Customize")),1)]),t("div",pn,[t("div",mn,[t("div",_n,[r(wt,{id:"embed_type",modelValue:n.value,"onUpdate:modelValue":w[0]||(w[0]=S=>n.value=S),label:e(a)("Widget Type"),options:c.value,stacked:"",radio:""},null,8,["modelValue","label","options"])]),t("div",bn,[r(wt,{id:"embed_theme",modelValue:u.value,"onUpdate:modelValue":w[1]||(w[1]=S=>u.value=S),label:e(a)("Theme"),name:"embed_theme",options:$.value,stacked:"",radio:""},null,8,["modelValue","label","options"])])])])])]),t("div",hn,[t("section",fn,[t("div",gn,[t("h2",yn,s(e(a)("Embed Code")),1)]),t("div",kn,[t("textarea",{class:"full-width form-control text-preformatted",spellcheck:"false",style:{height:"100px"},readonly:"",value:g.value},null,8,$n),r(K,{text:g.value},null,8,["text"])])])])]),t("section",{class:"card mb-3",role:"region","data-bs-theme":u.value},[t("div",Sn,[t("h2",xn,s(e(a)("Preview")),1)]),t("div",Pn,[t("iframe",{width:"100%",src:f.value,frameborder:"0",style:Jt([{width:"100%",border:"0"},{"min-height":m.value}])},null,12,Un)])],8,vn)]),_:1},8,["title"]))}}),Bn=["id"],Dn={key:0,class:"table table-striped table-responsive-md mb-0"},Rn=["href"],En={key:0},Tn=["href"],An={key:1},qn=["href"],Mn=["href"],Cn=["href"],In=R({inheritAttrs:!1,__name:"PublicPagesPanel",props:{stationSupportsStreamers:{type:Boolean},stationSupportsRequests:{type:Boolean},enablePublicPage:{type:Boolean},enableStreamers:{type:Boolean},enableOnDemand:{type:Boolean},enableRequests:{type:Boolean},publicPageUri:{},publicWebDjUri:{},publicOnDemandUri:{},publicPodcastsUri:{},publicScheduleUri:{},publicPageEmbedUri:{},publicOnDemandEmbedUri:{},publicRequestEmbedUri:{},publicHistoryEmbedUri:{},publicScheduleEmbedUri:{},publicPodcastsEmbedUri:{}},setup(y){const l=y,i=z("$embedModal"),n=()=>{var a;(a=i.value)==null||a.open()},u=rt("enable_public_page",ot(l,"enablePublicPage"));return(a,c)=>{const $=I("router-link");return o(),d(U,null,[r(A,{"header-id":"hdr_public_pages"},{header:_(({id:b})=>[t("h3",{id:b,class:"card-title"},[k(s(a.$gettext("Public Pages"))+" ",1),r(it,{enabled:a.enablePublicPage},null,8,["enabled"])],8,Bn)]),footer_actions:_(()=>[a.enablePublicPage?(o(),d(U,{key:0},[t("a",{class:"btn btn-link text-secondary",onClick:lt(n,["prevent"])},[r(h,{icon:e(Ft)},null,8,["icon"]),t("span",null,s(a.$gettext("Embed Widgets")),1)]),e(x)(e(P).Profile)?(o(),v($,{key:0,class:"btn btn-link text-secondary",to:{name:"stations:branding"}},{default:_(()=>[r(h,{icon:e(zt)},null,8,["icon"]),t("span",null,s(a.$gettext("Edit Branding")),1)]),_:1})):p("",!0),e(x)(e(P).Profile)?(o(),d("button",{key:1,type:"button",class:"btn btn-link text-danger",onClick:c[0]||(c[0]=(...b)=>e(u)&&e(u)(...b))},[r(h,{icon:e(st)},null,8,["icon"]),t("span",null,s(a.$gettext("Disable")),1)])):p("",!0)],64)):(o(),d(U,{key:1},[e(x)(e(P).Profile)?(o(),d("button",{key:0,type:"button",class:"btn btn-link text-success",onClick:c[1]||(c[1]=(...b)=>e(u)&&e(u)(...b))},[r(h,{icon:e(nt)},null,8,["icon"]),t("span",null,s(a.$gettext("Enable")),1)])):p("",!0)],64))]),default:_(()=>[a.enablePublicPage?(o(),d("table",Dn,[c[2]||(c[2]=t("colgroup",null,[t("col",{style:{width:"30%"}}),t("col",{style:{width:"70%"}})],-1)),t("tbody",null,[t("tr",null,[t("td",null,s(a.$gettext("Public Page")),1),t("td",null,[t("a",{href:a.publicPageUri,target:"_blank"},s(a.publicPageUri),9,Rn)])]),a.stationSupportsStreamers&&a.enableStreamers?(o(),d("tr",En,[t("td",null,s(a.$gettext("Web DJ")),1),t("td",null,[t("a",{href:a.publicWebDjUri,target:"_blank"},s(a.publicWebDjUri),9,Tn)])])):p("",!0),a.enableOnDemand?(o(),d("tr",An,[t("td",null,s(a.$gettext("On-Demand Media")),1),t("td",null,[t("a",{href:a.publicOnDemandUri,target:"_blank"},s(a.publicOnDemandUri),9,qn)])])):p("",!0),t("tr",null,[t("td",null,s(a.$gettext("Podcasts")),1),t("td",null,[t("a",{href:a.publicPodcastsUri,target:"_blank"},s(a.publicPodcastsUri),9,Mn)])]),t("tr",null,[t("td",null,s(a.$gettext("Schedule")),1),t("td",null,[t("a",{href:a.publicScheduleUri,target:"_blank"},s(a.publicScheduleUri),9,Cn)])])])])):p("",!0)]),_:1}),r(wn,N(l,{ref_key:"$embedModal",ref:i}),null,16)],64)}}}),Ln=["id"],Nn={class:"table table-striped table-responsive"},On={class:"align-middle"},Vn=["href"],Hn={class:"px-0"},Fn={class:"text-monospace"},zn={class:"px-0"},Wn={class:"align-middle"},jn={class:"ps-0",colspan:"2"},Jn={key:0,class:"form-text"},Yn={class:"align-middle"},Kn={class:"px-0"},Qn={class:"text-monospace"},Gn={class:"px-0"},Xn={class:"align-middle"},Zn={class:"px-0"},tl={class:"text-monospace"},el={class:"px-0"},sl=R({inheritAttrs:!1,__name:"FrontendPanel",props:{frontendRunning:{type:Boolean},frontendType:{},frontendAdminUri:{},frontendAdminPassword:{},frontendSourcePassword:{},frontendRelayPassword:{},frontendPort:{},frontendRestartUri:{},frontendStartUri:{},frontendStopUri:{},hasStarted:{type:Boolean}},setup(y){const l=y,i=oe("station_show_frontend_credentials",!1),{$gettext:n}=O(),u=D(()=>i.value?n("Hide Credentials"):n("Show Credentials")),a=D(()=>{switch(l.frontendType){case F.Icecast:return"Icecast";case F.Rsas:return"Rocket Streaming Audio Server (RSAS)";case F.Shoutcast:return"Shoutcast";default:return""}}),c=D(()=>l.frontendType===F.Shoutcast),$=C(l.frontendRestartUri,{title:n("Restart service?"),confirmButtonText:n("Restart")}),b=C(l.frontendStartUri,{title:n("Start service?"),confirmButtonText:n("Start"),confirmButtonClass:"btn-success"}),f=C(l.frontendStopUri,{title:n("Stop service?"),confirmButtonText:n("Stop"),confirmButtonClass:"btn-danger"});return(m,g)=>(o(),v(A,{id:"profile-frontend",class:"mb-4","header-id":"hdr_frontend"},j({header:_(({id:B})=>[t("h3",{id:B,class:"card-title"},[k(s(e(n)("Broadcasting Service"))+" ",1),r(It,{running:m.frontendRunning},null,8,["running"]),g[4]||(g[4]=t("br",null,null,-1)),t("small",null,s(a.value),1)],8,Ln)]),default:_(()=>[e(x)(e(P).Broadcasting)?(o(),d("div",{key:0,class:Tt(["collapse",e(i)?"show":""])},[t("table",Nn,[t("tbody",null,[t("tr",On,[t("td",null,[t("a",{href:m.frontendAdminUri,target:"_blank"},s(e(n)("Administration")),9,Vn)]),t("td",Hn,[t("div",null,[k(s(e(n)("Username:"))+" ",1),g[5]||(g[5]=t("span",{class:"text-monospace"},"admin",-1))]),t("div",null,[k(s(e(n)("Password:"))+" ",1),t("span",Fn,s(m.frontendAdminPassword),1)])]),t("td",zn,[r(K,{text:m.frontendAdminPassword,"hide-text":""},null,8,["text"])])]),t("tr",Wn,[t("td",null,s(e(n)("Port")),1),t("td",jn,[k(s(m.frontendPort)+" ",1),c.value?(o(),d("div",Jn,s(e(n)("Some clients may require that you enter a port number that is either one above or one below this number.")),1)):p("",!0)])]),t("tr",Yn,[t("td",null,s(e(n)("Source")),1),t("td",Kn,[t("div",null,[k(s(e(n)("Username:"))+" ",1),g[6]||(g[6]=t("span",{class:"text-monospace"},"source",-1))]),t("div",null,[k(s(e(n)("Password:"))+" ",1),t("span",Qn,s(m.frontendSourcePassword),1)])]),t("td",Gn,[r(K,{text:m.frontendSourcePassword,"hide-text":""},null,8,["text"])])]),t("tr",Xn,[t("td",null,s(e(n)("Relay")),1),t("td",Zn,[t("div",null,[k(s(e(n)("Username:"))+" ",1),g[7]||(g[7]=t("span",{class:"text-monospace"},"relay",-1))]),t("div",null,[k(s(e(n)("Password:"))+" ",1),t("span",tl,s(m.frontendRelayPassword),1)])]),t("td",el,[r(K,{text:m.frontendRelayPassword,"hide-text":""},null,8,["text"])])])])])],2)):p("",!0)]),_:2},[e(x)(e(P).Broadcasting)?{name:"footer_actions",fn:_(()=>[t("a",{class:"btn btn-link text-primary",onClick:g[0]||(g[0]=lt(B=>i.value=!e(i),["prevent"]))},[r(h,{icon:e(Wt)},null,8,["icon"]),t("span",null,s(u.value),1)]),m.hasStarted?(o(),d(U,{key:0},[t("button",{type:"button",class:"btn btn-link text-secondary",onClick:g[1]||(g[1]=(...B)=>e($)&&e($)(...B))},[r(h,{icon:e(et)},null,8,["icon"]),t("span",null,s(e(n)("Restart")),1)]),m.frontendRunning?p("",!0):(o(),d("button",{key:0,type:"button",class:"btn btn-link text-success",onClick:g[2]||(g[2]=B=>e(b)())},[r(h,{icon:e(Rt)},null,8,["icon"]),t("span",null,s(e(n)("Start")),1)])),m.frontendRunning?(o(),d("button",{key:1,type:"button",class:"btn btn-link text-danger",onClick:g[3]||(g[3]=B=>e(f)())},[r(h,{icon:e(Et)},null,8,["icon"]),t("span",null,s(e(n)("Stop")),1)])):p("",!0)],64)):p("",!0)]),key:"0"}:void 0]),1024))}}),nl={class:"card-body"},ll={class:"card-text"},ol=R({__name:"BackendNonePanel",setup(y){return(l,i)=>(o(),v(A,{id:"profile-backend","header-id":"hdr_backend_disabled",title:l.$gettext("AutoDJ Disabled")},{default:_(()=>[t("div",nl,[t("p",ll,s(l.$gettext("AutoDJ has been disabled for this station. No music will automatically be played when a source is not live.")),1)])]),_:1},8,["title"]))}}),al=["id"],il={class:"card-body"},rl={class:"card-text"},dl={key:0,class:"buttons"},cl=R({inheritAttrs:!1,__name:"BackendPanel",props:{backendRunning:{type:Boolean},numSongs:{},numPlaylists:{},backendType:{},hasStarted:{type:Boolean},backendRestartUri:{},backendStartUri:{},backendStopUri:{}},setup(y){const l=y,{$gettext:i,$ngettext:n}=O(),u=D(()=>{const f=n("%{numSongs} uploaded song","%{numSongs} uploaded songs",l.numSongs,{numSongs:String(l.numSongs)}),m=n("%{numPlaylists} playlist","%{numPlaylists} playlists",l.numPlaylists,{numPlaylists:String(l.numPlaylists)});return i("LiquidSoap is currently shuffling from %{songs} and %{playlists}.",{songs:f,playlists:m})}),a=D(()=>l.backendType===at.Liquidsoap?"Liquidsoap":""),c=C(l.backendRestartUri,{title:i("Restart service?"),confirmButtonText:i("Restart")}),$=C(l.backendStartUri,{title:i("Start service?"),confirmButtonText:i("Start"),confirmButtonClass:"btn-success"}),b=C(l.backendStopUri,{title:i("Stop service?"),confirmButtonText:i("Stop"),confirmButtonClass:"btn-danger"});return(f,m)=>{const g=I("router-link");return o(),v(A,{id:"profile-backend","header-id":"hdr_backend"},j({header:_(({id:B})=>[t("h3",{id:B,class:"card-title"},[k(s(e(i)("AutoDJ Service"))+" ",1),r(It,{running:f.backendRunning},null,8,["running"]),m[3]||(m[3]=t("br",null,null,-1)),t("small",null,s(a.value),1)],8,al)]),default:_(()=>[t("div",il,[t("p",rl,s(u.value),1),e(x)(e(P).Media)?(o(),d("div",dl,[r(g,{class:"btn btn-primary",to:{name:"stations:files:index"}},{default:_(()=>[k(s(e(i)("Music Files")),1)]),_:1}),r(g,{class:"btn btn-primary",to:{name:"stations:playlists:index"}},{default:_(()=>[k(s(e(i)("Playlists")),1)]),_:1})])):p("",!0)])]),_:2},[e(x)(e(P).Broadcasting)&&f.hasStarted?{name:"footer_actions",fn:_(()=>[t("button",{type:"button",class:"btn btn-link text-secondary",onClick:m[0]||(m[0]=B=>e(c)())},[r(h,{icon:e(et)},null,8,["icon"]),t("span",null,s(e(i)("Restart")),1)]),f.backendRunning?p("",!0):(o(),d("button",{key:0,type:"button",class:"btn btn-link text-success",onClick:m[1]||(m[1]=B=>e($)())},[r(h,{icon:e(Rt)},null,8,["icon"]),t("span",null,s(e(i)("Start")),1)])),f.backendRunning?(o(),d("button",{key:1,type:"button",class:"btn btn-link text-danger",onClick:m[2]||(m[2]=B=>e(b)())},[r(h,{icon:e(Et)},null,8,["icon"]),t("span",null,s(e(i)("Stop")),1)])):p("",!0)]),key:"0"}:void 0]),1024)}}}),ul={class:"card-body"},pl={class:"card-text"},ml=R({__name:"NowPlayingNotStartedPanel",setup(y){return(l,i)=>(o(),v(A,{id:"profile-now-playing","header-id":"hdr_now_playing",title:l.$gettext("On the Air")},{default:_(()=>[t("div",ul,[t("p",pl,s(l.$gettext("Information about the current playing track will appear here once your station has started.")),1)])]),_:1},8,["title"]))}}),_l={id:"profile",class:"row row-of-cards"},bl={class:"col-lg-7"},hl={class:"col-lg-5"},fl=R({__name:"EnabledProfile",props:{profileApiUri:{},stationSupportsRequests:{type:Boolean},stationSupportsStreamers:{type:Boolean},numSongs:{},numPlaylists:{},backendType:{},hasStarted:{type:Boolean},backendRestartUri:{},backendStartUri:{},backendStopUri:{},frontendType:{},frontendAdminUri:{},frontendAdminPassword:{},frontendSourcePassword:{},frontendRelayPassword:{},frontendPort:{},frontendRestartUri:{},frontendStartUri:{},frontendStopUri:{},stationName:{},stationDescription:{},backendSkipSongUri:{},backendDisconnectStreamerUri:{},stationShortName:{},useStatic:{type:Boolean},useSse:{type:Boolean},enableRequests:{type:Boolean},enablePublicPage:{type:Boolean},enableStreamers:{type:Boolean},enableOnDemand:{type:Boolean},publicPageUri:{},publicWebDjUri:{},publicOnDemandUri:{},publicPodcastsUri:{},publicScheduleUri:{},publicPageEmbedUri:{},publicOnDemandEmbedUri:{},publicRequestEmbedUri:{},publicHistoryEmbedUri:{},publicScheduleEmbedUri:{},publicPodcastsEmbedUri:{}},setup(y){const l=y,i=D(()=>l.frontendType!==F.Remote),n=D(()=>l.backendType!==at.None),{axiosSilent:u}=W(),{state:a}=ae(()=>u.get(l.profileApiUri).then(c=>c.data),{station:{...Qt.station},services:{backend_running:!1,frontend_running:!1,has_started:!1,needs_restart:!1},schedule:[]},{timeout:15e3});return(c,$)=>(o(),d(U,null,[r(Qe,N(l,{station:e(a).station}),null,16,["station"]),t("div",_l,[t("div",bl,[c.hasStarted?(o(),d(U,{key:0},[r(Qs,H(G(l)),null,16),r(en,{"schedule-items":e(a).schedule},null,8,["schedule-items"]),r(Fe,{station:e(a).station},null,8,["station"])],64)):(o(),v(ml,{key:1})),r(In,H(G(l)),null,16)]),t("div",hl,[c.stationSupportsRequests?(o(),v(nn,H(N({key:0},l)),null,16)):p("",!0),c.stationSupportsStreamers?(o(),v(on,H(N({key:1},l)),null,16)):p("",!0),i.value?(o(),v(sl,N({key:2},l,{"frontend-running":e(a).services.frontend_running}),null,16,["frontend-running"])):p("",!0),n.value?(o(),v(cl,N({key:3},l,{"backend-running":e(a).services.backend_running}),null,16,["backend-running"])):(o(),v(ol,{key:4}))])])],64))}}),no=R({__name:"Profile",setup(y){const{isEnabled:l}=X(),{axios:i}=W(),{isLoading:n,state:u}=Lt(async()=>l?await(await i.get(tt("/vue/profile").value)).data:null,null);return(a,c)=>e(l)?(o(),v(Yt,{key:0,loading:e(n),lazy:""},{default:_(()=>[r(fl,H(G(e(u))),null,16)]),_:1},8,["loading"])):(o(),v(me,{key:1}))}});export{no as default};
