import{d as S,r as q,i as C,j as B,o as n,w as u,e as l,t as o,u as s,H as h,c as N,b as r,g,F as Q,f as $,h as x}from"./vue-Cts3TEHg.js";import{_ as R}from"./DataTable-BfTejNvr.js";import{f as V}from"./index-BnEhpeRR.js";import{u as F,_ as H}from"./useHasModal-D2Ru6T_p.js";import{_ as I,W as w}from"./icons-Be1GHOkw.js";import{u as E,c as P,f as z,d as W}from"./usePlayerStore-CC_kVnAb.js";import{u as G}from"./useConfirmAndDelete-B_XWJi2y.js";import{u as J}from"./useHasDatatable-DPFcIMM0.js";import{_ as K}from"./CardPage-BV0W_9Ux.js";import{g as T}from"./router-DM9KDTmq.js";import{u as O}from"./useStationDateTimeFormatter-CnCVRmiz.js";import{u as X}from"./useDialog-Cl4hqAc4.js";import"./lodash-Bdl6ys83.js";import"./lodash-BwctMegf.js";import"./FormMultiCheck-BRaoZhWq.js";import"./FormCheckbox-VeRpO6PO.js";import"./useOptionalStorage-C748mBvv.js";import"./bootstrap.esm-BZy605kZ.js";import"./Loading-vp9RNwAY.js";import"./InfoCard-C2q1AMp7.js";import"./luxon-BzScXK2g.js";import"./datetime-BTmRqpun.js";const Y=["value"],Z=S({__name:"LogsModal",setup(D,{expose:b}){const m=q("Loading..."),t=C("$modal"),{show:y,hide:d}=F(t),k=i=>{m.value=i.slice().join(""),y()},p=V(),c=()=>{p.copy(m.value)};return b({show:k}),(i,_)=>(n(),B(H,{id:"logs_modal",ref_key:"$modal",ref:t,size:"xl",title:i.$gettext("Log Viewer")},{"modal-footer":u(()=>[l("button",{class:"btn btn-secondary",type:"button",onClick:_[0]||(_[0]=(...v)=>s(d)&&s(d)(...v))},o(i.$gettext("Close")),1),l("button",{class:"btn btn-primary",type:"button",onClick:h(c,["prevent"])},o(i.$gettext("Copy to Clipboard")),1)]),default:u(()=>[l("textarea",{class:"form-control log-viewer",spellcheck:"false",readonly:"",value:m.value},null,8,Y)]),_:1},8,["title"]))}}),ee={class:"btn-group btn-group-sm"},te=["onClick"],oe=["onClick"],se={key:0},ae={key:1},le={key:2},ne={key:0},ie={key:1},Le=S({__name:"Queue",setup(D){const b=T("/queue"),m=T("/queue/clear"),{$gettext:t}=E(),y=[{key:"actions",label:t("Actions"),sortable:!1},{key:"song_title",isRowHeader:!0,label:t("Song Title"),sortable:!1},{key:"played_at",label:t("Expected to Play at"),sortable:!1},{key:"source",label:t("Source"),sortable:!1}],{formatTimestampAsTime:d,formatTimestampAsRelative:k}=O(),p=C("$dataTable"),{relist:c}=J(p);P(c,N(()=>document.hidden?6e4:3e4));const i=C("$logsModal"),_=f=>{var a;(a=i.value)==null||a.show(f)},{doDelete:v}=G(t("Delete Queue Item?"),c),{confirmDelete:M}=X(),{notifySuccess:A}=z(),{axios:L}=W(),U=async()=>{const{value:f}=await M({title:t("Clear Upcoming Song Queue?"),confirmButtonText:t("Clear")});if(f){const{data:a}=await L.post(m.value);A(a.message),c()}};return(f,a)=>(n(),r(Q,null,[g(K,{title:s(t)("Upcoming Song Queue")},{actions:u(()=>[l("button",{type:"button",class:"btn btn-danger",onClick:a[0]||(a[0]=e=>U())},[g(I,{icon:s(w)},null,8,["icon"]),l("span",null,o(s(t)("Clear Upcoming Song Queue")),1)])]),default:u(()=>[g(R,{id:"station_queue",ref_key:"$dataTable",ref:p,fields:y,"api-url":s(b),"hide-on-loading":!1},{"cell(actions)":u(e=>[l("div",ee,[e.item.log?(n(),r("button",{key:0,type:"button",class:"btn btn-primary",onClick:h(j=>_(e.item.log),["prevent"])},o(s(t)("Logs")),9,te)):$("",!0),e.item.sent_to_autodj?$("",!0):(n(),r("button",{key:1,type:"button",class:"btn btn-danger",onClick:h(j=>s(v)(e.item.links.self),["prevent"])},o(s(t)("Delete")),9,oe))])]),"cell(song_title)":u(e=>[e.item.autodj_custom_uri?(n(),r("div",se,o(e.item.autodj_custom_uri),1)):e.item.song.title?(n(),r("div",ae,[l("b",null,o(e.item.song.title),1),a[1]||(a[1]=l("br",null,null,-1)),x(" "+o(e.item.song.artist),1)])):(n(),r("div",le,o(e.item.song.text),1))]),"cell(played_at)":u(e=>[x(o(s(d)(e.item.played_at)),1),a[2]||(a[2]=l("br",null,null,-1)),l("small",null,o(s(k)(e.item.played_at)),1)]),"cell(source)":u(e=>[e.item.is_request?(n(),r("div",ne,o(s(t)("Listener Request")),1)):e.item.playlist?(n(),r("div",ie,o(s(t)("Playlist"))+": "+o(e.item.playlist),1)):$("",!0)]),_:1},8,["api-url"])]),_:1},8,["title"]),g(Z,{ref_key:"$logsModal",ref:i},null,512)],64))}});export{Le as default};
