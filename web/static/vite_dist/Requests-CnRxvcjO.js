import{_ as P}from"./DataTable-CuDCWdIJ.js";import{_ as S,W as A}from"./icons-Be1GHOkw.js";import{u as B,f as F,d as U}from"./usePlayerStore-D2Yy6Bxy.js";import{g as b}from"./router-4MaTkvgX.js";import{u as V}from"./useStationDateTimeFormatter-CQlryVgl.js";import{u as I}from"./useDialog-B4KfCD8t.js";import{d as z,r as H,c as E,i as L,b as i,e as a,f as k,g,t as s,u as r,F as W,y as j,w as c,o as n,z as G,h as p,q as J}from"./vue-Cts3TEHg.js";import"./lodash-Bdl6ys83.js";import"./lodash-BwctMegf.js";import"./FormMultiCheck-BRaoZhWq.js";import"./FormCheckbox-VeRpO6PO.js";import"./useOptionalStorage-DBOfakfd.js";import"./index-Bav4EGom.js";import"./bootstrap.esm-BZy605kZ.js";import"./luxon-BJyPbqTc.js";import"./datetime-BTmRqpun.js";const K={class:"card",role:"region"},M={class:"card-header text-bg-primary"},O={class:"card-title"},Q={class:"card-body"},X={class:"nav nav-tabs",role:"tablist"},Y=["onClick"],Z={key:0,class:"card-body"},w={key:0},ee={key:1},te={key:0},se={key:1},ae=["onClick"],he=z({__name:"Requests",setup(oe){const h=b("/reports/requests"),T=b("/reports/requests/clear"),d=H("pending"),q=E(()=>h.value+"?type="+d.value),{$gettext:t}=B(),C=[{key:"timestamp",label:t("Date Requested"),sortable:!1},{key:"played_at",label:t("Date Played"),sortable:!1},{key:"song_title",isRowHeader:!0,label:t("Song Title"),sortable:!1},{key:"ip",label:t("Requester IP"),sortable:!1},{key:"actions",label:t("Actions"),sortable:!1}],R=[{type:"pending",title:t("Pending Requests")},{type:"history",title:t("Request History")}],u=L("$dataTable"),m=()=>{var o;(o=u.value)==null||o.refresh()},x=o=>{d.value=o,J(m)},{formatIsoAsDateTime:_}=V(),{confirmDelete:y}=I(),{notifySuccess:f}=F(),{axios:v}=U(),D=o=>{y({title:t("Delete Request?")}).then(l=>{l.value&&v.delete(o).then(e=>{f(e.data.message),m()})})},$=()=>{y({title:t("Clear All Pending Requests?"),confirmButtonText:t("Clear")}).then(o=>{o.value&&v.post(T.value).then(l=>{f(l.data.message),m()})})};return(o,l)=>(n(),i("section",K,[a("div",M,[a("h2",O,s(r(t)("Song Requests")),1)]),a("div",Q,[a("nav",X,[(n(),i(W,null,j(R,e=>a("div",{key:e.type,class:"nav-item",role:"presentation"},[a("button",{class:G(["nav-link",d.value===e.type?"active":""]),type:"button",role:"tab",onClick:N=>x(e.type)},s(e.title),11,Y)])),64))])]),d.value==="pending"?(n(),i("div",Z,[a("button",{type:"button",class:"btn btn-danger",onClick:l[0]||(l[0]=e=>$())},[g(S,{icon:r(A)},null,8,["icon"]),a("span",null,s(r(t)("Clear Pending Requests")),1)])])):k("",!0),g(P,{id:"station_queue",ref_key:"$dataTable",ref:u,fields:C,"api-url":q.value},{"cell(timestamp)":c(e=>[p(s(r(_)(e.item.timestamp)),1)]),"cell(played_at)":c(e=>[e.item.played_at===null?(n(),i("span",w,s(r(t)("Not Played")),1)):(n(),i("span",ee,s(r(_)(e.item.played_at)),1))]),"cell(song_title)":c(e=>[e.item.track.title?(n(),i("div",te,[a("b",null,s(e.item.track.title),1),l[1]||(l[1]=a("br",null,null,-1)),p(" "+s(e.item.track.artist),1)])):(n(),i("div",se,s(e.item.track.text),1))]),"cell(ip)":c(e=>[p(s(e.item.ip),1)]),"cell(actions)":c(e=>[e.item.played_at===0?(n(),i("button",{key:0,type:"button",class:"btn btn-sm btn-danger",onClick:N=>D(e.item.links.delete)},s(r(t)("Delete")),9,ae)):k("",!0)]),_:1},8,["api-url"])]))}});export{he as default};
