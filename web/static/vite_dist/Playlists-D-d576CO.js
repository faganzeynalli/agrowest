import{_ as fo}from"./DataTable-IpCKErCf.js";import{d as be,L as ho,j as me,o as _,u as s,w as A,e as p,m as Lt,g as w,v as qt,t as m,h as W,U as Ho,b as T,z as Tt,f as ee,y as ze,F as Q,i as ae,c as Yo,K as tt,W as Nt,s as Xo,p as Lo,q as mo,a3 as qo,r as se,H as Ue,a as jo}from"./vue-Cts3TEHg.js";import{_ as Ae,u as Wo}from"./index-_yzKx5VP.js";import{_ as Rt}from"./FormGroupCheckbox-D-gLeBTN.js";import{_ as Vo}from"./FormFieldset-BDg23QuA.js";import{l as Mt}from"./lodash-Bdl6ys83.js";import{_ as rt}from"./FormGroupMultiCheck-C7bjG8ut.js";import{_ as zo}from"./FormGroupSelect-DlvjWHXm.js";import{u as Ce,a as Go,f as Me,d as Fe,j as Jo,l as Zo}from"./usePlayerStore-DS4JWrVc.js";import{u as Ko}from"./useVuelidateOnFormTab-ComMkCCV.js";import{r as st}from"./index-Hn1RL1dT.js";import{_ as Bt,a as vo}from"./Tabs-CaFrjWYq.js";import{_ as Te,W as Qo,X as en,Y as tn,Z as on,$ as nn,a0 as ln,a1 as an,a2 as rn}from"./icons-Be1GHOkw.js";import{_ as jt}from"./TimeCode-Dwib3imv.js";import{_ as Ft}from"./FormMarkup-B1oZzq5z.js";import{_ as go}from"./TimeZone-BxJ_mfJR.js";import{u as sn}from"./useBaseEditModal-Tfufp5-n.js";import{_ as bo}from"./ModalForm-C6TMMAim.js";import{_ as cn}from"./PlayButton-U5BBf7uh.js";import{_ as dn}from"./InlinePlayer-Bvokkmm5.js";import{_ as mt,u as vt}from"./useHasModal-CpoPjHcE.js";import{I as un}from"./InvisibleSubmitButton-EsMx6l8t.js";import{_ as pn}from"./FormGroup-LCbWR38E.js";import{_ as fn}from"./FormFile-ByMMAzbh.js";import{u as _o,a as hn}from"./useVuelidateOnForm-Djx7l4YG.js";import{_ as mn,u as vn}from"./AddButton-uc7Azowb.js";import{u as gn}from"./assets/frontend/js/pages/Stations-Cq80EguN.js";import{u as Wt}from"./useConfirmAndDelete-OgT0B0nj.js";import{u as bn}from"./luxon-D8V-fPAL.js";import{g as Vt}from"./router-DKP-J9qz.js";import{u as _n}from"./useHasDatatable-DPFcIMM0.js";import"./FormMultiCheck-BRaoZhWq.js";import"./FormCheckbox-VeRpO6PO.js";import"./useOptionalStorage-D1XbMmRA.js";import"./index-TG6t8ei9.js";import"./useFormField-gQcyfaLO.js";import"./lodash-BwctMegf.js";import"./useSlotsExcept-By0Eq2ad.js";import"./bootstrap.esm-BZy605kZ.js";import"./mergeExisting-DGzkK79d.js";import"./useShowVolume-CL8MbxxT.js";import"./hlsjs-Cx0E5yqS.js";import"./formatTime-DvDPwXf4.js";import"./MuteButton-DN23R6md.js";import"./Loading-vp9RNwAY.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./router-DNNhXLID.js";import"./PanelLayout-DZj-RS5K.js";import"./populateComponentRemotely-Rb5bBlJG.js";import"./acl-CjGbPo1n.js";import"./useStationDateTimeFormatter-DmgyyJrB.js";import"./Lightbox-zgmbLVpf.js";import"./HeaderInlinePlayer-DvxAdQ_p.js";import"./lightbox-CLViexMZ.js";import"./datetime-BTmRqpun.js";import"./useDialog-CxBg2-5w.js";const yn={class:"row g-3 mb-3"},wn={class:"card mb-3",role:"region"},Sn={class:"card-header text-bg-primary"},kn={class:"card-title"},xn={class:"card-body"},Cn={class:"row g-3 mb-3"},$n={href:"/docs/user-guide/playlists/#advanced-playlists",target:"_blank"},Dn={class:"row g-3"},En=be({__name:"BasicInfo",props:{form:{required:!0},formModifiers:{}},emits:["update:form"],setup(e){const o=ho(e,"form"),{v$:t,tabClass:n}=Ko(o,{name:{required:st},is_enabled:{},include_in_on_demand:{},weight:{},type:{},source:{},order:{},remote_url:{},remote_type:{},remote_buffer:{},is_jingle:{},play_per_songs:{},play_per_minutes:{},play_per_hour_minute:{},include_in_requests:{},avoid_duplicates:{}},{name:"",is_enabled:!0,include_in_on_demand:!1,weight:3,type:"default",source:"songs",order:"sequential",remote_url:null,remote_type:"stream",remote_buffer:0,is_jingle:!1,play_per_songs:0,play_per_minutes:0,play_per_hour_minute:0,include_in_requests:!1,avoid_duplicates:!0}),{$gettext:l}=Ce();l("Song-Based"),l("A playlist containing media files hosted on this server."),l("Remote URL"),l("A playlist that instructs the station to play from a remote URL.");const a=[{value:"default",text:l("General Rotation"),description:l("Standard playlist, shuffles with other standard playlists based on weight.")},{value:"once_per_x_songs",text:l("Once per x Songs"),description:l("Play once every $x songs.")},{value:"once_per_x_minutes",text:l("Once per x Minutes"),description:l("Play once every $x minutes.")},{value:"once_per_hour",text:l("Once per Hour"),description:l("Play once per hour at the specified minute.")},{value:"custom",text:l("Advanced"),description:l("Manually define how this playlist is used in Liquidsoap configuration.")}],i=[{value:"shuffle",text:l("Shuffled"),description:l("The full playlist is shuffled and then played through in the shuffled order.")},{value:"random",text:l("Random"),description:l("A completely random track is picked for playback every time the queue is populated.")},{value:"sequential",text:l("Sequential"),description:l("The order of the playlist is manually specified and followed by the AutoDJ.")}];l("Icecast/Shoutcast Stream URL"),l("Playlist (M3U/PLS) URL"),l("Other Remote URL (File, HLS, etc.)");const c=Mt.map(Mt.range(1,26),r=>({value:r,text:String(r)}));return(r,f)=>(_(),me(Bt,{label:s(l)("Basic Info"),"item-header-class":s(n)},{default:A(()=>[p("div",yn,[w(Ae,{id:"form_edit_name",class:"col-md-6",field:s(t).name,label:s(l)("Playlist Name")},null,8,["field","label"]),w(Rt,{id:"form_edit_is_enabled",class:"col-md-6",field:s(t).is_enabled,label:s(l)("Enable"),description:s(l)("If disabled, the playlist will not be included in radio playback, but can still be managed.")},null,8,["field","label","description"])]),Lt(p("section",wn,[p("div",Sn,[p("h2",kn,m(s(l)("Song-Based Playlist")),1)]),p("div",xn,[p("div",Cn,[w(rt,{id:"edit_form_type",class:"col-md-6",field:s(t).type,options:a,stacked:"",radio:"",label:s(l)("Playlist Type")},{description:A(()=>[p("a",$n,m(s(l)("Learn about Advanced Playlists")),1)]),_:1},8,["field","label"]),w(rt,{id:"edit_form_order",class:"col-md-6",field:s(t).order,options:i,stacked:"",radio:"",label:s(l)("Song Playback Order")},null,8,["field","label"])]),Lt(w(Vo,null,{label:A(()=>[W(m(s(l)("General Rotation")),1)]),default:A(()=>[p("div",Dn,[w(zo,{id:"form_edit_weight",class:"col-md-12",field:s(t).weight,options:s(c),label:s(l)("Playlist Weight"),description:s(l)("Higher weight playlists are played more frequently compared to other lower-weight playlists.")},null,8,["field","options","label","description"])])]),_:1},512),[[qt,o.value.type==="default"]])])],512),[[qt,o.value.source==="songs"]])]),_:1},8,["label","item-header-class"]))}}),Tn={class:"card mb-3"},Mn={class:"card-header text-bg-primary d-flex align-items-center"},On={class:"flex-fill"},Pn={class:"card-title"},In={class:"flex-shrink-0"},An={class:"card-body"},Nn={class:"row g-3"},Rn=be({__name:"ScheduleRow",props:{index:{},row:{}},emits:["remove"],setup(e,{emit:o}){const t=e,n=o,l=Wo({start_time:{required:st},end_time:{required:st},start_date:{},end_date:{},days:{},loop_once:{}},Ho(t,"row")),{$gettext:a}=Ce(),i=[{value:1,text:a("Monday")},{value:2,text:a("Tuesday")},{value:3,text:a("Wednesday")},{value:4,text:a("Thursday")},{value:5,text:a("Friday")},{value:6,text:a("Saturday")},{value:7,text:a("Sunday")}],c=()=>{n("remove")};return(r,f)=>(_(),T("section",Tn,[p("div",Mn,[p("div",On,[p("h2",Pn,m(s(a)("Scheduled Time #%{num}",{num:r.index+1})),1)]),p("div",In,[p("button",{type:"button",class:"btn btn-sm btn-dark",onClick:f[0]||(f[0]=u=>c())},[w(Te,{icon:s(Qo)},null,8,["icon"]),p("span",null,m(s(a)("Remove")),1)])])]),p("div",An,[p("div",Nn,[w(Ae,{id:"edit_form_start_time_"+r.index,class:"col-md-4",field:s(l).start_time,label:s(a)("Start Time"),description:s(a)("To play once per day, set the start and end times to the same value.")},{default:A(({id:u,model:d,fieldClass:g})=>[w(jt,{id:u,modelValue:d.$model,"onUpdate:modelValue":v=>d.$model=v,class:Tt(g)},null,8,["id","modelValue","onUpdate:modelValue","class"])]),_:1},8,["id","field","label","description"]),w(Ae,{id:"edit_form_end_time_"+r.index,class:"col-md-4",field:s(l).end_time,label:s(a)("End Time"),description:s(a)("If the end time is before the start time, the playlist will play overnight.")},{default:A(({id:u,model:d,fieldClass:g})=>[w(jt,{id:u,modelValue:d.$model,"onUpdate:modelValue":v=>d.$model=v,class:Tt(g)},null,8,["id","modelValue","onUpdate:modelValue","class"])]),_:1},8,["id","field","label","description"]),w(Ft,{id:"station_time_zone",class:"col-md-4",label:s(a)("Station Time Zone")},{default:A(()=>[w(go)]),_:1},8,["label"]),w(Ae,{id:"edit_form_start_date_"+r.index,class:"col-md-4",field:s(l).start_date,"input-type":"date",label:s(a)("Start Date"),description:s(a)("To set this schedule to run only within a certain date range, specify a start and end date.")},null,8,["id","field","label","description"]),w(Ae,{id:"edit_form_end_date_"+r.index,class:"col-md-4",field:s(l).end_date,"input-type":"date",label:s(a)("End Date")},null,8,["id","field","label"]),w(Rt,{id:"edit_form_loop_once_"+r.index,class:"col-md-4",field:s(l).loop_once,label:s(a)("Loop Once"),description:s(a)("Only loop through playlist once.")},null,8,["id","field","label","description"]),w(rt,{id:"edit_form_days_"+r.index,class:"col-md-4",field:s(l).days,label:s(a)("Scheduled Play Days of Week"),description:s(a)("Leave blank to play on every day of the week."),options:i,stacked:""},null,8,["id","field","label","description"])])])]))}}),Bn={class:"buttons"},Fn=be({__name:"Schedule",props:{scheduleItems:{default:()=>[]},scheduleItemsModifiers:{}},emits:["update:scheduleItems"],setup(e){const o=ho(e,"scheduleItems"),t=()=>{o.value.push({start_time:null,end_time:null,start_date:null,end_date:null,days:[],loop_once:!1})},n=l=>{o.value.splice(l,1)};return(l,a)=>(_(),me(Bt,{label:l.$gettext("Schedule")},{default:A(()=>[o.value.length===0?(_(),me(Ft,{key:0,id:"no_scheduled_entries"},{label:A(()=>[W(m(l.$gettext("Not Scheduled")),1)]),default:A(()=>[p("p",null,m(l.$gettext("This playlist currently has no scheduled times. It will play at all times. To add a new scheduled time, click the button below.")),1)]),_:1})):ee("",!0),(_(!0),T(Q,null,ze(o.value,(i,c)=>(_(),me(Rn,{key:c,row:o.value[c],"onUpdate:row":r=>o.value[c]=r,index:c,onRemove:r=>n(c)},null,8,["row","onUpdate:row","index","onRemove"]))),128)),p("div",Bn,[p("button",{type:"button",class:"btn btn-sm btn-primary",onClick:t},[w(Te,{icon:s(en)},null,8,["icon"]),p("span",null,m(l.$gettext("Add Schedule Item")),1)])])]),_:1},8,["label"]))}}),Un=be({__name:"EditModal",props:{createUrl:{}},emits:["relist","needs-restart"],setup(e,{expose:o,emit:t}){const n=e,l=t,{enableAdvancedFeatures:a}=Go(),i=ae("$modal"),{notifySuccess:c}=Me(),{loading:r,error:f,isEditMode:u,form:d,v$:g,clearContents:v,create:O,edit:C,doSubmit:B,close:F}=sn(n,l,i,{schedule_items:{}},{schedule_items:[]},{onSubmitSuccess:()=>{c(),l("relist"),l("needs-restart"),F()}}),{$gettext:M}=Ce(),P=Yo(()=>u.value?M("Edit Playlist"):M("Add Playlist"));return o({create:O,edit:C,close:F}),(D,E)=>(_(),me(bo,{ref_key:"$modal",ref:i,loading:s(r),title:P.value,error:s(f),"disable-save-button":s(g).$invalid,onSubmit:s(B),onHidden:s(v)},{default:A(()=>[w(vo,null,{default:A(()=>[w(En,{form:s(d),"onUpdate:form":E[0]||(E[0]=Y=>tt(d)?d.value=Y:null)},null,8,["form"]),w(Fn,{"schedule-items":s(d).schedule_items,"onUpdate:scheduleItems":E[1]||(E[1]=Y=>s(d).schedule_items=Y)},null,8,["schedule-items"])]),_:1})]),_:1},8,["loading","title","error","disable-save-button","onSubmit","onHidden"]))}});var Hn=Object.defineProperty,ct=Object.getOwnPropertySymbols,yo=Object.prototype.hasOwnProperty,wo=Object.prototype.propertyIsEnumerable,zt=(e,o,t)=>o in e?Hn(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,So=(e,o)=>{for(var t in o||(o={}))yo.call(o,t)&&zt(e,t,o[t]);if(ct)for(var t of ct(o))wo.call(o,t)&&zt(e,t,o[t]);return e},Yn=(e,o)=>{var t={};for(var n in e)yo.call(e,n)&&o.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&ct)for(var n of ct(e))o.indexOf(n)<0&&wo.call(e,n)&&(t[n]=e[n]);return t};const ko="[vue-draggable-plus]: ";function Xn(e){console.warn(ko+e)}function Ln(e){console.error(ko+e)}function Gt(e,o,t){return t>=0&&t<e.length&&e.splice(t,0,e.splice(o,1)[0]),e}function Jt(e,o){return Array.isArray(e)&&e.splice(o,1),e}function Zt(e,o,t){return Array.isArray(e)&&e.splice(o,0,t),e}function qn(e){return typeof e>"u"}function jn(e){return typeof e=="string"}function Kt(e,o,t){const n=e.children[t];e.insertBefore(o,n)}function _t(e){e.parentNode&&e.parentNode.removeChild(e)}function Wn(e,o=document){var t;let n=null;return typeof(o==null?void 0:o.querySelector)=="function"?n=(t=o==null?void 0:o.querySelector)==null?void 0:t.call(o,e):n=document.querySelector(e),n||Xn(`Element not found: ${e}`),n}function Vn(e,o,t=null){return function(...n){return e.apply(t,n),o.apply(t,n)}}function zn(e,o){const t=So({},e);return Object.keys(o).forEach(n=>{t[n]?t[n]=Vn(e[n],o[n]):t[n]=o[n]}),t}function Gn(e){return e instanceof HTMLElement}function Qt(e,o){Object.keys(e).forEach(t=>{o(t,e[t])})}function Jn(e){return e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97)}const Zn=Object.assign;/**!
 * Sortable 1.15.2
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function eo(e,o){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);o&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),t.push.apply(t,n)}return t}function ge(e){for(var o=1;o<arguments.length;o++){var t=arguments[o]!=null?arguments[o]:{};o%2?eo(Object(t),!0).forEach(function(n){Kn(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):eo(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function ot(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ot=function(o){return typeof o}:ot=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},ot(e)}function Kn(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}function ye(){return ye=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},ye.apply(this,arguments)}function Qn(e,o){if(e==null)return{};var t={},n=Object.keys(e),l,a;for(a=0;a<n.length;a++)l=n[a],!(o.indexOf(l)>=0)&&(t[l]=e[l]);return t}function el(e,o){if(e==null)return{};var t=Qn(e,o),n,l;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(l=0;l<a.length;l++)n=a[l],!(o.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(t[n]=e[n])}return t}var tl="1.15.2";function _e(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var we=_e(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Ge=_e(/Edge/i),to=_e(/firefox/i),Le=_e(/safari/i)&&!_e(/chrome/i)&&!_e(/android/i),xo=_e(/iP(ad|od|hone)/i),Co=_e(/chrome/i)&&_e(/android/i),$o={capture:!1,passive:!1};function U(e,o,t){e.addEventListener(o,t,!we&&$o)}function N(e,o,t){e.removeEventListener(o,t,!we&&$o)}function dt(e,o){if(o){if(o[0]===">"&&(o=o.substring(1)),e)try{if(e.matches)return e.matches(o);if(e.msMatchesSelector)return e.msMatchesSelector(o);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(o)}catch{return!1}return!1}}function ol(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function he(e,o,t,n){if(e){t=t||document;do{if(o!=null&&(o[0]===">"?e.parentNode===t&&dt(e,o):dt(e,o))||n&&e===t)return e;if(e===t)break}while(e=ol(e))}return null}var oo=/\s+/g;function ce(e,o,t){if(e&&o)if(e.classList)e.classList[t?"add":"remove"](o);else{var n=(" "+e.className+" ").replace(oo," ").replace(" "+o+" "," ");e.className=(n+(t?" "+o:"")).replace(oo," ")}}function k(e,o,t){var n=e&&e.style;if(n){if(t===void 0)return document.defaultView&&document.defaultView.getComputedStyle?t=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(t=e.currentStyle),o===void 0?t:t[o];!(o in n)&&o.indexOf("webkit")===-1&&(o="-webkit-"+o),n[o]=t+(typeof t=="string"?"":"px")}}function Re(e,o){var t="";if(typeof e=="string")t=e;else do{var n=k(e,"transform");n&&n!=="none"&&(t=n+" "+t)}while(!o&&(e=e.parentNode));var l=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return l&&new l(t)}function Do(e,o,t){if(e){var n=e.getElementsByTagName(o),l=0,a=n.length;if(t)for(;l<a;l++)t(n[l],l);return n}return[]}function ve(){var e=document.scrollingElement;return e||document.documentElement}function Z(e,o,t,n,l){if(!(!e.getBoundingClientRect&&e!==window)){var a,i,c,r,f,u,d;if(e!==window&&e.parentNode&&e!==ve()?(a=e.getBoundingClientRect(),i=a.top,c=a.left,r=a.bottom,f=a.right,u=a.height,d=a.width):(i=0,c=0,r=window.innerHeight,f=window.innerWidth,u=window.innerHeight,d=window.innerWidth),(o||t)&&e!==window&&(l=l||e.parentNode,!we))do if(l&&l.getBoundingClientRect&&(k(l,"transform")!=="none"||t&&k(l,"position")!=="static")){var g=l.getBoundingClientRect();i-=g.top+parseInt(k(l,"border-top-width")),c-=g.left+parseInt(k(l,"border-left-width")),r=i+a.height,f=c+a.width;break}while(l=l.parentNode);if(n&&e!==window){var v=Re(l||e),O=v&&v.a,C=v&&v.d;v&&(i/=C,c/=O,d/=O,u/=C,r=i+u,f=c+d)}return{top:i,left:c,bottom:r,right:f,width:d,height:u}}}function no(e,o,t){for(var n=xe(e,!0),l=Z(e)[o];n;){var a=Z(n)[t],i=void 0;if(i=l>=a,!i)return n;if(n===ve())break;n=xe(n,!1)}return!1}function Be(e,o,t,n){for(var l=0,a=0,i=e.children;a<i.length;){if(i[a].style.display!=="none"&&i[a]!==x.ghost&&(n||i[a]!==x.dragged)&&he(i[a],t.draggable,e,!1)){if(l===o)return i[a];l++}a++}return null}function Ut(e,o){for(var t=e.lastElementChild;t&&(t===x.ghost||k(t,"display")==="none"||o&&!dt(t,o));)t=t.previousElementSibling;return t||null}function pe(e,o){var t=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==x.clone&&(!o||dt(e,o))&&t++;return t}function lo(e){var o=0,t=0,n=ve();if(e)do{var l=Re(e),a=l.a,i=l.d;o+=e.scrollLeft*a,t+=e.scrollTop*i}while(e!==n&&(e=e.parentNode));return[o,t]}function nl(e,o){for(var t in e)if(e.hasOwnProperty(t)){for(var n in o)if(o.hasOwnProperty(n)&&o[n]===e[t][n])return Number(t)}return-1}function xe(e,o){if(!e||!e.getBoundingClientRect)return ve();var t=e,n=!1;do if(t.clientWidth<t.scrollWidth||t.clientHeight<t.scrollHeight){var l=k(t);if(t.clientWidth<t.scrollWidth&&(l.overflowX=="auto"||l.overflowX=="scroll")||t.clientHeight<t.scrollHeight&&(l.overflowY=="auto"||l.overflowY=="scroll")){if(!t.getBoundingClientRect||t===document.body)return ve();if(n||o)return t;n=!0}}while(t=t.parentNode);return ve()}function ll(e,o){if(e&&o)for(var t in o)o.hasOwnProperty(t)&&(e[t]=o[t]);return e}function yt(e,o){return Math.round(e.top)===Math.round(o.top)&&Math.round(e.left)===Math.round(o.left)&&Math.round(e.height)===Math.round(o.height)&&Math.round(e.width)===Math.round(o.width)}var qe;function Eo(e,o){return function(){if(!qe){var t=arguments,n=this;t.length===1?e.call(n,t[0]):e.apply(n,t),qe=setTimeout(function(){qe=void 0},o)}}}function al(){clearTimeout(qe),qe=void 0}function To(e,o,t){e.scrollLeft+=o,e.scrollTop+=t}function Mo(e){var o=window.Polymer,t=window.jQuery||window.Zepto;return o&&o.dom?o.dom(e).cloneNode(!0):t?t(e).clone(!0)[0]:e.cloneNode(!0)}function Oo(e,o,t){var n={};return Array.from(e.children).forEach(function(l){var a,i,c,r;if(!(!he(l,o.draggable,e,!1)||l.animated||l===t)){var f=Z(l);n.left=Math.min((a=n.left)!==null&&a!==void 0?a:1/0,f.left),n.top=Math.min((i=n.top)!==null&&i!==void 0?i:1/0,f.top),n.right=Math.max((c=n.right)!==null&&c!==void 0?c:-1/0,f.right),n.bottom=Math.max((r=n.bottom)!==null&&r!==void 0?r:-1/0,f.bottom)}}),n.width=n.right-n.left,n.height=n.bottom-n.top,n.x=n.left,n.y=n.top,n}var ue="Sortable"+new Date().getTime();function il(){var e=[],o;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var t=[].slice.call(this.el.children);t.forEach(function(n){if(!(k(n,"display")==="none"||n===x.ghost)){e.push({target:n,rect:Z(n)});var l=ge({},e[e.length-1].rect);if(n.thisAnimationDuration){var a=Re(n,!0);a&&(l.top-=a.f,l.left-=a.e)}n.fromRect=l}})}},addAnimationState:function(t){e.push(t)},removeAnimationState:function(t){e.splice(nl(e,{target:t}),1)},animateAll:function(t){var n=this;if(!this.options.animation){clearTimeout(o),typeof t=="function"&&t();return}var l=!1,a=0;e.forEach(function(i){var c=0,r=i.target,f=r.fromRect,u=Z(r),d=r.prevFromRect,g=r.prevToRect,v=i.rect,O=Re(r,!0);O&&(u.top-=O.f,u.left-=O.e),r.toRect=u,r.thisAnimationDuration&&yt(d,u)&&!yt(f,u)&&(v.top-u.top)/(v.left-u.left)===(f.top-u.top)/(f.left-u.left)&&(c=sl(v,d,g,n.options)),yt(u,f)||(r.prevFromRect=f,r.prevToRect=u,c||(c=n.options.animation),n.animate(r,v,u,c)),c&&(l=!0,a=Math.max(a,c),clearTimeout(r.animationResetTimer),r.animationResetTimer=setTimeout(function(){r.animationTime=0,r.prevFromRect=null,r.fromRect=null,r.prevToRect=null,r.thisAnimationDuration=null},c),r.thisAnimationDuration=c)}),clearTimeout(o),l?o=setTimeout(function(){typeof t=="function"&&t()},a):typeof t=="function"&&t(),e=[]},animate:function(t,n,l,a){if(a){k(t,"transition",""),k(t,"transform","");var i=Re(this.el),c=i&&i.a,r=i&&i.d,f=(n.left-l.left)/(c||1),u=(n.top-l.top)/(r||1);t.animatingX=!!f,t.animatingY=!!u,k(t,"transform","translate3d("+f+"px,"+u+"px,0)"),this.forRepaintDummy=rl(t),k(t,"transition","transform "+a+"ms"+(this.options.easing?" "+this.options.easing:"")),k(t,"transform","translate3d(0,0,0)"),typeof t.animated=="number"&&clearTimeout(t.animated),t.animated=setTimeout(function(){k(t,"transition",""),k(t,"transform",""),t.animated=!1,t.animatingX=!1,t.animatingY=!1},a)}}}}function rl(e){return e.offsetWidth}function sl(e,o,t,n){return Math.sqrt(Math.pow(o.top-e.top,2)+Math.pow(o.left-e.left,2))/Math.sqrt(Math.pow(o.top-t.top,2)+Math.pow(o.left-t.left,2))*n.animation}var Oe=[],wt={initializeByDefault:!0},Je={mount:function(e){for(var o in wt)wt.hasOwnProperty(o)&&!(o in e)&&(e[o]=wt[o]);Oe.forEach(function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),Oe.push(e)},pluginEvent:function(e,o,t){var n=this;this.eventCanceled=!1,t.cancel=function(){n.eventCanceled=!0};var l=e+"Global";Oe.forEach(function(a){o[a.pluginName]&&(o[a.pluginName][l]&&o[a.pluginName][l](ge({sortable:o},t)),o.options[a.pluginName]&&o[a.pluginName][e]&&o[a.pluginName][e](ge({sortable:o},t)))})},initializePlugins:function(e,o,t,n){Oe.forEach(function(i){var c=i.pluginName;if(!(!e.options[c]&&!i.initializeByDefault)){var r=new i(e,o,e.options);r.sortable=e,r.options=e.options,e[c]=r,ye(t,r.defaults)}});for(var l in e.options)if(e.options.hasOwnProperty(l)){var a=this.modifyOption(e,l,e.options[l]);typeof a<"u"&&(e.options[l]=a)}},getEventProperties:function(e,o){var t={};return Oe.forEach(function(n){typeof n.eventProperties=="function"&&ye(t,n.eventProperties.call(o[n.pluginName],e))}),t},modifyOption:function(e,o,t){var n;return Oe.forEach(function(l){e[l.pluginName]&&l.optionListeners&&typeof l.optionListeners[o]=="function"&&(n=l.optionListeners[o].call(e[l.pluginName],t))}),n}};function cl(e){var o=e.sortable,t=e.rootEl,n=e.name,l=e.targetEl,a=e.cloneEl,i=e.toEl,c=e.fromEl,r=e.oldIndex,f=e.newIndex,u=e.oldDraggableIndex,d=e.newDraggableIndex,g=e.originalEvent,v=e.putSortable,O=e.extraEventProperties;if(o=o||t&&t[ue],!!o){var C,B=o.options,F="on"+n.charAt(0).toUpperCase()+n.substr(1);window.CustomEvent&&!we&&!Ge?C=new CustomEvent(n,{bubbles:!0,cancelable:!0}):(C=document.createEvent("Event"),C.initEvent(n,!0,!0)),C.to=i||t,C.from=c||t,C.item=l||t,C.clone=a,C.oldIndex=r,C.newIndex=f,C.oldDraggableIndex=u,C.newDraggableIndex=d,C.originalEvent=g,C.pullMode=v?v.lastPutMode:void 0;var M=ge(ge({},O),Je.getEventProperties(n,o));for(var P in M)C[P]=M[P];t&&t.dispatchEvent(C),B[F]&&B[F].call(o,C)}}var dl=["evt"],re=function(e,o){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=t.evt,l=el(t,dl);Je.pluginEvent.bind(x)(e,o,ge({dragEl:h,parentEl:V,ghostEl:$,rootEl:L,nextEl:Ee,lastDownEl:nt,cloneEl:j,cloneHidden:ke,dragStarted:He,putSortable:K,activeSortable:x.active,originalEvent:n,oldIndex:Ne,oldDraggableIndex:je,newIndex:de,newDraggableIndex:Se,hideGhostForTarget:No,unhideGhostForTarget:Ro,cloneNowHidden:function(){ke=!0},cloneNowShown:function(){ke=!1},dispatchSortableEvent:function(a){le({sortable:o,name:a,originalEvent:n})}},l))};function le(e){cl(ge({putSortable:K,cloneEl:j,targetEl:h,rootEl:L,oldIndex:Ne,oldDraggableIndex:je,newIndex:de,newDraggableIndex:Se},e))}var h,V,$,L,Ee,nt,j,ke,Ne,de,je,Se,Ze,K,Ie=!1,ut=!1,pt=[],$e,fe,St,kt,ao,io,He,Pe,We,Ve=!1,Ke=!1,lt,ne,xt=[],Ot=!1,ft=[],gt=typeof document<"u",Qe=xo,ro=Ge||we?"cssFloat":"float",ul=gt&&!Co&&!xo&&"draggable"in document.createElement("div"),Po=function(){if(gt){if(we)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}}(),Io=function(e,o){var t=k(e),n=parseInt(t.width)-parseInt(t.paddingLeft)-parseInt(t.paddingRight)-parseInt(t.borderLeftWidth)-parseInt(t.borderRightWidth),l=Be(e,0,o),a=Be(e,1,o),i=l&&k(l),c=a&&k(a),r=i&&parseInt(i.marginLeft)+parseInt(i.marginRight)+Z(l).width,f=c&&parseInt(c.marginLeft)+parseInt(c.marginRight)+Z(a).width;if(t.display==="flex")return t.flexDirection==="column"||t.flexDirection==="column-reverse"?"vertical":"horizontal";if(t.display==="grid")return t.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(l&&i.float&&i.float!=="none"){var u=i.float==="left"?"left":"right";return a&&(c.clear==="both"||c.clear===u)?"vertical":"horizontal"}return l&&(i.display==="block"||i.display==="flex"||i.display==="table"||i.display==="grid"||r>=n&&t[ro]==="none"||a&&t[ro]==="none"&&r+f>n)?"vertical":"horizontal"},pl=function(e,o,t){var n=t?e.left:e.top,l=t?e.right:e.bottom,a=t?e.width:e.height,i=t?o.left:o.top,c=t?o.right:o.bottom,r=t?o.width:o.height;return n===i||l===c||n+a/2===i+r/2},fl=function(e,o){var t;return pt.some(function(n){var l=n[ue].options.emptyInsertThreshold;if(!(!l||Ut(n))){var a=Z(n),i=e>=a.left-l&&e<=a.right+l,c=o>=a.top-l&&o<=a.bottom+l;if(i&&c)return t=n}}),t},Ao=function(e){function o(l,a){return function(i,c,r,f){var u=i.options.group.name&&c.options.group.name&&i.options.group.name===c.options.group.name;if(l==null&&(a||u))return!0;if(l==null||l===!1)return!1;if(a&&l==="clone")return l;if(typeof l=="function")return o(l(i,c,r,f),a)(i,c,r,f);var d=(a?i:c).options.group.name;return l===!0||typeof l=="string"&&l===d||l.join&&l.indexOf(d)>-1}}var t={},n=e.group;(!n||ot(n)!="object")&&(n={name:n}),t.name=n.name,t.checkPull=o(n.pull,!0),t.checkPut=o(n.put),t.revertClone=n.revertClone,e.group=t},No=function(){!Po&&$&&k($,"display","none")},Ro=function(){!Po&&$&&k($,"display","")};gt&&!Co&&document.addEventListener("click",function(e){if(ut)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),ut=!1,!1},!0);var De=function(e){if(h){e=e.touches?e.touches[0]:e;var o=fl(e.clientX,e.clientY);if(o){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.target=t.rootEl=o,t.preventDefault=void 0,t.stopPropagation=void 0,o[ue]._onDragOver(t)}}},hl=function(e){h&&h.parentNode[ue]._isOutsideThisEl(e.target)};function x(e,o){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=o=ye({},o),e[ue]=this;var t={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Io(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(a,i){a.setData("Text",i.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:x.supportPointer!==!1&&"PointerEvent"in window&&!Le,emptyInsertThreshold:5};Je.initializePlugins(this,e,t);for(var n in t)!(n in o)&&(o[n]=t[n]);Ao(o);for(var l in this)l.charAt(0)==="_"&&typeof this[l]=="function"&&(this[l]=this[l].bind(this));this.nativeDraggable=o.forceFallback?!1:ul,this.nativeDraggable&&(this.options.touchStartThreshold=1),o.supportPointer?U(e,"pointerdown",this._onTapStart):(U(e,"mousedown",this._onTapStart),U(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(U(e,"dragover",this),U(e,"dragenter",this)),pt.push(this.el),o.store&&o.store.get&&this.sort(o.store.get(this)||[]),ye(this,il())}x.prototype={constructor:x,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(Pe=null)},_getDirection:function(e,o){return typeof this.options.direction=="function"?this.options.direction.call(this,e,o,h):this.options.direction},_onTapStart:function(e){if(e.cancelable){var o=this,t=this.el,n=this.options,l=n.preventOnFilter,a=e.type,i=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,c=(i||e).target,r=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||c,f=n.filter;if(Sl(t),!h&&!(/mousedown|pointerdown/.test(a)&&e.button!==0||n.disabled)&&!r.isContentEditable&&!(!this.nativeDraggable&&Le&&c&&c.tagName.toUpperCase()==="SELECT")&&(c=he(c,n.draggable,t,!1),!(c&&c.animated)&&nt!==c)){if(Ne=pe(c),je=pe(c,n.draggable),typeof f=="function"){if(f.call(this,e,c,this)){le({sortable:o,rootEl:r,name:"filter",targetEl:c,toEl:t,fromEl:t}),re("filter",o,{evt:e}),l&&e.cancelable&&e.preventDefault();return}}else if(f&&(f=f.split(",").some(function(u){if(u=he(r,u.trim(),t,!1),u)return le({sortable:o,rootEl:u,name:"filter",targetEl:c,fromEl:t,toEl:t}),re("filter",o,{evt:e}),!0}),f)){l&&e.cancelable&&e.preventDefault();return}n.handle&&!he(r,n.handle,t,!1)||this._prepareDragStart(e,i,c)}}},_prepareDragStart:function(e,o,t){var n=this,l=n.el,a=n.options,i=l.ownerDocument,c;if(t&&!h&&t.parentNode===l){var r=Z(t);if(L=l,h=t,V=h.parentNode,Ee=h.nextSibling,nt=t,Ze=a.group,x.dragged=h,$e={target:h,clientX:(o||e).clientX,clientY:(o||e).clientY},ao=$e.clientX-r.left,io=$e.clientY-r.top,this._lastX=(o||e).clientX,this._lastY=(o||e).clientY,h.style["will-change"]="all",c=function(){if(re("delayEnded",n,{evt:e}),x.eventCanceled){n._onDrop();return}n._disableDelayedDragEvents(),!to&&n.nativeDraggable&&(h.draggable=!0),n._triggerDragStart(e,o),le({sortable:n,name:"choose",originalEvent:e}),ce(h,a.chosenClass,!0)},a.ignore.split(",").forEach(function(f){Do(h,f.trim(),Ct)}),U(i,"dragover",De),U(i,"mousemove",De),U(i,"touchmove",De),U(i,"mouseup",n._onDrop),U(i,"touchend",n._onDrop),U(i,"touchcancel",n._onDrop),to&&this.nativeDraggable&&(this.options.touchStartThreshold=4,h.draggable=!0),re("delayStart",this,{evt:e}),a.delay&&(!a.delayOnTouchOnly||o)&&(!this.nativeDraggable||!(Ge||we))){if(x.eventCanceled){this._onDrop();return}U(i,"mouseup",n._disableDelayedDrag),U(i,"touchend",n._disableDelayedDrag),U(i,"touchcancel",n._disableDelayedDrag),U(i,"mousemove",n._delayedDragTouchMoveHandler),U(i,"touchmove",n._delayedDragTouchMoveHandler),a.supportPointer&&U(i,"pointermove",n._delayedDragTouchMoveHandler),n._dragStartTimer=setTimeout(c,a.delay)}else c()}},_delayedDragTouchMoveHandler:function(e){var o=e.touches?e.touches[0]:e;Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){h&&Ct(h),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;N(e,"mouseup",this._disableDelayedDrag),N(e,"touchend",this._disableDelayedDrag),N(e,"touchcancel",this._disableDelayedDrag),N(e,"mousemove",this._delayedDragTouchMoveHandler),N(e,"touchmove",this._delayedDragTouchMoveHandler),N(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,o){o=o||e.pointerType=="touch"&&e,!this.nativeDraggable||o?this.options.supportPointer?U(document,"pointermove",this._onTouchMove):o?U(document,"touchmove",this._onTouchMove):U(document,"mousemove",this._onTouchMove):(U(h,"dragend",this),U(L,"dragstart",this._onDragStart));try{document.selection?at(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,o){if(Ie=!1,L&&h){re("dragStarted",this,{evt:o}),this.nativeDraggable&&U(document,"dragover",hl);var t=this.options;!e&&ce(h,t.dragClass,!1),ce(h,t.ghostClass,!0),x.active=this,e&&this._appendGhost(),le({sortable:this,name:"start",originalEvent:o})}else this._nulling()},_emulateDragOver:function(){if(fe){this._lastX=fe.clientX,this._lastY=fe.clientY,No();for(var e=document.elementFromPoint(fe.clientX,fe.clientY),o=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(fe.clientX,fe.clientY),e!==o);)o=e;if(h.parentNode[ue]._isOutsideThisEl(e),o)do{if(o[ue]){var t=void 0;if(t=o[ue]._onDragOver({clientX:fe.clientX,clientY:fe.clientY,target:e,rootEl:o}),t&&!this.options.dragoverBubble)break}e=o}while(o=o.parentNode);Ro()}},_onTouchMove:function(e){if($e){var o=this.options,t=o.fallbackTolerance,n=o.fallbackOffset,l=e.touches?e.touches[0]:e,a=$&&Re($,!0),i=$&&a&&a.a,c=$&&a&&a.d,r=Qe&&ne&&lo(ne),f=(l.clientX-$e.clientX+n.x)/(i||1)+(r?r[0]-xt[0]:0)/(i||1),u=(l.clientY-$e.clientY+n.y)/(c||1)+(r?r[1]-xt[1]:0)/(c||1);if(!x.active&&!Ie){if(t&&Math.max(Math.abs(l.clientX-this._lastX),Math.abs(l.clientY-this._lastY))<t)return;this._onDragStart(e,!0)}if($){a?(a.e+=f-(St||0),a.f+=u-(kt||0)):a={a:1,b:0,c:0,d:1,e:f,f:u};var d="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");k($,"webkitTransform",d),k($,"mozTransform",d),k($,"msTransform",d),k($,"transform",d),St=f,kt=u,fe=l}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!$){var e=this.options.fallbackOnBody?document.body:L,o=Z(h,!0,Qe,!0,e),t=this.options;if(Qe){for(ne=e;k(ne,"position")==="static"&&k(ne,"transform")==="none"&&ne!==document;)ne=ne.parentNode;ne!==document.body&&ne!==document.documentElement?(ne===document&&(ne=ve()),o.top+=ne.scrollTop,o.left+=ne.scrollLeft):ne=ve(),xt=lo(ne)}$=h.cloneNode(!0),ce($,t.ghostClass,!1),ce($,t.fallbackClass,!0),ce($,t.dragClass,!0),k($,"transition",""),k($,"transform",""),k($,"box-sizing","border-box"),k($,"margin",0),k($,"top",o.top),k($,"left",o.left),k($,"width",o.width),k($,"height",o.height),k($,"opacity","0.8"),k($,"position",Qe?"absolute":"fixed"),k($,"zIndex","100000"),k($,"pointerEvents","none"),x.ghost=$,e.appendChild($),k($,"transform-origin",ao/parseInt($.style.width)*100+"% "+io/parseInt($.style.height)*100+"%")}},_onDragStart:function(e,o){var t=this,n=e.dataTransfer,l=t.options;if(re("dragStart",this,{evt:e}),x.eventCanceled){this._onDrop();return}re("setupClone",this),x.eventCanceled||(j=Mo(h),j.removeAttribute("id"),j.draggable=!1,j.style["will-change"]="",this._hideClone(),ce(j,this.options.chosenClass,!1),x.clone=j),t.cloneId=at(function(){re("clone",t),!x.eventCanceled&&(t.options.removeCloneOnHide||L.insertBefore(j,h),t._hideClone(),le({sortable:t,name:"clone"}))}),!o&&ce(h,l.dragClass,!0),o?(ut=!0,t._loopId=setInterval(t._emulateDragOver,50)):(N(document,"mouseup",t._onDrop),N(document,"touchend",t._onDrop),N(document,"touchcancel",t._onDrop),n&&(n.effectAllowed="move",l.setData&&l.setData.call(t,n,h)),U(document,"drop",t),k(h,"transform","translateZ(0)")),Ie=!0,t._dragStartId=at(t._dragStarted.bind(t,o,e)),U(document,"selectstart",t),He=!0,Le&&k(document.body,"user-select","none")},_onDragOver:function(e){var o=this.el,t=e.target,n,l,a,i=this.options,c=i.group,r=x.active,f=Ze===c,u=i.sort,d=K||r,g,v=this,O=!1;if(Ot)return;function C(ie,y){re(ie,v,ge({evt:e,isOwner:f,axis:g?"vertical":"horizontal",revert:a,dragRect:n,targetRect:l,canSort:u,fromSortable:d,target:t,completed:F,onMove:function(oe,bt){return et(L,o,h,n,oe,Z(oe),e,bt)},changed:M},y))}function B(){C("dragOverAnimationCapture"),v.captureAnimationState(),v!==d&&d.captureAnimationState()}function F(ie){return C("dragOverCompleted",{insertion:ie}),ie&&(f?r._hideClone():r._showClone(v),v!==d&&(ce(h,K?K.options.ghostClass:r.options.ghostClass,!1),ce(h,i.ghostClass,!0)),K!==v&&v!==x.active?K=v:v===x.active&&K&&(K=null),d===v&&(v._ignoreWhileAnimating=t),v.animateAll(function(){C("dragOverAnimationComplete"),v._ignoreWhileAnimating=null}),v!==d&&(d.animateAll(),d._ignoreWhileAnimating=null)),(t===h&&!h.animated||t===o&&!t.animated)&&(Pe=null),!i.dragoverBubble&&!e.rootEl&&t!==document&&(h.parentNode[ue]._isOutsideThisEl(e.target),!ie&&De(e)),!i.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),O=!0}function M(){de=pe(h),Se=pe(h,i.draggable),le({sortable:v,name:"change",toEl:o,newIndex:de,newDraggableIndex:Se,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),t=he(t,i.draggable,o,!0),C("dragOver"),x.eventCanceled)return O;if(h.contains(e.target)||t.animated&&t.animatingX&&t.animatingY||v._ignoreWhileAnimating===t)return F(!1);if(ut=!1,r&&!i.disabled&&(f?u||(a=V!==L):K===this||(this.lastPutMode=Ze.checkPull(this,r,h,e))&&c.checkPut(this,r,h,e))){if(g=this._getDirection(e,t)==="vertical",n=Z(h),C("dragOverValid"),x.eventCanceled)return O;if(a)return V=L,B(),this._hideClone(),C("revert"),x.eventCanceled||(Ee?L.insertBefore(h,Ee):L.appendChild(h)),F(!0);var P=Ut(o,i.draggable);if(!P||bl(e,g,this)&&!P.animated){if(P===h)return F(!1);if(P&&o===e.target&&(t=P),t&&(l=Z(t)),et(L,o,h,n,t,l,e,!!t)!==!1)return B(),P&&P.nextSibling?o.insertBefore(h,P.nextSibling):o.appendChild(h),V=o,M(),F(!0)}else if(P&&gl(e,g,this)){var D=Be(o,0,i,!0);if(D===h)return F(!1);if(t=D,l=Z(t),et(L,o,h,n,t,l,e,!1)!==!1)return B(),o.insertBefore(h,D),V=o,M(),F(!0)}else if(t.parentNode===o){l=Z(t);var E=0,Y,z=h.parentNode!==o,b=!pl(h.animated&&h.toRect||n,t.animated&&t.toRect||l,g),S=g?"top":"left",X=no(t,"top","top")||no(h,"top","top"),te=X?X.scrollTop:void 0;Pe!==t&&(Y=l[S],Ve=!1,Ke=!b&&i.invertSwap||z),E=_l(e,t,l,g,b?1:i.swapThreshold,i.invertedSwapThreshold==null?i.swapThreshold:i.invertedSwapThreshold,Ke,Pe===t);var H;if(E!==0){var q=pe(h);do q-=E,H=V.children[q];while(H&&(k(H,"display")==="none"||H===$))}if(E===0||H===t)return F(!1);Pe=t,We=E;var G=t.nextElementSibling,I=!1;I=E===1;var R=et(L,o,h,n,t,l,e,I);if(R!==!1)return(R===1||R===-1)&&(I=R===1),Ot=!0,setTimeout(vl,30),B(),I&&!G?o.appendChild(h):t.parentNode.insertBefore(h,I?G:t),X&&To(X,0,te-X.scrollTop),V=h.parentNode,Y!==void 0&&!Ke&&(lt=Math.abs(Y-Z(t)[S])),M(),F(!0)}if(o.contains(h))return F(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){N(document,"mousemove",this._onTouchMove),N(document,"touchmove",this._onTouchMove),N(document,"pointermove",this._onTouchMove),N(document,"dragover",De),N(document,"mousemove",De),N(document,"touchmove",De)},_offUpEvents:function(){var e=this.el.ownerDocument;N(e,"mouseup",this._onDrop),N(e,"touchend",this._onDrop),N(e,"pointerup",this._onDrop),N(e,"touchcancel",this._onDrop),N(document,"selectstart",this)},_onDrop:function(e){var o=this.el,t=this.options;if(de=pe(h),Se=pe(h,t.draggable),re("drop",this,{evt:e}),V=h&&h.parentNode,de=pe(h),Se=pe(h,t.draggable),x.eventCanceled){this._nulling();return}Ie=!1,Ke=!1,Ve=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Pt(this.cloneId),Pt(this._dragStartId),this.nativeDraggable&&(N(document,"drop",this),N(o,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Le&&k(document.body,"user-select",""),k(h,"transform",""),e&&(He&&(e.cancelable&&e.preventDefault(),!t.dropBubble&&e.stopPropagation()),$&&$.parentNode&&$.parentNode.removeChild($),(L===V||K&&K.lastPutMode!=="clone")&&j&&j.parentNode&&j.parentNode.removeChild(j),h&&(this.nativeDraggable&&N(h,"dragend",this),Ct(h),h.style["will-change"]="",He&&!Ie&&ce(h,K?K.options.ghostClass:this.options.ghostClass,!1),ce(h,this.options.chosenClass,!1),le({sortable:this,name:"unchoose",toEl:V,newIndex:null,newDraggableIndex:null,originalEvent:e}),L!==V?(de>=0&&(le({rootEl:V,name:"add",toEl:V,fromEl:L,originalEvent:e}),le({sortable:this,name:"remove",toEl:V,originalEvent:e}),le({rootEl:V,name:"sort",toEl:V,fromEl:L,originalEvent:e}),le({sortable:this,name:"sort",toEl:V,originalEvent:e})),K&&K.save()):de!==Ne&&de>=0&&(le({sortable:this,name:"update",toEl:V,originalEvent:e}),le({sortable:this,name:"sort",toEl:V,originalEvent:e})),x.active&&((de==null||de===-1)&&(de=Ne,Se=je),le({sortable:this,name:"end",toEl:V,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){re("nulling",this),L=h=V=$=Ee=j=nt=ke=$e=fe=He=de=Se=Ne=je=Pe=We=K=Ze=x.dragged=x.ghost=x.clone=x.active=null,ft.forEach(function(e){e.checked=!0}),ft.length=St=kt=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":h&&(this._onDragOver(e),ml(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],o,t=this.el.children,n=0,l=t.length,a=this.options;n<l;n++)o=t[n],he(o,a.draggable,this.el,!1)&&e.push(o.getAttribute(a.dataIdAttr)||wl(o));return e},sort:function(e,o){var t={},n=this.el;this.toArray().forEach(function(l,a){var i=n.children[a];he(i,this.options.draggable,n,!1)&&(t[l]=i)},this),o&&this.captureAnimationState(),e.forEach(function(l){t[l]&&(n.removeChild(t[l]),n.appendChild(t[l]))}),o&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,o){return he(e,o||this.options.draggable,this.el,!1)},option:function(e,o){var t=this.options;if(o===void 0)return t[e];var n=Je.modifyOption(this,e,o);typeof n<"u"?t[e]=n:t[e]=o,e==="group"&&Ao(t)},destroy:function(){re("destroy",this);var e=this.el;e[ue]=null,N(e,"mousedown",this._onTapStart),N(e,"touchstart",this._onTapStart),N(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(N(e,"dragover",this),N(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(o){o.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),pt.splice(pt.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!ke){if(re("hideClone",this),x.eventCanceled)return;k(j,"display","none"),this.options.removeCloneOnHide&&j.parentNode&&j.parentNode.removeChild(j),ke=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(ke){if(re("showClone",this),x.eventCanceled)return;h.parentNode==L&&!this.options.group.revertClone?L.insertBefore(j,h):Ee?L.insertBefore(j,Ee):L.appendChild(j),this.options.group.revertClone&&this.animate(h,j),k(j,"display",""),ke=!1}}};function ml(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function et(e,o,t,n,l,a,i,c){var r,f=e[ue],u=f.options.onMove,d;return window.CustomEvent&&!we&&!Ge?r=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(r=document.createEvent("Event"),r.initEvent("move",!0,!0)),r.to=o,r.from=e,r.dragged=t,r.draggedRect=n,r.related=l||o,r.relatedRect=a||Z(o),r.willInsertAfter=c,r.originalEvent=i,e.dispatchEvent(r),u&&(d=u.call(f,r,i)),d}function Ct(e){e.draggable=!1}function vl(){Ot=!1}function gl(e,o,t){var n=Z(Be(t.el,0,t.options,!0)),l=Oo(t.el,t.options,$),a=10;return o?e.clientX<l.left-a||e.clientY<n.top&&e.clientX<n.right:e.clientY<l.top-a||e.clientY<n.bottom&&e.clientX<n.left}function bl(e,o,t){var n=Z(Ut(t.el,t.options.draggable)),l=Oo(t.el,t.options,$),a=10;return o?e.clientX>l.right+a||e.clientY>n.bottom&&e.clientX>n.left:e.clientY>l.bottom+a||e.clientX>n.right&&e.clientY>n.top}function _l(e,o,t,n,l,a,i,c){var r=n?e.clientY:e.clientX,f=n?t.height:t.width,u=n?t.top:t.left,d=n?t.bottom:t.right,g=!1;if(!i){if(c&&lt<f*l){if(!Ve&&(We===1?r>u+f*a/2:r<d-f*a/2)&&(Ve=!0),Ve)g=!0;else if(We===1?r<u+lt:r>d-lt)return-We}else if(r>u+f*(1-l)/2&&r<d-f*(1-l)/2)return yl(o)}return g=g||i,g&&(r<u+f*a/2||r>d-f*a/2)?r>u+f/2?1:-1:0}function yl(e){return pe(h)<pe(e)?1:-1}function wl(e){for(var o=e.tagName+e.className+e.src+e.href+e.textContent,t=o.length,n=0;t--;)n+=o.charCodeAt(t);return n.toString(36)}function Sl(e){ft.length=0;for(var o=e.getElementsByTagName("input"),t=o.length;t--;){var n=o[t];n.checked&&ft.push(n)}}function at(e){return setTimeout(e,0)}function Pt(e){return clearTimeout(e)}gt&&U(document,"touchmove",function(e){(x.active||Ie)&&e.cancelable&&e.preventDefault()});x.utils={on:U,off:N,css:k,find:Do,is:function(e,o){return!!he(e,o,e,!1)},extend:ll,throttle:Eo,closest:he,toggleClass:ce,clone:Mo,index:pe,nextTick:at,cancelNextTick:Pt,detectDirection:Io,getChild:Be};x.get=function(e){return e[ue]};x.mount=function(){for(var e=arguments.length,o=new Array(e),t=0;t<e;t++)o[t]=arguments[t];o[0].constructor===Array&&(o=o[0]),o.forEach(function(n){if(!n.prototype||!n.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(n));n.utils&&(x.utils=ge(ge({},x.utils),n.utils)),Je.mount(n)})};x.create=function(e,o){return new x(e,o)};x.version=tl;var J=[],Ye,It,At=!1,$t,Dt,ht,Xe;function kl(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var o in this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this))}return e.prototype={dragStarted:function(o){var t=o.originalEvent;this.sortable.nativeDraggable?U(document,"dragover",this._handleAutoScroll):this.options.supportPointer?U(document,"pointermove",this._handleFallbackAutoScroll):t.touches?U(document,"touchmove",this._handleFallbackAutoScroll):U(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(o){var t=o.originalEvent;!this.options.dragOverBubble&&!t.rootEl&&this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?N(document,"dragover",this._handleAutoScroll):(N(document,"pointermove",this._handleFallbackAutoScroll),N(document,"touchmove",this._handleFallbackAutoScroll),N(document,"mousemove",this._handleFallbackAutoScroll)),so(),it(),al()},nulling:function(){ht=It=Ye=At=Xe=$t=Dt=null,J.length=0},_handleFallbackAutoScroll:function(o){this._handleAutoScroll(o,!0)},_handleAutoScroll:function(o,t){var n=this,l=(o.touches?o.touches[0]:o).clientX,a=(o.touches?o.touches[0]:o).clientY,i=document.elementFromPoint(l,a);if(ht=o,t||this.options.forceAutoScrollFallback||Ge||we||Le){Et(o,this.options,i,t);var c=xe(i,!0);At&&(!Xe||l!==$t||a!==Dt)&&(Xe&&so(),Xe=setInterval(function(){var r=xe(document.elementFromPoint(l,a),!0);r!==c&&(c=r,it()),Et(o,n.options,r,t)},10),$t=l,Dt=a)}else{if(!this.options.bubbleScroll||xe(i,!0)===ve()){it();return}Et(o,this.options,xe(i,!1),!1)}}},ye(e,{pluginName:"scroll",initializeByDefault:!0})}function it(){J.forEach(function(e){clearInterval(e.pid)}),J=[]}function so(){clearInterval(Xe)}var Et=Eo(function(e,o,t,n){if(o.scroll){var l=(e.touches?e.touches[0]:e).clientX,a=(e.touches?e.touches[0]:e).clientY,i=o.scrollSensitivity,c=o.scrollSpeed,r=ve(),f=!1,u;It!==t&&(It=t,it(),Ye=o.scroll,u=o.scrollFn,Ye===!0&&(Ye=xe(t,!0)));var d=0,g=Ye;do{var v=g,O=Z(v),C=O.top,B=O.bottom,F=O.left,M=O.right,P=O.width,D=O.height,E=void 0,Y=void 0,z=v.scrollWidth,b=v.scrollHeight,S=k(v),X=v.scrollLeft,te=v.scrollTop;v===r?(E=P<z&&(S.overflowX==="auto"||S.overflowX==="scroll"||S.overflowX==="visible"),Y=D<b&&(S.overflowY==="auto"||S.overflowY==="scroll"||S.overflowY==="visible")):(E=P<z&&(S.overflowX==="auto"||S.overflowX==="scroll"),Y=D<b&&(S.overflowY==="auto"||S.overflowY==="scroll"));var H=E&&(Math.abs(M-l)<=i&&X+P<z)-(Math.abs(F-l)<=i&&!!X),q=Y&&(Math.abs(B-a)<=i&&te+D<b)-(Math.abs(C-a)<=i&&!!te);if(!J[d])for(var G=0;G<=d;G++)J[G]||(J[G]={});(J[d].vx!=H||J[d].vy!=q||J[d].el!==v)&&(J[d].el=v,J[d].vx=H,J[d].vy=q,clearInterval(J[d].pid),(H!=0||q!=0)&&(f=!0,J[d].pid=setInterval((function(){n&&this.layer===0&&x.active._onTouchMove(ht);var I=J[this.layer].vy?J[this.layer].vy*c:0,R=J[this.layer].vx?J[this.layer].vx*c:0;typeof u=="function"&&u.call(x.dragged.parentNode[ue],R,I,e,ht,J[this.layer].el)!=="continue"||To(J[this.layer].el,R,I)}).bind({layer:d}),24))),d++}while(o.bubbleScroll&&g!==r&&(g=xe(g,!1)));At=f}},30),Bo=function(e){var o=e.originalEvent,t=e.putSortable,n=e.dragEl,l=e.activeSortable,a=e.dispatchSortableEvent,i=e.hideGhostForTarget,c=e.unhideGhostForTarget;if(o){var r=t||l;i();var f=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:o,u=document.elementFromPoint(f.clientX,f.clientY);c(),r&&!r.el.contains(u)&&(a("spill"),this.onSpill({dragEl:n,putSortable:t}))}};function Ht(){}Ht.prototype={startIndex:null,dragStart:function(e){var o=e.oldDraggableIndex;this.startIndex=o},onSpill:function(e){var o=e.dragEl,t=e.putSortable;this.sortable.captureAnimationState(),t&&t.captureAnimationState();var n=Be(this.sortable.el,this.startIndex,this.options);n?this.sortable.el.insertBefore(o,n):this.sortable.el.appendChild(o),this.sortable.animateAll(),t&&t.animateAll()},drop:Bo};ye(Ht,{pluginName:"revertOnSpill"});function Yt(){}Yt.prototype={onSpill:function(e){var o=e.dragEl,t=e.putSortable,n=t||this.sortable;n.captureAnimationState(),o.parentNode&&o.parentNode.removeChild(o),n.animateAll()},drop:Bo};ye(Yt,{pluginName:"removeOnSpill"});x.mount(new kl);x.mount(Yt,Ht);function xl(e){return e==null?e:JSON.parse(JSON.stringify(e))}function Cl(e){Nt()&&qo(e)}function $l(e){Nt()?Lo(e):mo(e)}let Fo=null,Uo=null;function co(e=null,o=null){Fo=e,Uo=o}function Dl(){return{data:Fo,clonedData:Uo}}const uo=Symbol("cloneElement");function El(...e){var o,t;const n=(o=Nt())==null?void 0:o.proxy;let l=null;const a=e[0];let[,i,c]=e;Array.isArray(s(i))||(c=i,i=null);let r=null;const{immediate:f=!0,clone:u=xl,customUpdate:d}=(t=s(c))!=null?t:{};function g(b){var S;const{from:X,oldIndex:te,item:H}=b;l=Array.from(X.childNodes);const q=s((S=s(i))==null?void 0:S[te]),G=u(q);co(q,G),H[uo]=G}function v(b){const S=b.item[uo];if(!qn(S)){if(_t(b.item),tt(i)){const X=[...s(i)];i.value=Zt(X,b.newDraggableIndex,S);return}Zt(s(i),b.newDraggableIndex,S)}}function O(b){const{from:S,item:X,oldIndex:te,oldDraggableIndex:H,pullMode:q,clone:G}=b;if(Kt(S,X,te),q==="clone"){_t(G);return}if(tt(i)){const I=[...s(i)];i.value=Jt(I,H);return}Jt(s(i),H)}function C(b){if(d){d(b);return}const{from:S,item:X,oldIndex:te,oldDraggableIndex:H,newDraggableIndex:q}=b;if(_t(X),Kt(S,X,te),tt(i)){const G=[...s(i)];i.value=Gt(G,H,q);return}Gt(s(i),H,q)}function B(b){const{newIndex:S,oldIndex:X,from:te,to:H}=b;let q=null;const G=S===X&&te===H;try{if(G){let I=null;l==null||l.some((R,ie)=>{if(I&&(l==null?void 0:l.length)!==H.childNodes.length)return te.insertBefore(I,R.nextSibling),!0;const y=H.childNodes[ie];I=H==null?void 0:H.replaceChild(R,y)})}}catch(I){q=I}finally{l=null}mo(()=>{if(co(),q)throw q})}const F={onUpdate:C,onStart:g,onAdd:v,onRemove:O,onEnd:B};function M(b){const S=s(a);return b||(b=jn(S)?Wn(S,n==null?void 0:n.$el):S),b&&!Gn(b)&&(b=b.$el),b||Ln("Root element not found"),b}function P(){var b;const S=(b=s(c))!=null?b:{},{immediate:X,clone:te}=S,H=Yn(S,["immediate","clone"]);return Qt(H,(q,G)=>{Jn(q)&&(H[q]=(I,...R)=>{const ie=Dl();return Zn(I,ie),G(I,...R)})}),zn(i===null?{}:F,H)}const D=b=>{b=M(b),r&&E.destroy(),r=new x(b,P())};Xo(()=>c,()=>{r&&Qt(P(),(b,S)=>{r==null||r.option(b,S)})},{deep:!0});const E={option:(b,S)=>r==null?void 0:r.option(b,S),destroy:()=>{r==null||r.destroy(),r=null},save:()=>r==null?void 0:r.save(),toArray:()=>r==null?void 0:r.toArray(),closest:(...b)=>r==null?void 0:r.closest(...b)},Y=()=>E==null?void 0:E.option("disabled",!0),z=()=>E==null?void 0:E.option("disabled",!1);return $l(()=>{f&&D()}),Cl(E.destroy),So({start:D,pause:Y,resume:z},E)}const Tl=["update","start","add","remove","choose","unchoose","end","sort","filter","clone","move","change"];[...Tl.map(e=>`on${e.replace(/^\S/,o=>o.toUpperCase())}`)];const Ml={class:"table table-striped sortable mb-0"},Ol={style:{width:"25%"}},Pl={style:{width:"25%"}},Il={style:{width:"25%"}},Al={style:{width:"20%"}},Nl={class:"pe-2"},Rl={class:"ps-2"},Bl={class:"typography-subheading"},Fl={class:"btn-group btn-group-sm"},Ul=["title","onClick"],Hl=["title","onClick"],Yl=["title","onClick"],Xl=["title","onClick"],po=be({__name:"ReorderModal",setup(e,{expose:o}){const t=se(!0),n=se(null),l=ae("$tbody"),a=se([]),i=ae("$modal"),{show:c}=vt(i),{axios:r}=Fe(),f=D=>{n.value=D,t.value=!0,c(),r.get(D).then(E=>{a.value=E.data,t.value=!1})},{notifySuccess:u}=Me(),{$gettext:d}=Ce(),g=()=>{const D={};let E=0;a.value.forEach(Y=>{E++,D[Y.id]=E}),r.put(n.value,{order:D}).then(()=>{u(d("Playlist order set."))})},v=D=>{const E=a.value.splice(D,1)[0];a.value.splice(D+1,0,E),g()},O=D=>{const E=a.value.splice(D,1)[0];a.value.splice(a.value.length,0,E),g()},C=D=>{const E=a.value.splice(D,1)[0];a.value.splice(D-1,0,E),g()},B=D=>{const E=a.value.splice(D,1)[0];a.value.splice(0,0,E),g()};Jo("reorder");const{stop:F}=Zo(),M=()=>{El(l,a,{onEnd(){g()}})},P=()=>{F()};return o({open:f}),(D,E)=>(_(),me(mt,{id:"reorder_modal",ref_key:"$modal",ref:i,size:"lg",title:s(d)("Reorder Playlist"),busy:t.value,"hide-footer":"",onShown:M,onHidden:P},{default:A(()=>[w(dn,{class:"text-start bg-primary rounded mb-2 p-1"}),p("table",Ml,[p("thead",null,[p("tr",null,[E[0]||(E[0]=p("th",{style:{width:"5%"}},"   ",-1)),p("th",Ol,m(s(d)("Title")),1),p("th",Pl,m(s(d)("Artist")),1),p("th",Il,m(s(d)("Album")),1),p("th",Al,m(s(d)("Actions")),1)])]),p("tbody",{ref_key:"$tbody",ref:l},[(_(!0),T(Q,null,ze(a.value,(Y,z)=>(_(),T("tr",{key:Y.media.id,class:"align-middle"},[p("td",Nl,[w(cn,{url:Y.media.links.play},null,8,["url"])]),p("td",Rl,[p("span",Bl,m(Y.media.title),1)]),p("td",null,m(Y.media.artist),1),p("td",null,m(Y.media.album),1),p("td",null,[p("div",Fl,[z+1<a.value.length?(_(),T("button",{key:0,type:"button",class:"btn btn-secondary",title:s(d)("Move to Bottom"),onClick:Ue(b=>O(z),["prevent"])},[w(Te,{icon:s(tn)},null,8,["icon"])],8,Ul)):ee("",!0),z+1<a.value.length?(_(),T("button",{key:1,type:"button",class:"btn btn-primary",title:s(d)("Move Down"),onClick:Ue(b=>v(z),["prevent"])},[w(Te,{icon:s(on)},null,8,["icon"])],8,Hl)):ee("",!0),z>0?(_(),T("button",{key:2,type:"button",class:"btn btn-primary",title:s(d)("Move Up"),onClick:Ue(b=>C(z),["prevent"])},[w(Te,{icon:s(nn)},null,8,["icon"])],8,Yl)):ee("",!0),z>0?(_(),T("button",{key:3,type:"button",class:"btn btn-secondary",title:s(d)("Move to Top"),onClick:Ue(b=>B(z),["prevent"])},[w(Te,{icon:s(ln)},null,8,["icon"])],8,Xl)):ee("",!0)])])]))),128))],512)])]),_:1},8,["title","busy"]))}}),Ll={key:0},ql={class:"card-text"},jl={class:"table-responsive",style:{"max-height":"350px","overflow-y":"scroll"}},Wl={class:"table table-striped",style:{"max-height":"300px","overflow-y":"scroll"}},Vl={class:"p-2"},zl={class:"p-2 text-monospace",style:{"overflow-x":"auto"}},Gl={class:"mb-0"},Jl={key:0,class:"mb-0 text-success"},Zl={key:1,class:"mb-0 text-danger"},Kl=be({__name:"ImportModal",emits:["relist"],setup(e,{expose:o,emit:t}){const n=t,l=se(null),a=se(null),i=se(!1),c=se(null),r=M=>{a.value=M},f=ae("$modal"),{show:u,hide:d}=vt(f),g=M=>{a.value=null,i.value=!1,l.value=M,u()},{notifySuccess:v,notifyError:O}=Me(),{axios:C}=Fe(),B=()=>{const M=new FormData;M.append("playlist_file",a.value),C.post(l.value,M).then(P=>{P.data.success?(c.value=P.data,v(P.data.message)):(O(P.data.message),d())})},F=()=>{n("relist"),c.value=null};return o({open:g}),(M,P)=>(_(),me(mt,{id:"import_modal",ref_key:"$modal",ref:f,title:M.$gettext("Import from PLS/M3U"),size:"lg",onHidden:F},{"modal-footer":A(()=>[p("button",{type:"button",class:"btn btn-secondary",onClick:P[0]||(P[0]=(...D)=>s(d)&&s(d)(...D))},m(M.$gettext("Close")),1),c.value?ee("",!0):(_(),T("button",{key:0,class:"btn btn-primary",type:"submit",onClick:B},m(M.$gettext("Import from PLS/M3U")),1))]),default:A(()=>[c.value?(_(),T("div",Ll,[p("p",ql,m(c.value.message),1),p("div",jl,[p("table",Wl,[p("thead",null,[p("tr",null,[p("th",Vl,[W(m(M.$gettext("Original Path")),1),P[1]||(P[1]=p("br",null,null,-1)),W(" "+m(M.$gettext("Matched")),1)])])]),p("tbody",null,[(_(!0),T(Q,null,ze(c.value.import_results,D=>(_(),T("tr",{key:D.path},[p("td",zl,[p("pre",Gl,m(D.path),1),D.match?(_(),T("pre",Jl,m(D.match),1)):(_(),T("pre",Zl,"                                "+m(M.$gettext("No Match"))+`
                            `,1))])]))),128))])])])])):(_(),T("form",{key:1,class:"form",onSubmit:Ue(B,["prevent"])},[w(pn,{id:"import_modal_playlist_file"},{label:A(()=>[W(m(M.$gettext("Select PLS/M3U File to Import")),1)]),description:A(()=>[W(m(M.$gettext("Aplus will scan the uploaded file for matches in this station's music library. Media should already be uploaded before running this step. You can re-run this tool as many times as needed.")),1)]),default:A(({id:D})=>[w(fn,{id:D,onUploaded:r},null,8,["id"])]),_:1}),w(un)],32))]),_:1},8,["title"]))}}),Ql={class:"table table-striped sortable mb-0"},ea={style:{width:"50%"}},ta={style:{width:"50%"}},oa={class:"typography-subheading"},na=be({__name:"QueueModal",setup(e,{expose:o}){const t=se(!0),n=se(null),l=se([]),a=ae("$modal"),{show:i,hide:c}=vt(a),{axios:r}=Fe(),f=O=>{n.value=O,t.value=!0,r.get(O).then(C=>{l.value=C.data,t.value=!1}),i()},u=()=>{t.value=!1,n.value=null},{notifySuccess:d}=Me(),{$gettext:g}=Ce(),v=()=>{r.delete(n.value).then(()=>{d(g("Playlist queue cleared.")),c()})};return o({open:f}),(O,C)=>(_(),me(mt,{id:"queue_modal",ref_key:"$modal",ref:a,size:"lg",title:s(g)("Playback Queue"),busy:t.value,onHidden:u},{"modal-footer":A(()=>[p("button",{class:"btn btn-secondary",type:"button",onClick:C[0]||(C[0]=(...B)=>s(c)&&s(c)(...B))},m(s(g)("Close")),1),p("button",{class:"btn btn-danger",type:"submit",onClick:v},m(s(g)("Clear Queue")),1)]),default:A(()=>[p("p",null,m(s(g)("This queue contains the remaining tracks in the order they will be queued by the Aplus AutoDJ (if the tracks are eligible to be played).")),1),p("table",Ql,[p("thead",null,[p("tr",null,[p("th",ea,m(s(g)("Title")),1),p("th",ta,m(s(g)("Artist")),1)])]),p("tbody",null,[(_(!0),T(Q,null,ze(l.value,B=>(_(),T("tr",{key:B.id,class:"align-middle"},[p("td",null,[p("span",oa,m(B.title),1)]),p("td",null,m(B.artist),1)]))),128))])])]),_:1},8,["title","busy"]))}}),la={class:"row g-3"},aa=be({__name:"CloneModal",emits:["relist","needs-restart"],setup(e,{expose:o,emit:t}){const n=t,l=se(null),{form:a,v$:i,resetForm:c,ifValid:r}=_o({name:{required:st},clone:{}},{name:"",clone:[]}),f=()=>{l.value=null,c()},{$gettext:u}=Ce(),d=[{value:"media",text:u("Copy associated media and folders.")},{value:"schedule",text:u("Copy scheduled playback times.")}],g=ae("$modal"),v=(F,M)=>{f(),l.value=M,a.value.name=u("%{name} - Copy",{name:F}),g.value.show()},{notifySuccess:O}=Me(),{axios:C}=Fe(),B=()=>{r(()=>{C({method:"POST",url:l.value,data:a.value}).then(()=>{O(),n("needs-restart"),n("relist"),g.value.hide()})})};return o({open:v}),(F,M)=>(_(),me(bo,{id:"clone_modal",ref_key:"$modal",ref:g,title:s(u)("Duplicate Playlist"),"disable-save-button":s(i).$invalid,onSubmit:B,onHidden:f},{default:A(()=>[p("div",la,[w(Ae,{id:"form_edit_name",class:"col-md-12",field:s(i).name,label:s(u)("New Playlist Name")},null,8,["field","label"]),w(rt,{id:"form_edit_clone",class:"col-md-12",field:s(i).clone,options:d,stacked:"",label:s(u)("Customize Copy")},null,8,["field","label"])])]),_:1},8,["title","disable-save-button"]))}}),ia={class:"row g-3"},ra={class:"col-md-4"},sa={class:"col-md-8"},ca={style:{"max-height":"300px","overflow-y":"scroll"}},da=["disabled"],ua=be({__name:"ApplyToModal",emits:["relist"],setup(e,{expose:o,emit:t}){const n=t,l=ae("$modal"),{show:a,hide:i}=vt(l),{$gettext:c}=Ce(),r=[{key:"name",isRowHeader:!0,label:c("Directory")}],f=se(!0),u=se(null),{record:d,reset:g}=hn({playlist:{id:null,name:""},directories:[]}),v=se([]),O=b=>{v.value=Mt.map(b,"path")},{form:C,v$:B,resetForm:F,ifValid:M}=_o({copyPlaylist:{}},{copyPlaylist:!1}),P=()=>{u.value=null,v.value=[],g(),F()},{axios:D}=Fe(),E=b=>{P(),u.value=b,f.value=!0,a(),D.get(b).then(S=>{d.value=S.data,f.value=!1})},{notifySuccess:Y}=Me(),z=()=>{M(()=>{D.put(u.value,{...C.value,directories:v.value}).then(()=>{Y(c("Playlist successfully applied to folders."))}).finally(()=>{i(),n("relist")})})};return o({open:E}),(b,S)=>(_(),me(mt,{id:"apply_playlist_to_modal",ref_key:"$modal",ref:l,size:"xl",centered:"",loading:f.value,title:s(c)("Apply Playlist to Folders"),onHidden:P},{"modal-footer":A(()=>[p("button",{type:"button",class:"btn btn-secondary",onClick:S[0]||(S[0]=(...X)=>s(i)&&s(i)(...X))},m(s(c)("Close")),1),p("button",{type:"button",class:"btn btn-primary",disabled:v.value.length===0,onClick:z},m(s(c)("Apply to Folders")),9,da)]),default:A(()=>[p("div",ia,[p("div",ra,[w(Ft,{id:"apply_to_playlist_name"},{label:A(()=>[W(m(s(c)("Playlist:")),1)]),default:A(()=>[W(" "+m(s(d).playlist.name),1)]),_:1})]),p("div",sa,[w(Rt,{id:"form_applyto_copy_playlist",field:s(B).copyPlaylist},{label:A(()=>[W(m(s(c)("Create New Playlist for Each Folder")),1)]),_:1},8,["field"])])]),p("div",ca,[w(fo,{fields:r,items:s(d).directories,"handle-client-side":"","show-toolbar":!1,selectable:"",onRowSelected:O},null,8,["items"])])]),_:1},8,["loading","title"]))}}),pa={class:"card",role:"region","aria-labelledby":"hdr_playlists"},fa={class:"card-header text-bg-primary"},ha={class:"row align-items-center"},ma={class:"col-md-6"},va={id:"hdr_playlists",class:"card-title"},ga={class:"col-md-6 text-end"},ba={class:"card-body"},_a={class:"card-body-flush"},ya={class:"card-body buttons"},wa={class:"m-0"},Sa={class:"badges"},ka={class:"badge text-bg-secondary"},xa={key:0,class:"badge text-bg-primary"},Ca={key:1,class:"badge text-bg-info"},$a={key:2,class:"badge text-bg-info"},Da={key:3,class:"badge text-bg-info"},Ea={key:4,class:"badge text-bg-danger"},Ta={class:"btn-group btn-group-sm"},Ma=["onClick"],Oa=["onClick"],Pa=["onClick"],Ia={class:"buttons",style:{"line-height":"2.5"}},Aa=["onClick"],Na=["onClick"],Ra=["onClick"],Ba=["onClick"],Fa=["onClick"],Ua=["onClick"],Ha=["onClick"],Ya=["onClick"],Xa=["href"],ji=be({__name:"Playlists",props:{useManualAutoDj:{type:Boolean}},setup(e){const o=e,t=Vt("/playlists");Vt("/playlists/schedule");const{$gettext:n}=Ce(),l=[{key:"name",isRowHeader:!0,label:n("Playlist"),sortable:!0},{key:"scheduling",label:n("Scheduling"),sortable:!1},{key:"num_songs",label:n("# Songs"),sortable:!1},{key:"actions",label:n("Actions"),sortable:!1,class:"shrink"}],{Duration:a}=bn(),i=I=>I===0?n("None"):a.fromMillis(I*1e3).rescale().toHuman(),c=ae("$dataTable"),{refresh:r}=_n(c),f=ae("$scheduleTab"),u=()=>{var I;r(),(I=f.value)==null||I.refresh()},d=ae("$editModal"),{doCreate:g,doEdit:v}=vn(d),O=ae("$reorderModal"),C=I=>{var R;(R=O.value)==null||R.open(I)},B=ae("$queueModal"),F=I=>{var R;(R=B.value)==null||R.open(I)},M=ae("$importModal"),P=I=>{var R;(R=M.value)==null||R.open(I)},D=ae("$cloneModal"),E=(I,R)=>{var ie;(ie=D.value)==null||ie.open(I,R)},Y=ae("$applyToModal"),z=I=>{var R;(R=Y.value)==null||R.open(I)},{mayNeedRestart:b}=gn(),S=()=>{o.useManualAutoDj&&b()},{notifySuccess:X}=Me(),{axios:te}=Fe(),H=I=>{te.put(I).then(R=>{S(),X(R.data.message),u()})},{doDelete:q}=Wt(n("Delete Playlist?"),()=>{u(),S()}),{doDelete:G}=Wt(n("Clear all media from playlist?"),()=>{u(),S()});return(I,R)=>{const ie=jo("router-link");return _(),T(Q,null,[p("section",pa,[p("div",fa,[p("div",ha,[p("div",ma,[p("h2",va,m(s(n)("Playlists")),1)]),p("div",ga,[w(go)])])]),p("div",ba,[w(vo,{"content-class":"mt-3","destroy-on-hide":""},{default:A(()=>[w(Bt,{id:"all_playlists",label:s(n)("All Playlists")},{default:A(()=>[p("div",_a,[p("div",ya,[w(mn,{text:s(n)("Add Playlist"),onClick:s(g)},null,8,["text","onClick"])]),w(fo,{id:"station_playlists",ref_key:"$dataTable",ref:c,paginated:"",fields:l,"api-url":s(t),detailed:""},{"cell(name)":A(y=>[p("h5",wa,m(y.item.name),1),p("div",Sa,[p("span",ka,[y.item.source==="songs"?(_(),T(Q,{key:0},[W(m(s(n)("Song-based")),1)],64)):(_(),T(Q,{key:1},[W(m(s(n)("Remote URL")),1)],64))]),y.item.is_jingle?(_(),T("span",xa,m(s(n)("Jingle Mode")),1)):ee("",!0),y.item.source==="songs"&&y.item.order==="sequential"?(_(),T("span",Ca,m(s(n)("Sequential")),1)):ee("",!0),y.item.include_in_on_demand?(_(),T("span",$a,m(s(n)("On-Demand")),1)):ee("",!0),y.item.schedule_items.length>0?(_(),T("span",Da,m(s(n)("Scheduled")),1)):ee("",!0),y.item.is_enabled?ee("",!0):(_(),T("span",Ea,m(s(n)("Disabled")),1))])]),"cell(scheduling)":A(({item:y})=>[y.is_enabled?y.source!=="songs"?(_(),T(Q,{key:1},[W(m(s(n)("Remote URL")),1)],64)):y.type==="default"?(_(),T(Q,{key:2},[W(m(s(n)("General Rotation")),1),R[0]||(R[0]=p("br",null,null,-1)),W(" "+m(s(n)("Weight"))+": "+m(y.weight),1)],64)):y.type==="once_per_x_songs"?(_(),T(Q,{key:3},[W(m(s(n)("Once per %{songs} Songs",{songs:y.play_per_songs})),1)],64)):y.type==="once_per_x_minutes"?(_(),T(Q,{key:4},[W(m(s(n)("Once per %{minutes} Minutes",{minutes:y.play_per_minutes})),1)],64)):y.type==="once_per_hour"?(_(),T(Q,{key:5},[W(m(s(n)("Once per Hour (at %{minute})",{minute:y.play_per_hour_minute})),1)],64)):(_(),T(Q,{key:6},[W(m(s(n)("Custom")),1)],64)):(_(),T(Q,{key:0},[W(m(s(n)("Disabled")),1)],64))]),"cell(num_songs)":A(y=>[y.item.source==="songs"?(_(),T(Q,{key:0},[w(ie,{to:{name:"stations:files:index",params:{path:"playlist:"+y.item.short_name}}},{default:A(()=>[W(m(y.item.num_songs),1)]),_:2},1032,["to"]),W(" ("+m(i(y.item.total_length))+") ",1)],64)):(_(),T(Q,{key:1},[W("   ")],64))]),"cell(actions)":A(({item:y,isActive:oe,toggleDetails:bt})=>[p("div",Ta,[p("button",{type:"button",class:"btn btn-primary",onClick:Xt=>s(v)(y.links.self)},m(s(n)("Edit")),9,Ma),p("button",{type:"button",class:"btn btn-danger",onClick:Xt=>s(q)(y.links.self)},m(s(n)("Delete")),9,Oa),p("button",{class:"btn btn-sm btn-secondary",type:"button",onClick:Xt=>bt()},[w(Te,{icon:oe?s(an):s(rn)},null,8,["icon"]),W(" "+m(s(n)("More")),1)],8,Pa)])]),detail:A(({item:y})=>[p("div",Ia,[y.links.order?(_(),T("button",{key:0,type:"button",class:"btn btn-sm btn-primary",onClick:oe=>C(y.links.order)},m(s(n)("Reorder")),9,Aa)):ee("",!0),p("button",{type:"button",class:Tt(["btn btn-sm",y.is_enabled?"btn-warning":"btn-success"]),onClick:oe=>H(y.links.toggle)},m(y.is_enabled?s(n)("Disable"):s(n)("Enable")),11,Na),y.links.empty?(_(),T("button",{key:1,type:"button",class:"btn btn-sm btn-danger",onClick:oe=>s(G)(y.links.empty)},m(s(n)("Empty")),9,Ra)):ee("",!0),y.links.reshuffle?(_(),T("button",{key:2,type:"button",class:"btn btn-sm btn-secondary",onClick:oe=>H(y.links.reshuffle)},m(s(n)("Reshuffle")),9,Ba)):ee("",!0),y.links.import?(_(),T("button",{key:3,type:"button",class:"btn btn-sm btn-secondary",onClick:oe=>P(y.links.import)},m(s(n)("Import from PLS/M3U")),9,Fa)):ee("",!0),y.links.queue?(_(),T("button",{key:4,type:"button",class:"btn btn-sm btn-secondary",onClick:oe=>F(y.links.queue)},m(s(n)("Playback Queue")),9,Ua)):ee("",!0),y.links.applyto?(_(),T("button",{key:5,type:"button",class:"btn btn-sm btn-secondary",onClick:oe=>z(y.links.applyto)},m(s(n)("Apply to Folders")),9,Ha)):ee("",!0),p("button",{type:"button",class:"btn btn-sm btn-secondary",onClick:oe=>E(y.name,y.links.clone)},m(s(n)("Duplicate")),9,Ya),(_(),T(Q,null,ze(["pls","m3u"],oe=>p("a",{key:oe,class:"btn btn-sm btn-secondary",href:y.links.export[oe],target:"_blank"},m(s(n)("Export %{format}",{format:oe.toUpperCase()})),9,Xa)),64))])]),_:1},8,["api-url"])])]),_:1},8,["label"])]),_:1})])]),w(Un,{ref_key:"$editModal",ref:d,"create-url":s(t),onRelist:u,onNeedsRestart:S},null,8,["create-url"]),w(po,{ref_key:"$reorderModal",ref:O},null,512),w(na,{ref_key:"$queueModal",ref:B},null,512),w(po,{ref_key:"$reorderModal",ref:O},null,512),w(Kl,{ref_key:"$importModal",ref:M,onRelist:u},null,512),w(aa,{ref_key:"$cloneModal",ref:D,onRelist:u,onNeedsRestart:S},null,512),w(ua,{ref_key:"$applyToModal",ref:Y,onRelist:u},null,512)],64)}}});export{ji as default};
